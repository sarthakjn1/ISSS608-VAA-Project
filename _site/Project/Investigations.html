<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ten Wei Peng, Jaya George, Sarthak Nagapurkar">
<meta name="dcterms.date" content="2024-06-15">

<title>ISSS608-VAA-Project - Investigations</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="../site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ISSS608-VAA-Project</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../Project/Proposal.html" rel="" target="">
 <span class="menu-text">Project Proposal</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../Project/Investigations.html" rel="" target="" aria-current="page">
 <span class="menu-text">Investigations</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://sarthakjn1.shinyapps.io/OceanWatchTower/" rel="" target="_blank">
 <span class="menu-text">RShiny</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Project/user_guide.pdf" rel="" target="_blank">
 <span class="menu-text">User Guide</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Project/poster_mc2.jpeg" rel="" target="_blank">
 <span class="menu-text">Poster</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#loading-r-packages" id="toc-loading-r-packages" class="nav-link active" data-scroll-target="#loading-r-packages"><strong>Loading R Packages</strong></a>
  <ul class="collapse">
  <li><a href="#packages-used" id="toc-packages-used" class="nav-link" data-scroll-target="#packages-used">Packages Used:</a></li>
  </ul></li>
  <li><a href="#loading-the-data" id="toc-loading-the-data" class="nav-link" data-scroll-target="#loading-the-data"><strong>Loading the Data</strong></a></li>
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning"><strong>Data Cleaning</strong></a></li>
  <li><a href="#task-1" id="toc-task-1" class="nav-link" data-scroll-target="#task-1"><strong>Task 1</strong></a></li>
  <li><a href="#processing-fish-locations-data-and-visualizing" id="toc-processing-fish-locations-data-and-visualizing" class="nav-link" data-scroll-target="#processing-fish-locations-data-and-visualizing"><strong>1.1 Processing fish locations data and visualizing</strong></a></li>
  <li><a href="#processing-transactionsharbor-report-and-delivery-report-data" id="toc-processing-transactionsharbor-report-and-delivery-report-data" class="nav-link" data-scroll-target="#processing-transactionsharbor-report-and-delivery-report-data"><strong>1.2 Processing transactions,harbor report and delivery report data</strong></a></li>
  <li><a href="#exploring-outlier-data" id="toc-exploring-outlier-data" class="nav-link" data-scroll-target="#exploring-outlier-data"><strong>1.3 Exploring outlier data</strong></a></li>
  <li><a href="#plotting-fish-arrivals-over-time" id="toc-plotting-fish-arrivals-over-time" class="nav-link" data-scroll-target="#plotting-fish-arrivals-over-time"><strong>1.4 Plotting fish arrivals over time</strong></a></li>
  <li><a href="#plotting-protected-fish-quantities-arriving-at-each-city-over-time" id="toc-plotting-protected-fish-quantities-arriving-at-each-city-over-time" class="nav-link" data-scroll-target="#plotting-protected-fish-quantities-arriving-at-each-city-over-time"><strong>1.5 Plotting protected fish quantities arriving at each city over time</strong></a></li>
  <li><a href="#logic-for-inferring-mapping-between-cargo-and-vessel" id="toc-logic-for-inferring-mapping-between-cargo-and-vessel" class="nav-link" data-scroll-target="#logic-for-inferring-mapping-between-cargo-and-vessel"><strong>1.6</strong> Logic for inferring mapping between cargo and vessel</a></li>
  <li><a href="#sankey-diagram-for-showing-the-flow-of-fish-through-the-port-cities" id="toc-sankey-diagram-for-showing-the-flow-of-fish-through-the-port-cities" class="nav-link" data-scroll-target="#sankey-diagram-for-showing-the-flow-of-fish-through-the-port-cities"><strong>1.7</strong> Sankey diagram for showing the flow of fish through the port cities</a></li>
  <li><a href="#treemap" id="toc-treemap" class="nav-link" data-scroll-target="#treemap"><strong>1.8</strong> Treemap</a></li>
  <li><a href="#plotting-fish-quantities-arriving-at-each-city-over-time" id="toc-plotting-fish-quantities-arriving-at-each-city-over-time" class="nav-link" data-scroll-target="#plotting-fish-quantities-arriving-at-each-city-over-time"><strong>1.9 Plotting fish quantities arriving at each city over time</strong></a></li>
  <li><a href="#task-2" id="toc-task-2" class="nav-link" data-scroll-target="#task-2"><strong>Task 2</strong></a>
  <ul class="collapse">
  <li><a href="#plotting-monthly-dwell-time-of-vessels-belonging-to-southseafood-express-corp" id="toc-plotting-monthly-dwell-time-of-vessels-belonging-to-southseafood-express-corp" class="nav-link" data-scroll-target="#plotting-monthly-dwell-time-of-vessels-belonging-to-southseafood-express-corp"><strong>2.1 Plotting Monthly Dwell time of vessels belonging to SouthSeafood Express Corp</strong></a></li>
  <li><a href="#heatmap-of-dwell-time" id="toc-heatmap-of-dwell-time" class="nav-link" data-scroll-target="#heatmap-of-dwell-time"><strong>2.2 Heatmap of dwell time</strong></a></li>
  <li><a href="#deep-dive-into-southseafood-express-corp" id="toc-deep-dive-into-southseafood-express-corp" class="nav-link" data-scroll-target="#deep-dive-into-southseafood-express-corp"><strong>2.3. Deep dive into SouthSeafood Express Corp</strong></a></li>
  <li><a href="#deep-dive-into-snappersnatcher7b" id="toc-deep-dive-into-snappersnatcher7b" class="nav-link" data-scroll-target="#deep-dive-into-snappersnatcher7b"><strong>2.3. Deep dive into “snappersnatcher7b”</strong></a></li>
  <li><a href="#deep-investigations-into-roachrobberdb6" id="toc-deep-investigations-into-roachrobberdb6" class="nav-link" data-scroll-target="#deep-investigations-into-roachrobberdb6"><strong>2.4. Deep Investigations into “roachrobberdb6”</strong></a></li>
  <li><a href="#suspicious-trajectories" id="toc-suspicious-trajectories" class="nav-link" data-scroll-target="#suspicious-trajectories"><strong>2.5. Suspicious Trajectories</strong></a></li>
  <li><a href="#insights-from-visualisations" id="toc-insights-from-visualisations" class="nav-link" data-scroll-target="#insights-from-visualisations"><strong>2.6, Insights from Visualisations</strong></a></li>
  </ul></li>
  <li><a href="#task-3." id="toc-task-3." class="nav-link" data-scroll-target="#task-3."><strong>Task 3.</strong></a>
  <ul class="collapse">
  <li><a href="#visualisation-for-comparison-between-southseafood-vessels-with-others" id="toc-visualisation-for-comparison-between-southseafood-vessels-with-others" class="nav-link" data-scroll-target="#visualisation-for-comparison-between-southseafood-vessels-with-others"><strong>3.1 Visualisation for comparison between SouthSeaFood Vessels with Others</strong></a></li>
  <li><a href="#top-10-vessels-with-highest-dwell-time-in-ghoti-preserve" id="toc-top-10-vessels-with-highest-dwell-time-in-ghoti-preserve" class="nav-link" data-scroll-target="#top-10-vessels-with-highest-dwell-time-in-ghoti-preserve"><strong>3.2 Top 10 vessels with highest Dwell time in Ghoti Preserve</strong></a></li>
  <li><a href="#visualization-for-detecting-suspicious-fishing-vessels-based-on-dwell-time-in-ecological-preserves-and-other-areas" id="toc-visualization-for-detecting-suspicious-fishing-vessels-based-on-dwell-time-in-ecological-preserves-and-other-areas" class="nav-link" data-scroll-target="#visualization-for-detecting-suspicious-fishing-vessels-based-on-dwell-time-in-ecological-preserves-and-other-areas"><strong>3.3.</strong> Visualization for Detecting Suspicious Fishing Vessels Based on Dwell Time in Ecological Preserves and Other Areas</a></li>
  </ul></li>
  <li><a href="#task-4" id="toc-task-4" class="nav-link" data-scroll-target="#task-4"><strong>Task 4</strong></a></li>
  <li><a href="#identifying-new-companies" id="toc-identifying-new-companies" class="nav-link" data-scroll-target="#identifying-new-companies"><strong>4.1. Identifying New companies</strong></a></li>
  <li><a href="#investigating-behaviours-of-new-companies" id="toc-investigating-behaviours-of-new-companies" class="nav-link" data-scroll-target="#investigating-behaviours-of-new-companies"><strong>4.2. Investigating behaviours of New companies</strong></a></li>
  <li><a href="#found-similarities-of-tainamarine-fishing-co-to-southseafood-express-corp" id="toc-found-similarities-of-tainamarine-fishing-co-to-southseafood-express-corp" class="nav-link" data-scroll-target="#found-similarities-of-tainamarine-fishing-co-to-southseafood-express-corp"><strong>4.3. Found Similarities of Tainamarine Fishing Co to SouthSeafood Express Corp</strong></a></li>
  <li><a href="#comparing-dwell-time-before-and-after-southseafoodcorp-was-caught" id="toc-comparing-dwell-time-before-and-after-southseafoodcorp-was-caught" class="nav-link" data-scroll-target="#comparing-dwell-time-before-and-after-southseafoodcorp-was-caught"><strong>4.4.</strong> Comparing dwell time before and after SouthSeaFoodCorp was caught</a></li>
  <li><a href="#comparing-cargo-transactions-before-and-after-southseafood-was-caught" id="toc-comparing-cargo-transactions-before-and-after-southseafood-was-caught" class="nav-link" data-scroll-target="#comparing-cargo-transactions-before-and-after-southseafood-was-caught"><strong>4.5.</strong> Comparing Cargo Transactions before and after SouthSeaFood was caught</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Investigations</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ten Wei Peng, Jaya George, Sarthak Nagapurkar </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 15, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">June 30, 2024</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="loading-r-packages" class="level2">
<h2 class="anchored" data-anchor-id="loading-r-packages"><strong>Loading R Packages</strong></h2>
<section id="packages-used" class="level3">
<h3 class="anchored" data-anchor-id="packages-used">Packages Used:</h3>
<ol type="1">
<li><strong>sf</strong>: Handles simple features (spatial vector data) in R.</li>
<li><strong>lwgeom</strong>: Extends <code>sf</code> with additional geometric operations.</li>
<li><strong>units</strong>: Manages unit-aware vectors in R.</li>
<li><strong>maps</strong>: Provides map data for plotting.</li>
<li><strong>dplyr</strong>: Efficient data manipulation and transformation.</li>
<li><strong>tidyverse</strong>: Collection of R packages for data science (includes <code>dplyr</code>, <code>ggplot2</code>, etc.).</li>
<li><strong>lubridate</strong>: Simplifies date and time manipulation.</li>
<li><strong>jsonlite</strong>: Parses and generates JSON data.</li>
<li><strong>httr</strong>: Facilitates working with URLs and HTTP.</li>
<li><strong>ggplot2</strong>: Creates elegant data visualizations.</li>
<li><strong>tmap</strong>: Thematic maps for spatial data.</li>
<li><strong>leaflet</strong>: Interactive maps using the Leaflet JavaScript library.</li>
<li><strong>viridis</strong>: Color scales for scientific data.</li>
<li><strong>plotly</strong>: Interactive graphing library.</li>
<li><strong>ggraph</strong>: Extends <code>ggplot2</code> for graph visualization.</li>
<li><strong>gganimate</strong>: Animates <code>ggplot2</code> plots.</li>
<li><strong>gifski</strong>: Renders animations to GIFs.</li>
<li><strong>ggrepel</strong>: Prevents overlapping text labels in <code>ggplot2</code>.</li>
<li><strong>igraph</strong>: Network analysis and visualization.</li>
<li><strong>tidygraph</strong>: Tidy API for network data.</li>
<li><strong>visNetwork</strong>: Interactive network visualization.</li>
<li><strong>graphlayouts</strong>: Layout algorithms for network visualization.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary R packages using pacman</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Spatial Data</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  sf, lwgeom, units, maps,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Data Manipulation</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  dplyr, tidyverse, lubridate, jsonlite, httr,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Visualization</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  ggplot2, tmap, leaflet, viridis, plotly, ggraph, gganimate, gifski, ggrepel,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Network Analysis</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  igraph, tidygraph, visNetwork, graphlayouts</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="loading-the-data" class="level2">
<h2 class="anchored" data-anchor-id="loading-the-data"><strong>Loading the Data</strong></h2>
<p>Loading the mc2 json data which is a directed multigraph consisting of nodes containing entities and edges containing relationships</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>json_data <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/mc2.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Links</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Nodes</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Extracting Necessary Features</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p><strong>In this section, we will prepare our links dataset</strong></p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>links_df <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(json_data<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="fu">as.character</span>(source),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">target =</span> <span class="fu">as.character</span>(target),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">as.character</span>(type),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">date =</span>  date,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">time =</span>  <span class="fu">as.POSIXct</span>(time, <span class="at">format=</span><span class="st">"%Y-%m-%dT%H:%M:%OS"</span>, <span class="at">tz=</span><span class="st">"UTC"</span>),</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">ping_date =</span> <span class="fu">as.Date</span>(<span class="fu">as.POSIXct</span>(time, <span class="at">format=</span><span class="st">"%Y-%m-%dT%H:%M:%OS"</span>, <span class="at">tz=</span><span class="st">"UTC"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(type, time, dwell, source, target, date, ping_date)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>mc2_links <span class="ot">&lt;-</span> links_df<span class="sc">%&gt;%</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, type) <span class="sc">%&gt;%</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source <span class="sc">!=</span> target) <span class="sc">%&gt;%</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(links_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 271,643
Columns: 7
$ type      &lt;chr&gt; "Event.TransportEvent.TransponderPing", "Event.TransportEven…
$ time      &lt;dttm&gt; 2035-09-16 04:06:48, 2035-09-20 05:21:33, 2035-09-28 04:31:…
$ dwell     &lt;dbl&gt; 115074.79, 412706.32, 286092.88, 327623.95, 243225.35, 10956…
$ source    &lt;chr&gt; "City of Haacklee", "City of Haacklee", "City of Haacklee", …
$ target    &lt;chr&gt; "perchplundererbc0", "perchplundererbc0", "perchplundererbc0…
$ date      &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
$ ping_date &lt;date&gt; 2035-09-16, 2035-09-20, 2035-09-28, 2035-10-04, 2035-10-15,…</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p><strong>In this section, we will prepare our nodes dataset</strong></p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert nodes to tibble, modify variable types, and select required columns</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>nodes_df <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(json_data<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">type_original =</span> type,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> <span class="fu">as.character</span>(id), </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="fu">as.character</span>(type),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="fu">case_when</span>(</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>      type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Entity.Vessel.CargoVessel"</span>, <span class="st">"Entity.Vessel.Ferry.Cargo"</span>, <span class="st">"Entity.Vessel.FishingVessel"</span>) <span class="sc">~</span> <span class="st">"Entity.Vessel"</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> type</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">tonnage =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(tonnage)),</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">length_overall =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(length_overall)), </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Activities =</span> <span class="fu">as.character</span>(Activities), </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    fish_species_present, </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">kind =</span> <span class="fu">as.character</span>(kind), </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">flag_country =</span> <span class="fu">as.character</span>(flag_country),</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">company =</span> <span class="fu">as.character</span>(company),</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">as.character</span>(name),</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Name =</span> <span class="fu">as.character</span>(Name)) <span class="sc">%&gt;%</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, date, type,type_original, qty_tons, name, Name, company, flag_country, Activities, tonnage, length_overall, fish_species_present, kind)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(nodes_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,637
Columns: 14
$ id                   &lt;chr&gt; "gadusnspecificatae4ba", "piscesfrigus900", "pisc…
$ date                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ type                 &lt;chr&gt; "Entity.Commodity.Fish", "Entity.Commodity.Fish",…
$ type_original        &lt;chr&gt; "Entity.Commodity.Fish", "Entity.Commodity.Fish",…
$ qty_tons             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ name                 &lt;chr&gt; "Cod/Gadus n.specificatae", "Birdseye/Pisces frig…
$ Name                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "Haacklee…
$ company              &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ flag_country         &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ Activities           &lt;chr&gt; "NULL", "NULL", "NULL", "NULL", "NULL", "NULL", "…
$ tonnage              &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ length_overall       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ fish_species_present &lt;list&gt; &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, …
$ kind                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "city", "…</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We save our processed data into .rds data format files using the write_rds() of readr package. The output file is saved in rds sub-folder. We do this to reduce the loading time and more importantly, we can avoid uploading the large raw files onto GitHub.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(links_df, <span class="st">"data/rds/links_df.rds"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>links_df <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/links_df.rds"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(mc2_links, <span class="st">"data/rds/mc2_links.rds"</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>mc2_links <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/mc2_links.rds"</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(nodes_df, <span class="st">"data/rds/nodes_df.rds"</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>nodes_df <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/nodes_df.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p><strong>In this section, we will extract out seperate datasets from our nodes and links datasets</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>vessels_df <span class="ot">&lt;-</span> nodes_df <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Entity.Vessel"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, Name, company, flag_country, type) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">sub</span>(<span class="st">"Entity.Vessel."</span>, <span class="st">""</span>, type))</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>delivery_report_df <span class="ot">&lt;-</span> nodes_df <span class="sc">%&gt;%</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Entity.Document.DeliveryReport"</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">cargo_id =</span> id)<span class="sc">%&gt;%</span> </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(qty_tons,date,cargo_id)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>fish_df <span class="ot">&lt;-</span> nodes_df <span class="sc">%&gt;%</span> </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Entity.Commodity.Fish"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">fish_name =</span> name)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>city_df <span class="ot">&lt;-</span> nodes_df <span class="sc">%&gt;%</span> </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Entity.Location.City"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">city_name =</span> Name)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>locations_df <span class="ot">&lt;-</span> nodes_df <span class="sc">%&gt;%</span> </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Entity.Location.City"</span><span class="sc">|</span> type<span class="sc">==</span><span class="st">"Entity.Location.Point"</span><span class="sc">|</span> type<span class="sc">==</span><span class="st">"Entity.Location.Region"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">location_name =</span> Name)<span class="sc">%&gt;%</span> </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(id,location_name)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>harbor_report_df <span class="ot">&lt;-</span> links_df <span class="sc">%&gt;%</span> </span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event.HarborReport"</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date,source,target)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>transponder_ping_df <span class="ot">&lt;-</span> links_df <span class="sc">%&gt;%</span> </span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event.TransportEvent.TransponderPing"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(time,dwell,source,target,ping_date)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>transactions_df <span class="ot">&lt;-</span> links_df <span class="sc">%&gt;%</span> </span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event.Transaction"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date,source,target)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>fishing_grounds_df <span class="ot">&lt;-</span> nodes_df <span class="sc">%&gt;%</span> </span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(kind <span class="sc">==</span> <span class="st">"Fishing Ground"</span><span class="sc">|</span>kind <span class="sc">==</span> <span class="st">"Ecological Preserve"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,Name,kind,fish_species_present)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="data-cleaning" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning"><strong>Data Cleaning</strong></h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Links</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Nodes</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Geographical Information</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>We discovered that the columns “type,” “source,” and “target” are complete, containing no missing values. Conversely, the columns “time,” “dwell,” “date,” and “ping_date” exhibit numerous missing values. This outcome is anticipated since these columns exclusively hold data for specific categories.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for columns with missing values</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(links_df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     type      time     dwell    source    target      date ping_date 
        0     13101     13101         0         0    258542     13101 </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(links_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     type                time                            dwell         
 Length:271643      Min.   :2035-02-01 00:00:00.00   Min.   :       0  
 Class :character   1st Qu.:2035-04-17 13:33:02.35   1st Qu.:    4695  
 Mode  :character   Median :2035-06-28 19:34:55.25   Median :    6287  
                    Mean   :2035-06-30 22:13:03.65   Mean   :   19775  
                    3rd Qu.:2035-09-13 13:44:34.00   3rd Qu.:   12101  
                    Max.   :2035-11-30 00:00:00.00   Max.   :28735323  
                    NA's   :13101                    NA's   :13101     
    source             target              date             ping_date         
 Length:271643      Length:271643      Length:271643      Min.   :2035-02-01  
 Class :character   Class :character   Class :character   1st Qu.:2035-04-17  
 Mode  :character   Mode  :character   Mode  :character   Median :2035-06-28  
                                                          Mean   :2035-06-30  
                                                          3rd Qu.:2035-09-13  
                                                          Max.   :2035-11-30  
                                                          NA's   :13101       </code></pre>
</div>
</div>
<p>Next, we ensure there are no duplicated rows</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>links_df[<span class="fu">duplicated</span>(links_df),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 790 × 7
   type               time   dwell source                target date  ping_date
   &lt;chr&gt;              &lt;dttm&gt; &lt;dbl&gt; &lt;chr&gt;                 &lt;chr&gt;  &lt;chr&gt; &lt;date&gt;   
 1 Event.HarborReport NA        NA wavewranglerc2d       City … 2035… NA       
 2 Event.HarborReport NA        NA wavewranglerc2d       City … 2035… NA       
 3 Event.HarborReport NA        NA wavewranglerc2d       City … 2035… NA       
 4 Event.HarborReport NA        NA wavewranglerc2d       City … 2035… NA       
 5 Event.HarborReport NA        NA wavewranglerc2d       City … 2035… NA       
 6 Event.HarborReport NA        NA wavewranglerc2d       City … 2035… NA       
 7 Event.HarborReport NA        NA yellowfintunataker08b City … 2035… NA       
 8 Event.HarborReport NA        NA webigailba7           City … 2035… NA       
 9 Event.HarborReport NA        NA webigailba7           City … 2035… NA       
10 Event.HarborReport NA        NA webigailba7           City … 2035… NA       
# ℹ 780 more rows</code></pre>
</div>
</div>
<p>Let’s try to understand how our links data is categorized into. It seems there are three categories of data as shown below.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>unique_type <span class="ot">&lt;-</span> <span class="fu">unique</span>(links_df<span class="sc">$</span>type)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(unique_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Event.TransportEvent.TransponderPing"
[2] "Event.Transaction"                   
[3] "Event.HarborReport"                  </code></pre>
</div>
</div>
<p><strong>Define a function to count and print unique categories for a given column.</strong></p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>count_unique_categories <span class="ot">&lt;-</span> <span class="cf">function</span>(data, column_name) {</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"**"</span>, column_name, <span class="st">"**</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  category_counts <span class="ot">&lt;-</span> <span class="fu">table</span>(data[[column_name]])</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  sorted_counts <span class="ot">&lt;-</span> <span class="fu">sort</span>(category_counts, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(sorted_counts)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Let’s take a look into our nodes dataframe.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(nodes_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,637
Columns: 14
$ id                   &lt;chr&gt; "gadusnspecificatae4ba", "piscesfrigus900", "pisc…
$ date                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ type                 &lt;chr&gt; "Entity.Commodity.Fish", "Entity.Commodity.Fish",…
$ type_original        &lt;chr&gt; "Entity.Commodity.Fish", "Entity.Commodity.Fish",…
$ qty_tons             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ name                 &lt;chr&gt; "Cod/Gadus n.specificatae", "Birdseye/Pisces frig…
$ Name                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "Haacklee…
$ company              &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ flag_country         &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ Activities           &lt;chr&gt; "NULL", "NULL", "NULL", "NULL", "NULL", "NULL", "…
$ tonnage              &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ length_overall       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ fish_species_present &lt;list&gt; &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, …
$ kind                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "city", "…</code></pre>
</div>
</div>
<p>Again, it’s hard to make sense if these missing values are actually important due ot the nature of the data. We shall handle it as it goes. However, the main columns we are interested in id and type are not missing any data.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for columns with missing values</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(nodes_df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                  id                 date                 type 
                   0                  330                    0 
       type_original             qty_tons                 name 
                   0                  330                 5627 
                Name              company         flag_country 
                5317                 5458                 5341 
          Activities              tonnage       length_overall 
                   0                 5359                 5354 
fish_species_present                 kind 
                   0                 5613 </code></pre>
</div>
</div>
<p>There does not seem to be any whole duplicate rows.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>nodes_df[<span class="fu">duplicated</span>(nodes_df),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 14
# ℹ 14 variables: id &lt;chr&gt;, date &lt;chr&gt;, type &lt;chr&gt;, type_original &lt;chr&gt;,
#   qty_tons &lt;dbl&gt;, name &lt;chr&gt;, Name &lt;chr&gt;, company &lt;chr&gt;, flag_country &lt;chr&gt;,
#   Activities &lt;chr&gt;, tonnage &lt;dbl&gt;, length_overall &lt;dbl&gt;,
#   fish_species_present &lt;list&gt;, kind &lt;chr&gt;</code></pre>
</div>
</div>
<p>It seems we have many types of nodes even after grouping more of the Vessel types into our generic “Entity.Vessel”. It seems “Entity.Commodity.Fish”,‘Entity.Vessel’, ‘Entity.Location.Point’, ‘Entity.Location.City’, ‘Entity.Location.Region’ will be important for us.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>unique_type <span class="ot">&lt;-</span> <span class="fu">unique</span>(nodes_df<span class="sc">$</span>type)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(unique_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Entity.Commodity.Fish"          "Entity.Location.City"          
 [3] "Entity.Document.DeliveryReport" "Entity.Vessel"                 
 [5] "Entity.Vessel.Other"            "Entity.Vessel.Ferry.Passenger" 
 [7] "Entity.Vessel.Research"         "Entity.Vessel.Tour"            
 [9] "Entity.Location.Point"          "Entity.Location.Region"        </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">count_unique_categories</span>(nodes_df, <span class="st">'type'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>**type**

Entity.Document.DeliveryReport                  Entity.Vessel 
                          5307                            280 
         Entity.Location.Point          Entity.Commodity.Fish 
                            12                             10 
          Entity.Location.City         Entity.Location.Region 
                             6                              6 
            Entity.Vessel.Tour            Entity.Vessel.Other 
                             6                              5 
 Entity.Vessel.Ferry.Passenger         Entity.Vessel.Research 
                             3                              2 </code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">count_unique_categories</span>(nodes_df, <span class="st">'flag_country'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>**flag_country**

        Oceanus     Playa Solis         Helixia         Nyxonix      Alverossia 
            177               5               4               4               3 
       Ariuzima        Coralada        Kethanor      Lumindoria       Orvietola 
              3               3               3               3               3 
     Utoparadia        Uzifrica        Valtalmo Anderia del Mar       Azurionix 
              3               3               3               2               2 
      Calabrand        Faraluna       Gavanovia     Isla Solmar       Islavaria 
              2               2               2               2               2 
      Khamseena       Kondarica        Mawalara        Merigrad      Novarctica 
              2               2               2               2               2 
    Novarcticaa      Osterivaro     Rio Solovia       Riodelsol    Thessalandia 
              2               2               2               2               2 
     Utoporiana         Uziland       Zawalinda      Afarivaria       Alverovia 
              2               2               2               1               1 
   Arreciviento         Arvaros       Arvekalia        Baziuzim      Brindisola 
              1               1               1               1               1 
    Brindivaria     Coralmarica        Helvoris         Icarnia          Imazam 
              1               1               1               1               1 
    Islavaragon        Kethilim       Kilivaria      Kondanovia    Kondarivakia 
              1               1               1               1               1 
     Korvelonia       Kuzalanda        Lumakari       Luminkind   Mango del Oro 
              1               1               1               1               1 
        Marebak        Marifada      Myriadonia        Nalakond       Nalaloria 
              1               1               1               1               1 
     Oceanterra  Puerto del Mar      Sirenareef     Solovarossa       Solterrix 
              1               1               1               1               1 
     Syrithania       Talandria    Vesperlandia        Vientoro       Wysterion 
              1               1               1               1               1 
    Yggdrasonia        Zambarka 
              1               1 </code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">count_unique_categories</span>(nodes_df, <span class="st">'kind'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>**kind**

               buoy                city Ecological Preserve      Fishing Ground 
                 12                   6                   3                   3 </code></pre>
</div>
</div>
<p>There are 100 companies found in our dataset</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>count_unique_companies <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(nodes_df<span class="sc">$</span>company))</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>count_unique_companies</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 100</code></pre>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>The code below snippet employs the sf package to read and manipulate GeoJSON data. It uses <code>st_read()</code> to import the GeoJSON file and renames the column “Name” to “id” using rename() from the dplyr package.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the GeoJSON file</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>geojson_file <span class="ot">&lt;-</span> <span class="st">"data/Oceanus Information/Oceanus Geography.geojson"</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>geo_data <span class="ot">&lt;-</span> <span class="fu">st_read</span>(geojson_file) <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> Name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `Oceanus Geography' from data source 
  `C:\weipengten\ISSS608-VAA-Project\Project\data\Oceanus Information\Oceanus Geography.geojson' 
  using driver `GeoJSON'
Simple feature collection with 29 features and 7 fields
Geometry type: GEOMETRY
Dimension:     XY
Bounding box:  xmin: -167.0654 ymin: 38.07452 xmax: -163.2723 ymax: 40.67775
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<p>Using <code>tmap</code> we create a basic plot of our locations we are interested in.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the geographical data with tmap</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(geo_data) <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tmap_style</span>(<span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(geo_data) <span class="sc">+</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"purple"</span>, <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="at">text =</span> <span class="st">"id"</span>, <span class="at">size =</span> <span class="fl">0.6</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span>  <span class="co"># Add labels to the locations</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"left"</span>, <span class="st">"bottom"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Investigations_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="task-1" class="level2">
<h2 class="anchored" data-anchor-id="task-1"><strong>Task 1</strong></h2>
</section>
<section id="processing-fish-locations-data-and-visualizing" class="level2">
<h2 class="anchored" data-anchor-id="processing-fish-locations-data-and-visualizing"><strong>1.1 Processing fish locations data and visualizing</strong></h2>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial cleaning and splitting of fish species data</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>fishing_grounds_df <span class="ot">&lt;-</span> fishing_grounds_df <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fish_species_present =</span> <span class="fu">gsub</span>(<span class="st">"c[(]"</span>, <span class="st">""</span>, fish_species_present)) <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fish_species_present =</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\"</span><span class="st">"</span>, <span class="st">""</span>, fish_species_present)) <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fish_species_present =</span> <span class="fu">gsub</span>(<span class="st">"[)]"</span>, <span class="st">""</span>, fish_species_present)) <span class="sc">%&gt;%</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fish_species_present =</span> <span class="fu">strsplit</span>(<span class="fu">as.character</span>(fish_species_present), <span class="st">",</span><span class="sc">\\</span><span class="st">s*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(fish_species_present) <span class="sc">%&gt;%</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">fishing_location =</span> Name)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by fish species and collect all unique locations into a list</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>final_fish_locations_df <span class="ot">&lt;-</span> fishing_grounds_df <span class="sc">%&gt;%</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fish_species_present) <span class="sc">%&gt;%</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">fishing_locations =</span> <span class="fu">list</span>(<span class="fu">unique</span>(fishing_location)), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fishing_grounds_df, <span class="fu">aes</span>(<span class="at">x =</span> fishing_location, <span class="at">y =</span> fish_species_present, <span class="at">fill =</span> kind)) <span class="sc">+</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Ecological Preserve"</span> <span class="ot">=</span> <span class="st">"lightblue"</span>, <span class="st">"Fishing Ground"</span> <span class="ot">=</span> <span class="st">"lightgreen"</span>)) <span class="sc">+</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Fish Distribution in Fishing Locations"</span>,</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Fishing Location"</span>,</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Fish Species"</span>,</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Location Type"</span>) <span class="sc">+</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.25</span>, <span class="at">hjust=</span><span class="fl">0.25</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Investigations_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Plot above shows the locations in which various fish varieties are found. Fishing is supposed to be done only in the designated fishing grounds and not in ecological preserves</p>
<p><strong>Insights:</strong> There are some fishes like <strong>Sockfish/Pisces foetida,Helenaa/Pisces satis, Offidiaa/Piscis osseus</strong> which are found only in ecological preserves. So tracking fishing of these varieties can give leads to illegal fishing happening.</p>
</section>
<section id="processing-transactionsharbor-report-and-delivery-report-data" class="level2">
<h2 class="anchored" data-anchor-id="processing-transactionsharbor-report-and-delivery-report-data"><strong>1.2 Processing transactions,harbor report and delivery report data</strong></h2>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert date columns to Date type</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>transactions_df<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(transactions_df<span class="sc">$</span>date)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>harbor_report_df<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(harbor_report_df<span class="sc">$</span>date)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>delivery_report_df<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(delivery_report_df<span class="sc">$</span>date)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Performing the inner join to pick only fishing or cargo vessels</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>harbor_report_df <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(harbor_report_df, vessels_df, <span class="at">by =</span>  <span class="fu">c</span>(<span class="st">"source"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">vessel_name =</span> Name,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">vessel_company =</span> company,</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">vessel_id=</span>source,</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">city=</span>target,</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">vessel_type=</span>type</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date,vessel_id,city,vessel_name,vessel_type,vessel_company,flag_country)</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>transponder_ping_df <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(transponder_ping_df, vessels_df, <span class="at">by =</span>  <span class="fu">c</span>(<span class="st">"target"</span> <span class="ot">=</span> <span class="st">"id"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">location =</span> source,</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">vessel_id =</span> target,</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">vessel_name =</span> Name,</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">vessel_company =</span> company,</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">vessel_type=</span>type</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(time,ping_date,dwell, location,vessel_id,vessel_name,vessel_type,vessel_company,flag_country)</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by date, vessel_id, and city, and sum up dwell time</span></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>transponder_ping_day_sum_df <span class="ot">&lt;-</span> transponder_ping_df <span class="sc">%&gt;%</span></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ping_date, vessel_id, location,vessel_name,vessel_type,vessel_company) <span class="sc">%&gt;%</span></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_dwell_time =</span> <span class="fu">sum</span>(dwell, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add filter to exclude records where total_dwell_time is 0</span></span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(total_dwell_time <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>transponder_ping_city_df <span class="ot">&lt;-</span> transponder_ping_day_sum_df <span class="sc">%&gt;%</span></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"^City"</span>, location))</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>transponder_ping_non_city_df <span class="ot">&lt;-</span> transponder_ping_day_sum_df <span class="sc">%&gt;%</span></span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"^City"</span>, location))</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>transponder_ping_south_df <span class="ot">&lt;-</span> transponder_ping_day_sum_df <span class="sc">%&gt;%</span></span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"^SouthSeafood Express Corp"</span>, vessel_company))</span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a><span class="co"># preparing transactions</span></span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>transactions_df<span class="ot">&lt;-</span>transactions_df<span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">cargo_id =</span> source)</span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a><span class="co">#pivot fish and city as columns</span></span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>city_and_fish_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(city_df, fish_df)</span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a>transactions_type <span class="ot">&lt;-</span> transactions_df <span class="sc">%&gt;%</span></span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(city_and_fish_df, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"target"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date.x, cargo_id, target, type)</span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a>transactions_cargo <span class="ot">&lt;-</span> transactions_type <span class="sc">%&gt;%</span></span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> type, <span class="at">values_from =</span> target,  <span class="at">id_cols =</span> <span class="fu">c</span>(date.x, cargo_id))<span class="sc">%&gt;%</span></span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">date=</span>date.x,</span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">fish =</span> Entity.Commodity.Fish,</span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">city =</span> Entity.Location.City</span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a>transactions_cargo <span class="ot">&lt;-</span> transactions_cargo <span class="sc">%&gt;%</span></span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(fish_df, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"fish"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb38-67"><a href="#cb38-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date.x, cargo_id, fish, city,fish_name)<span class="sc">%&gt;%</span></span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a><span class="fu">rename</span>(<span class="at">date_of_arrival=</span>date.x,</span>
<span id="cb38-69"><a href="#cb38-69" aria-hidden="true" tabindex="-1"></a>       <span class="at">city_of_arrival=</span>city,</span>
<span id="cb38-70"><a href="#cb38-70" aria-hidden="true" tabindex="-1"></a>       <span class="at">fish_in_cargo=</span>fish</span>
<span id="cb38-71"><a href="#cb38-71" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb38-72"><a href="#cb38-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-73"><a href="#cb38-73" aria-hidden="true" tabindex="-1"></a>transactions_cargo <span class="ot">&lt;-</span> transactions_cargo <span class="sc">%&gt;%</span></span>
<span id="cb38-74"><a href="#cb38-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(delivery_report_df, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"cargo_id"</span><span class="ot">=</span><span class="st">"cargo_id"</span>,<span class="st">"date_of_arrival"</span> <span class="ot">=</span> <span class="st">"date"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb38-75"><a href="#cb38-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date_of_arrival,cargo_id, fish_in_cargo, city_of_arrival,fish_name,qty_tons)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="exploring-outlier-data" class="level2">
<h2 class="anchored" data-anchor-id="exploring-outlier-data"><strong>1.3 Exploring outlier data</strong></h2>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>iqr_qty <span class="ot">&lt;-</span> <span class="fu">IQR</span>(transactions_cargo<span class="sc">$</span>qty_tons)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>upper_bound <span class="ot">&lt;-</span> <span class="fu">quantile</span>(transactions_cargo<span class="sc">$</span>qty_tons, <span class="fl">0.75</span>) <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> iqr_qty</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> transactions_cargo[transactions_cargo<span class="sc">$</span>qty_tons <span class="sc">&gt;</span> upper_bound, ]</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a histogram</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(transactions_cargo<span class="sc">$</span>qty_tons)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add outliers as points</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(transactions_cargo<span class="sc">$</span>qty_tons[transactions_cargo<span class="sc">$</span>qty_tons <span class="sc">&gt;</span> upper_bound], </span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>       <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">sum</span>(transactions_cargo<span class="sc">$</span>qty_tons <span class="sc">&gt;</span> upper_bound)), </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Investigations_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Insight</strong> : Anomaly qty_tons are mostly greater than 70 tons</p>
</section>
<section id="plotting-fish-arrivals-over-time" class="level2">
<h2 class="anchored" data-anchor-id="plotting-fish-arrivals-over-time"><strong>1.4 Plotting fish arrivals over time</strong></h2>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>monthly_data <span class="ot">&lt;-</span> transactions_cargo <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">format</span>(date_of_arrival, <span class="st">"%Y-%m"</span>))</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert month to Date type for proper ordering in ggplot2</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>monthly_data<span class="sc">$</span>month <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(monthly_data<span class="sc">$</span>month, <span class="st">"-01"</span>))</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by month and fish_name, and summarize total quantity in tons</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>monthly_data <span class="ot">&lt;-</span> monthly_data <span class="sc">%&gt;%</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month, fish_name) <span class="sc">%&gt;%</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_qty =</span> <span class="fu">sum</span>(qty_tons)) <span class="sc">%&gt;%</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the data</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(monthly_data, <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> total_qty, <span class="at">color =</span> fish_name, <span class="at">group =</span> fish_name)) <span class="sc">+</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Monthly Fish Transactions"</span>, <span class="at">x =</span> <span class="st">"Month"</span>, <span class="at">y =</span> <span class="st">"Quantity in Tons"</span>)</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-0212911cda8800caee13" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-0212911cda8800caee13">{"x":{"data":[{"x":[23800,23831,23861,23892,23922,23953,23984,24014,24045],"y":[121.5,518.125,462.25,302.75,980.625,3947.75,845.375,2547.5,5504.125],"text":["month: 2035-03-01<br />total_qty:   121.500<br />fish_name: Beauvoir/Habeas pisces<br />fish_name: Beauvoir/Habeas pisces","month: 2035-04-01<br />total_qty:   518.125<br />fish_name: Beauvoir/Habeas pisces<br />fish_name: Beauvoir/Habeas pisces","month: 2035-05-01<br />total_qty:   462.250<br />fish_name: Beauvoir/Habeas pisces<br />fish_name: Beauvoir/Habeas pisces","month: 2035-06-01<br />total_qty:   302.750<br />fish_name: Beauvoir/Habeas pisces<br />fish_name: Beauvoir/Habeas pisces","month: 2035-07-01<br />total_qty:   980.625<br />fish_name: Beauvoir/Habeas pisces<br />fish_name: Beauvoir/Habeas pisces","month: 2035-08-01<br />total_qty:  3947.750<br />fish_name: Beauvoir/Habeas pisces<br />fish_name: Beauvoir/Habeas pisces","month: 2035-09-01<br />total_qty:   845.375<br />fish_name: Beauvoir/Habeas pisces<br />fish_name: Beauvoir/Habeas pisces","month: 2035-10-01<br />total_qty:  2547.500<br />fish_name: Beauvoir/Habeas pisces<br />fish_name: Beauvoir/Habeas pisces","month: 2035-11-01<br />total_qty:  5504.125<br />fish_name: Beauvoir/Habeas pisces<br />fish_name: Beauvoir/Habeas pisces"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"Beauvoir/Habeas pisces","legendgroup":"Beauvoir/Habeas pisces","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[23861,23892,23922,23953,23984,24014,24045],"y":[212,186.25,1205.375,1235.25,2842.25,4094.875,4203.25],"text":["month: 2035-05-01<br />total_qty:   212.000<br />fish_name: Birdseye/Pisces frigus<br />fish_name: Birdseye/Pisces frigus","month: 2035-06-01<br />total_qty:   186.250<br />fish_name: Birdseye/Pisces frigus<br />fish_name: Birdseye/Pisces frigus","month: 2035-07-01<br />total_qty:  1205.375<br />fish_name: Birdseye/Pisces frigus<br />fish_name: Birdseye/Pisces frigus","month: 2035-08-01<br />total_qty:  1235.250<br />fish_name: Birdseye/Pisces frigus<br />fish_name: Birdseye/Pisces frigus","month: 2035-09-01<br />total_qty:  2842.250<br />fish_name: Birdseye/Pisces frigus<br />fish_name: Birdseye/Pisces frigus","month: 2035-10-01<br />total_qty:  4094.875<br />fish_name: Birdseye/Pisces frigus<br />fish_name: Birdseye/Pisces frigus","month: 2035-11-01<br />total_qty:  4203.250<br />fish_name: Birdseye/Pisces frigus<br />fish_name: Birdseye/Pisces frigus"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(216,144,0,1)","dash":"solid"},"hoveron":"points","name":"Birdseye/Pisces frigus","legendgroup":"Birdseye/Pisces frigus","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[23800,23831,23861,23892,23922,23953,23984,24014,24045],"y":[328.625,63.75,356.625,874.625,1590.625,5518,9999,12123.25,6429.25],"text":["month: 2035-03-01<br />total_qty:   328.625<br />fish_name: Cod/Gadus n.specificatae<br />fish_name: Cod/Gadus n.specificatae","month: 2035-04-01<br />total_qty:    63.750<br />fish_name: Cod/Gadus n.specificatae<br />fish_name: Cod/Gadus n.specificatae","month: 2035-05-01<br />total_qty:   356.625<br />fish_name: Cod/Gadus n.specificatae<br />fish_name: Cod/Gadus n.specificatae","month: 2035-06-01<br />total_qty:   874.625<br />fish_name: Cod/Gadus n.specificatae<br />fish_name: Cod/Gadus n.specificatae","month: 2035-07-01<br />total_qty:  1590.625<br />fish_name: Cod/Gadus n.specificatae<br />fish_name: Cod/Gadus n.specificatae","month: 2035-08-01<br />total_qty:  5518.000<br />fish_name: Cod/Gadus n.specificatae<br />fish_name: Cod/Gadus n.specificatae","month: 2035-09-01<br />total_qty:  9999.000<br />fish_name: Cod/Gadus n.specificatae<br />fish_name: Cod/Gadus n.specificatae","month: 2035-10-01<br />total_qty: 12123.250<br />fish_name: Cod/Gadus n.specificatae<br />fish_name: Cod/Gadus n.specificatae","month: 2035-11-01<br />total_qty:  6429.250<br />fish_name: Cod/Gadus n.specificatae<br />fish_name: Cod/Gadus n.specificatae"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"Cod/Gadus n.specificatae","legendgroup":"Cod/Gadus n.specificatae","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[23800,23831,23861,23892,23922,23953,23984,24014,24045],"y":[15.75,894.25,920.625,846.75,845.125,432.125,1309.125,2767.125,3110.75],"text":["month: 2035-03-01<br />total_qty:    15.750<br />fish_name: Harland/Piscis sapidum<br />fish_name: Harland/Piscis sapidum","month: 2035-04-01<br />total_qty:   894.250<br />fish_name: Harland/Piscis sapidum<br />fish_name: Harland/Piscis sapidum","month: 2035-05-01<br />total_qty:   920.625<br />fish_name: Harland/Piscis sapidum<br />fish_name: Harland/Piscis sapidum","month: 2035-06-01<br />total_qty:   846.750<br />fish_name: Harland/Piscis sapidum<br />fish_name: Harland/Piscis sapidum","month: 2035-07-01<br />total_qty:   845.125<br />fish_name: Harland/Piscis sapidum<br />fish_name: Harland/Piscis sapidum","month: 2035-08-01<br />total_qty:   432.125<br />fish_name: Harland/Piscis sapidum<br />fish_name: Harland/Piscis sapidum","month: 2035-09-01<br />total_qty:  1309.125<br />fish_name: Harland/Piscis sapidum<br />fish_name: Harland/Piscis sapidum","month: 2035-10-01<br />total_qty:  2767.125<br />fish_name: Harland/Piscis sapidum<br />fish_name: Harland/Piscis sapidum","month: 2035-11-01<br />total_qty:  3110.750<br />fish_name: Harland/Piscis sapidum<br />fish_name: Harland/Piscis sapidum"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(57,182,0,1)","dash":"solid"},"hoveron":"points","name":"Harland/Piscis sapidum","legendgroup":"Harland/Piscis sapidum","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[23861,23892,23922,23953,24014,24045],"y":[121.625,32.375,129.5,65.625,35.375,199.5],"text":["month: 2035-05-01<br />total_qty:   121.625<br />fish_name: Helenaa/Pisces satis<br />fish_name: Helenaa/Pisces satis","month: 2035-06-01<br />total_qty:    32.375<br />fish_name: Helenaa/Pisces satis<br />fish_name: Helenaa/Pisces satis","month: 2035-07-01<br />total_qty:   129.500<br />fish_name: Helenaa/Pisces satis<br />fish_name: Helenaa/Pisces satis","month: 2035-08-01<br />total_qty:    65.625<br />fish_name: Helenaa/Pisces satis<br />fish_name: Helenaa/Pisces satis","month: 2035-10-01<br />total_qty:    35.375<br />fish_name: Helenaa/Pisces satis<br />fish_name: Helenaa/Pisces satis","month: 2035-11-01<br />total_qty:   199.500<br />fish_name: Helenaa/Pisces satis<br />fish_name: Helenaa/Pisces satis"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"Helenaa/Pisces satis","legendgroup":"Helenaa/Pisces satis","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[23984,24014,24045],"y":[305.375,795.875,2299.25],"text":["month: 2035-09-01<br />total_qty:   305.375<br />fish_name: Offidiaa/Piscis osseus<br />fish_name: Offidiaa/Piscis osseus","month: 2035-10-01<br />total_qty:   795.875<br />fish_name: Offidiaa/Piscis osseus<br />fish_name: Offidiaa/Piscis osseus","month: 2035-11-01<br />total_qty:  2299.250<br />fish_name: Offidiaa/Piscis osseus<br />fish_name: Offidiaa/Piscis osseus"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"Offidiaa/Piscis osseus","legendgroup":"Offidiaa/Piscis osseus","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[23922,23953,23984,24014],"y":[332,1856.125,2845.625,1042.375],"text":["month: 2035-07-01<br />total_qty:   332.000<br />fish_name: Salmon/Oncorhynchus rosea<br />fish_name: Salmon/Oncorhynchus rosea","month: 2035-08-01<br />total_qty:  1856.125<br />fish_name: Salmon/Oncorhynchus rosea<br />fish_name: Salmon/Oncorhynchus rosea","month: 2035-09-01<br />total_qty:  2845.625<br />fish_name: Salmon/Oncorhynchus rosea<br />fish_name: Salmon/Oncorhynchus rosea","month: 2035-10-01<br />total_qty:  1042.375<br />fish_name: Salmon/Oncorhynchus rosea<br />fish_name: Salmon/Oncorhynchus rosea"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"Salmon/Oncorhynchus rosea","legendgroup":"Salmon/Oncorhynchus rosea","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[23831,23861,23892,23922,23953,23984,24014,24045],"y":[11.375,1131.5,617.375,702.25,1394.375,1003,1855,2783],"text":["month: 2035-04-01<br />total_qty:    11.375<br />fish_name: Sockfish/Pisces foetida<br />fish_name: Sockfish/Pisces foetida","month: 2035-05-01<br />total_qty:  1131.500<br />fish_name: Sockfish/Pisces foetida<br />fish_name: Sockfish/Pisces foetida","month: 2035-06-01<br />total_qty:   617.375<br />fish_name: Sockfish/Pisces foetida<br />fish_name: Sockfish/Pisces foetida","month: 2035-07-01<br />total_qty:   702.250<br />fish_name: Sockfish/Pisces foetida<br />fish_name: Sockfish/Pisces foetida","month: 2035-08-01<br />total_qty:  1394.375<br />fish_name: Sockfish/Pisces foetida<br />fish_name: Sockfish/Pisces foetida","month: 2035-09-01<br />total_qty:  1003.000<br />fish_name: Sockfish/Pisces foetida<br />fish_name: Sockfish/Pisces foetida","month: 2035-10-01<br />total_qty:  1855.000<br />fish_name: Sockfish/Pisces foetida<br />fish_name: Sockfish/Pisces foetida","month: 2035-11-01<br />total_qty:  2783.000<br />fish_name: Sockfish/Pisces foetida<br />fish_name: Sockfish/Pisces foetida"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(149,144,255,1)","dash":"solid"},"hoveron":"points","name":"Sockfish/Pisces foetida","legendgroup":"Sockfish/Pisces foetida","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[24014,24045],"y":[269.75,89.375],"text":["month: 2035-10-01<br />total_qty:   269.750<br />fish_name: Tuna/Thunnini n.vera<br />fish_name: Tuna/Thunnini n.vera","month: 2035-11-01<br />total_qty:    89.375<br />fish_name: Tuna/Thunnini n.vera<br />fish_name: Tuna/Thunnini n.vera"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"Tuna/Thunnini n.vera","legendgroup":"Tuna/Thunnini n.vera","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[23772,23800,23831,23861,23892,23922,23953,23984,24014,24045],"y":[1307,1855.25,1505.625,1799.5,2229.375,3026.125,4248.875,4105.625,4234.125,4398],"text":["month: 2035-02-01<br />total_qty:  1307.000<br />fish_name: Wrasse/Labridae n.refert<br />fish_name: Wrasse/Labridae n.refert","month: 2035-03-01<br />total_qty:  1855.250<br />fish_name: Wrasse/Labridae n.refert<br />fish_name: Wrasse/Labridae n.refert","month: 2035-04-01<br />total_qty:  1505.625<br />fish_name: Wrasse/Labridae n.refert<br />fish_name: Wrasse/Labridae n.refert","month: 2035-05-01<br />total_qty:  1799.500<br />fish_name: Wrasse/Labridae n.refert<br />fish_name: Wrasse/Labridae n.refert","month: 2035-06-01<br />total_qty:  2229.375<br />fish_name: Wrasse/Labridae n.refert<br />fish_name: Wrasse/Labridae n.refert","month: 2035-07-01<br />total_qty:  3026.125<br />fish_name: Wrasse/Labridae n.refert<br />fish_name: Wrasse/Labridae n.refert","month: 2035-08-01<br />total_qty:  4248.875<br />fish_name: Wrasse/Labridae n.refert<br />fish_name: Wrasse/Labridae n.refert","month: 2035-09-01<br />total_qty:  4105.625<br />fish_name: Wrasse/Labridae n.refert<br />fish_name: Wrasse/Labridae n.refert","month: 2035-10-01<br />total_qty:  4234.125<br />fish_name: Wrasse/Labridae n.refert<br />fish_name: Wrasse/Labridae n.refert","month: 2035-11-01<br />total_qty:  4398.000<br />fish_name: Wrasse/Labridae n.refert<br />fish_name: Wrasse/Labridae n.refert"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,98,188,1)","dash":"solid"},"hoveron":"points","name":"Wrasse/Labridae n.refert","legendgroup":"Wrasse/Labridae n.refert","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":54.794520547945211},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Monthly Fish Transactions","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[23758.349999999999,24058.650000000001],"tickmode":"array","ticktext":["Apr","Jul","Oct"],"tickvals":[23831,23922,24014],"categoryorder":"array","categoryarray":["Apr","Jul","Oct"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Month","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-594.21875,12728.84375],"tickmode":"array","ticktext":["0","2500","5000","7500","10000","12500"],"tickvals":[0,2500,5000,7500.0000000000009,10000,12500],"categoryorder":"array","categoryarray":["0","2500","5000","7500","10000","12500"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Quantity in Tons","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"fish_name","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"296470205553":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"296470205553","visdat":{"296470205553":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><strong>Insights:</strong></p>
<ol type="1">
<li>Huge increase in Cod arrivals starting from July. This can be investigated for <strong>illegal</strong> fishing exceeding allowed limits.</li>
<li>There are Salmon cargoes arriving,but cant attribute salmon to fishing grounds or ecological preserves. So it might be <strong>unregulated</strong> fishing from locations where fishing is not supposed to be done.</li>
<li><strong>Protected species</strong> ( Sockfish/Pisces foetida,Helenaa/Pisces satis, Offidiaa/Piscis osseus ) are arriving in cargo and need to be explored</li>
</ol>
</section>
<section id="plotting-protected-fish-quantities-arriving-at-each-city-over-time" class="level2">
<h2 class="anchored" data-anchor-id="plotting-protected-fish-quantities-arriving-at-each-city-over-time"><strong>1.5 Plotting protected fish quantities arriving at each city over time</strong></h2>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>city_time_analysis <span class="ot">&lt;-</span> transactions_cargo <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month_of_arrival =</span> <span class="fu">format</span>(date_of_arrival, <span class="st">"%Y-%m"</span>))</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert month to Date type for proper ordering in ggplot2</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>city_time_analysis<span class="sc">$</span>month_of_arrival <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(city_time_analysis<span class="sc">$</span>month_of_arrival, <span class="st">"-01"</span>))</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by month and fish_name, and summarize total quantity in tons</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>city_time_analysis <span class="ot">&lt;-</span> city_time_analysis <span class="sc">%&gt;%</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month_of_arrival,city_of_arrival,fish_name) <span class="sc">%&gt;%</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_qty =</span> <span class="fu">sum</span>(qty_tons)) <span class="sc">%&gt;%</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Example endangered fish list</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>endangered_fish <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">" Helenaa/Pisces satis"</span>, <span class="st">"Offidiaa/Piscis osseus"</span>,<span class="st">"Sockfish/Pisces foetida"</span>)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a color palette, highlighting endangered species</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>fish_colors <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(city_time_analysis<span class="sc">$</span>fish_name <span class="sc">%in%</span> endangered_fish, <span class="st">"red"</span>, <span class="st">"grey"</span>)  <span class="co"># This creates a vector of 'red' or 'grey'</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>unique_fish <span class="ot">&lt;-</span> <span class="fu">unique</span>(city_time_analysis<span class="sc">$</span>fish_name)</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">ifelse</span>(unique_fish <span class="sc">%in%</span> endangered_fish, <span class="st">"red"</span>, <span class="st">"grey"</span>), unique_fish)</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a custom color scale to the plot</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(city_time_analysis, <span class="fu">aes</span>(<span class="at">x =</span> month_of_arrival, <span class="at">y =</span> total_qty, <span class="at">fill =</span> fish_name)) <span class="sc">+</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> city_of_arrival, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Fish Arrivals by City Over Time"</span>, <span class="at">subtitle =</span> <span class="st">"Red highlights endangered species"</span>,</span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month of Arrival"</span>, <span class="at">y =</span> <span class="st">"Total Quantity in Tons"</span>) <span class="sc">+</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to an interactive plotly plot</span></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>interactive_plot <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(p)</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>interactive_plot <span class="ot">&lt;-</span> interactive_plot <span class="sc">%&gt;%</span></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">hoverlabel =</span> <span class="fu">list</span>(<span class="at">bgcolor =</span> <span class="st">"white"</span>),</span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">hoverinfo =</span> <span class="st">"text"</span>,</span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">tooltip =</span> <span class="fu">c</span>(<span class="st">"month_of_arrival"</span>, <span class="st">"qty_tons"</span>, <span class="st">"fish_name"</span>)</span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>interactive_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-df5dd061af6ccf8dfb93" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-df5dd061af6ccf8dfb93">{"x":{"data":[{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[1029.125,1577.75,2870.5,3280.875,2609],"x":[23922,23953,23984,24014,24045],"y":[42.625,472.5,22.5,297.875,734.5],"text":["month_of_arrival: 2035-07-01<br />total_qty:   42.625<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-08-01<br />total_qty:  472.500<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-09-01<br />total_qty:   22.500<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-10-01<br />total_qty:  297.875<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-11-01<br />total_qty:  734.500<br />fish_name: Beauvoir/Habeas pisces"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Beauvoir/Habeas pisces","legendgroup":"Beauvoir/Habeas pisces","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[1074.625,1575.75,2273.625,2855.125,2962.875,4135.375,4415.125,5660.5],"x":[23800,23831,23861,23892,23922,23953,24014,24045],"y":[121.5,518.125,254.125,189,321.75,38.25,748.5,661.625],"text":["month_of_arrival: 2035-03-01<br />total_qty:  121.500<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-04-01<br />total_qty:  518.125<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-05-01<br />total_qty:  254.125<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-06-01<br />total_qty:  189.000<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-07-01<br />total_qty:  321.750<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-08-01<br />total_qty:   38.250<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-10-01<br />total_qty:  748.500<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-11-01<br />total_qty:  661.625<br />fish_name: Beauvoir/Habeas pisces"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Beauvoir/Habeas pisces","legendgroup":"Beauvoir/Habeas pisces","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[3390.25,5329,6446.625,4213.75],"x":[23953,23984,24014,24045],"y":[453.625,41.125,406.5,1042.5],"text":["month_of_arrival: 2035-08-01<br />total_qty:  453.625<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-09-01<br />total_qty:   41.125<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-10-01<br />total_qty:  406.500<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-11-01<br />total_qty: 1042.500<br />fish_name: Beauvoir/Habeas pisces"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Beauvoir/Habeas pisces","legendgroup":"Beauvoir/Habeas pisces","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[1393.25,4377.25,5962.75,7811.875,8114.875],"x":[23922,23953,23984,24014,24045],"y":[17.5,1232,527.5,428.375,979.625],"text":["month_of_arrival: 2035-07-01<br />total_qty:   17.500<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-08-01<br />total_qty: 1232.000<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-09-01<br />total_qty:  527.500<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-10-01<br />total_qty:  428.375<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-11-01<br />total_qty:  979.625<br />fish_name: Beauvoir/Habeas pisces"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Beauvoir/Habeas pisces","legendgroup":"Beauvoir/Habeas pisces","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[318.375,283.875,696,1269.75,4179,5263.25,2914.25],"x":[23861,23892,23922,23953,23984,24014,24045],"y":[208.125,113.75,598.75,1751.375,254.25,666.25,2085.875],"text":["month_of_arrival: 2035-05-01<br />total_qty:  208.125<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-06-01<br />total_qty:  113.750<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-07-01<br />total_qty:  598.750<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-08-01<br />total_qty: 1751.375<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-09-01<br />total_qty:  254.250<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-10-01<br />total_qty:  666.250<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-11-01<br />total_qty: 2085.875<br />fish_name: Beauvoir/Habeas pisces"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Beauvoir/Habeas pisces","legendgroup":"Beauvoir/Habeas pisces","showlegend":false,"xaxis":"x2","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[442.625,964.5,1374.75,2591.875,3144.25,2232.375],"x":[23892,23922,23953,23984,24014,24045],"y":[31.25,64.625,203,278.625,136.625,376.625],"text":["month_of_arrival: 2035-06-01<br />total_qty:   31.250<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-07-01<br />total_qty:   64.625<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-08-01<br />total_qty:  203.000<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-09-01<br />total_qty:  278.625<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-10-01<br />total_qty:  136.625<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-11-01<br />total_qty:  376.625<br />fish_name: Birdseye/Pisces frigus"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Birdseye/Pisces frigus","legendgroup":"Birdseye/Pisces frigus","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[2061.625,2823.125,4254.625,5209],"x":[23861,23892,24014,24045],"y":[212,32,160.5,451.5],"text":["month_of_arrival: 2035-05-01<br />total_qty:  212.000<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-06-01<br />total_qty:   32.000<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-10-01<br />total_qty:  160.500<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-11-01<br />total_qty:  451.500<br />fish_name: Birdseye/Pisces frigus"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Birdseye/Pisces frigus","legendgroup":"Birdseye/Pisces frigus","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[239.25,1239.5,2869.5,4462.5,5262.75,2988.5],"x":[23892,23922,23953,23984,24014,24045],"y":[123,510.25,520.75,866.5,1183.875,1225.25],"text":["month_of_arrival: 2035-06-01<br />total_qty:  123.000<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-07-01<br />total_qty:  510.250<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-08-01<br />total_qty:  520.750<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-09-01<br />total_qty:  866.500<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-10-01<br />total_qty: 1183.875<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-11-01<br />total_qty: 1225.250<br />fish_name: Birdseye/Pisces frigus"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Birdseye/Pisces frigus","legendgroup":"Birdseye/Pisces frigus","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[1390.75,4331,5650.75,6910.75,6440.625],"x":[23922,23953,23984,24014,24045],"y":[2.5,46.25,312,901.125,1674.25],"text":["month_of_arrival: 2035-07-01<br />total_qty:    2.500<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-08-01<br />total_qty:   46.250<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-09-01<br />total_qty:  312.000<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-10-01<br />total_qty:  901.125<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-11-01<br />total_qty: 1674.250<br />fish_name: Birdseye/Pisces frigus"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Birdseye/Pisces frigus","legendgroup":"Birdseye/Pisces frigus","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[68,804.5,2793.875,3550.5,2438.625],"x":[23922,23953,23984,24014,24045],"y":[628,465.25,1385.125,1712.75,475.625],"text":["month_of_arrival: 2035-07-01<br />total_qty:  628.000<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-08-01<br />total_qty:  465.250<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-09-01<br />total_qty: 1385.125<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-10-01<br />total_qty: 1712.750<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-11-01<br />total_qty:  475.625<br />fish_name: Birdseye/Pisces frigus"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Birdseye/Pisces frigus","legendgroup":"Birdseye/Pisces frigus","showlegend":false,"xaxis":"x2","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[517,259.5,801.5,1300.5,2335.375,2586,1682.375],"x":[23861,23892,23922,23953,23984,24014,24045],"y":[44.125,183.125,163,74.25,256.5,558.25,550],"text":["month_of_arrival: 2035-05-01<br />total_qty:   44.125<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-06-01<br />total_qty:  183.125<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-07-01<br />total_qty:  163.000<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-08-01<br />total_qty:   74.250<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-09-01<br />total_qty:  256.500<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-10-01<br />total_qty:  558.250<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-11-01<br />total_qty:  550.000<br />fish_name: Cod/Gadus n.specificatae"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Cod/Gadus n.specificatae","legendgroup":"Cod/Gadus n.specificatae","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[2760.625,4055.375,3750.5,4006.875,4967.875],"x":[23892,23953,23984,24014,24045],"y":[62.5,80,318.25,247.75,241.125],"text":["month_of_arrival: 2035-06-01<br />total_qty:   62.500<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-08-01<br />total_qty:   80.000<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-09-01<br />total_qty:  318.250<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-10-01<br />total_qty:  247.750<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-11-01<br />total_qty:  241.125<br />fish_name: Cod/Gadus n.specificatae"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Cod/Gadus n.specificatae","legendgroup":"Cod/Gadus n.specificatae","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[0,0,0,0,222.125,565.5,421.5,1147,1357.125],"x":[23800,23831,23861,23892,23922,23953,23984,24014,24045],"y":[73,63.75,34,239.25,1017.375,2304,4041,4115.75,1631.375],"text":["month_of_arrival: 2035-03-01<br />total_qty:   73.000<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-04-01<br />total_qty:   63.750<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-05-01<br />total_qty:   34.000<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-06-01<br />total_qty:  239.250<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-07-01<br />total_qty: 1017.375<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-08-01<br />total_qty: 2304.000<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-09-01<br />total_qty: 4041.000<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-10-01<br />total_qty: 4115.750<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-11-01<br />total_qty: 1631.375<br />fish_name: Cod/Gadus n.specificatae"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Cod/Gadus n.specificatae","legendgroup":"Cod/Gadus n.specificatae","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[386,706.25,1048.5,1898,2707.25,2839.875,4128],"x":[23800,23892,23922,23953,23984,24014,24045],"y":[207.375,105.875,342.25,2433,2943.5,4070.875,2312.625],"text":["month_of_arrival: 2035-03-01<br />total_qty:  207.375<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-06-01<br />total_qty:  105.875<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-07-01<br />total_qty:  342.250<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-08-01<br />total_qty: 2433.000<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-09-01<br />total_qty: 2943.500<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-10-01<br />total_qty: 4070.875<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-11-01<br />total_qty: 2312.625<br />fish_name: Cod/Gadus n.specificatae"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Cod/Gadus n.specificatae","legendgroup":"Cod/Gadus n.specificatae","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[0,39.875,0,0,177.75,354.125,419.875,744.5],"x":[23800,23861,23892,23922,23953,23984,24014,24045],"y":[48.25,278.5,283.875,68,626.75,2439.75,3130.625,1694.125],"text":["month_of_arrival: 2035-03-01<br />total_qty:   48.250<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-05-01<br />total_qty:  278.500<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-06-01<br />total_qty:  283.875<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-07-01<br />total_qty:   68.000<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-08-01<br />total_qty:  626.750<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-09-01<br />total_qty: 2439.750<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-10-01<br />total_qty: 3130.625<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-11-01<br />total_qty: 1694.125<br />fish_name: Cod/Gadus n.specificatae"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Cod/Gadus n.specificatae","legendgroup":"Cod/Gadus n.specificatae","showlegend":false,"xaxis":"x2","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[394.625,198.5,323.125,221.375,784.25,1142.25,1493.125,1094.875,804.75],"x":[23800,23831,23861,23892,23922,23953,23984,24014,24045],"y":[15.75,29.25,193.875,38.125,17.25,158.25,842.25,1491.125,877.625],"text":["month_of_arrival: 2035-03-01<br />total_qty:   15.750<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-04-01<br />total_qty:   29.250<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-05-01<br />total_qty:  193.875<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-06-01<br />total_qty:   38.125<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-07-01<br />total_qty:   17.250<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-08-01<br />total_qty:  158.250<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-09-01<br />total_qty:  842.250<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-10-01<br />total_qty: 1491.125<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-11-01<br />total_qty:  877.625<br />fish_name: Harland/Piscis sapidum"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Harland/Piscis sapidum","legendgroup":"Harland/Piscis sapidum","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[975,1699.375,2040,2589.75,3832.625,3569.375,3706.125,4613],"x":[23831,23861,23892,23922,23953,23984,24014,24045],"y":[600.75,362.25,720.625,373.125,222.75,181.125,300.75,354.875],"text":["month_of_arrival: 2035-04-01<br />total_qty:  600.750<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-05-01<br />total_qty:  362.250<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-06-01<br />total_qty:  720.625<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-07-01<br />total_qty:  373.125<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-08-01<br />total_qty:  222.750<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-09-01<br />total_qty:  181.125<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-10-01<br />total_qty:  300.750<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-11-01<br />total_qty:  354.875<br />fish_name: Harland/Piscis sapidum"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Harland/Piscis sapidum","legendgroup":"Harland/Piscis sapidum","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709],"base":[-0.5,776.5,918.5],"x":[23892,24014,24045],"y":[0.5,370.5,438.625],"text":["month_of_arrival: 2035-06-01<br />total_qty:    0.500<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-10-01<br />total_qty:  370.500<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-11-01<br />total_qty:  438.625<br />fish_name: Harland/Piscis sapidum"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Harland/Piscis sapidum","legendgroup":"Harland/Piscis sapidum","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[343.5,1030.125,617.75,593.75,1846.875,2558.5,2273.25,3095.125],"x":[23831,23861,23892,23922,23953,23984,24014,24045],"y":[264.25,324.625,88.5,454.75,51.125,148.75,566.625,1032.875],"text":["month_of_arrival: 2035-04-01<br />total_qty:  264.250<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-05-01<br />total_qty:  324.625<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-06-01<br />total_qty:   88.500<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-07-01<br />total_qty:  454.750<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-08-01<br />total_qty:   51.125<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-09-01<br />total_qty:  148.750<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-10-01<br />total_qty:  566.625<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-11-01<br />total_qty: 1032.875<br />fish_name: Harland/Piscis sapidum"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Harland/Piscis sapidum","legendgroup":"Harland/Piscis sapidum","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[0,217.125,381.75,337.75],"x":[23861,23984,24014,24045],"y":[39.875,137,38.125,406.75],"text":["month_of_arrival: 2035-05-01<br />total_qty:   39.875<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-09-01<br />total_qty:  137.000<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-10-01<br />total_qty:   38.125<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-11-01<br />total_qty:  406.750<br />fish_name: Harland/Piscis sapidum"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Harland/Piscis sapidum","legendgroup":"Harland/Piscis sapidum","showlegend":false,"xaxis":"x2","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709],"base":[2460.25,3770.5],"x":[23922,23953],"y":[129.5,62.125],"text":["month_of_arrival: 2035-07-01<br />total_qty:  129.500<br />fish_name: Helenaa/Pisces satis","month_of_arrival: 2035-08-01<br />total_qty:   62.125<br />fish_name: Helenaa/Pisces satis"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Helenaa/Pisces satis","legendgroup":"Helenaa/Pisces satis","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":25.19999999999709,"base":757.375,"x":[24014],"y":[19.125],"text":"month_of_arrival: 2035-10-01<br />total_qty:   19.125<br />fish_name: Helenaa/Pisces satis","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Helenaa/Pisces satis","legendgroup":"Helenaa/Pisces satis","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[908.5,585.375,1843.375,2257,2895.625],"x":[23861,23892,23953,24014,24045],"y":[121.625,32.375,3.5,16.25,199.5],"text":["month_of_arrival: 2035-05-01<br />total_qty:  121.625<br />fish_name: Helenaa/Pisces satis","month_of_arrival: 2035-06-01<br />total_qty:   32.375<br />fish_name: Helenaa/Pisces satis","month_of_arrival: 2035-08-01<br />total_qty:    3.500<br />fish_name: Helenaa/Pisces satis","month_of_arrival: 2035-10-01<br />total_qty:   16.250<br />fish_name: Helenaa/Pisces satis","month_of_arrival: 2035-11-01<br />total_qty:  199.500<br />fish_name: Helenaa/Pisces satis"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Helenaa/Pisces satis","legendgroup":"Helenaa/Pisces satis","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709],"base":[489.75,480.75],"x":[24014,24045],"y":[267.625,437.75],"text":["month_of_arrival: 2035-10-01<br />total_qty:  267.625<br />fish_name: Offidiaa/Piscis osseus","month_of_arrival: 2035-11-01<br />total_qty:  437.750<br />fish_name: Offidiaa/Piscis osseus"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Offidiaa/Piscis osseus","legendgroup":"Offidiaa/Piscis osseus","showlegend":true,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709],"base":[2253.125,1813.25,1224.75],"x":[23984,24014,24045],"y":[305.375,443.75,1670.875],"text":["month_of_arrival: 2035-09-01<br />total_qty:  305.375<br />fish_name: Offidiaa/Piscis osseus","month_of_arrival: 2035-10-01<br />total_qty:  443.750<br />fish_name: Offidiaa/Piscis osseus","month_of_arrival: 2035-11-01<br />total_qty: 1670.875<br />fish_name: Offidiaa/Piscis osseus"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Offidiaa/Piscis osseus","legendgroup":"Offidiaa/Piscis osseus","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709],"base":[297.25,147.125],"x":[24014,24045],"y":[84.5,190.625],"text":["month_of_arrival: 2035-10-01<br />total_qty:   84.500<br />fish_name: Offidiaa/Piscis osseus","month_of_arrival: 2035-11-01<br />total_qty:  190.625<br />fish_name: Offidiaa/Piscis osseus"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Offidiaa/Piscis osseus","legendgroup":"Offidiaa/Piscis osseus","showlegend":false,"xaxis":"x2","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[452.25,388.5,581,734.5],"x":[23922,23953,23984,24014],"y":[332,753.75,912.125,360.375],"text":["month_of_arrival: 2035-07-01<br />total_qty:  332.000<br />fish_name: Salmon/Oncorhynchus rosea","month_of_arrival: 2035-08-01<br />total_qty:  753.750<br />fish_name: Salmon/Oncorhynchus rosea","month_of_arrival: 2035-09-01<br />total_qty:  912.125<br />fish_name: Salmon/Oncorhynchus rosea","month_of_arrival: 2035-10-01<br />total_qty:  360.375<br />fish_name: Salmon/Oncorhynchus rosea"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Salmon/Oncorhynchus rosea","legendgroup":"Salmon/Oncorhynchus rosea","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709],"base":[3632.5,3239.625,3497.625],"x":[23953,23984,24014],"y":[138,329.75,208.5],"text":["month_of_arrival: 2035-08-01<br />total_qty:  138.000<br />fish_name: Salmon/Oncorhynchus rosea","month_of_arrival: 2035-09-01<br />total_qty:  329.750<br />fish_name: Salmon/Oncorhynchus rosea","month_of_arrival: 2035-10-01<br />total_qty:  208.500<br />fish_name: Salmon/Oncorhynchus rosea"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Salmon/Oncorhynchus rosea","legendgroup":"Salmon/Oncorhynchus rosea","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":25.19999999999709,"base":541.5,"x":[23953],"y":[24],"text":"month_of_arrival: 2035-08-01<br />total_qty:   24.000<br />fish_name: Salmon/Oncorhynchus rosea","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Salmon/Oncorhynchus rosea","legendgroup":"Salmon/Oncorhynchus rosea","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709],"base":[919,837.25,1429],"x":[23953,23984,24014],"y":[924.375,1415.875,384.25],"text":["month_of_arrival: 2035-08-01<br />total_qty:  924.375<br />fish_name: Salmon/Oncorhynchus rosea","month_of_arrival: 2035-09-01<br />total_qty: 1415.875<br />fish_name: Salmon/Oncorhynchus rosea","month_of_arrival: 2035-10-01<br />total_qty:  384.250<br />fish_name: Salmon/Oncorhynchus rosea"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Salmon/Oncorhynchus rosea","legendgroup":"Salmon/Oncorhynchus rosea","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709],"base":[161.75,29.25,208],"x":[23953,23984,24014],"y":[16,187.875,89.25],"text":["month_of_arrival: 2035-08-01<br />total_qty:   16.000<br />fish_name: Salmon/Oncorhynchus rosea","month_of_arrival: 2035-09-01<br />total_qty:  187.875<br />fish_name: Salmon/Oncorhynchus rosea","month_of_arrival: 2035-10-01<br />total_qty:   89.250<br />fish_name: Salmon/Oncorhynchus rosea"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Salmon/Oncorhynchus rosea","legendgroup":"Salmon/Oncorhynchus rosea","showlegend":false,"xaxis":"x2","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[313.75,235.625,388.625,494.75,230],"x":[23922,23953,23984,24014,24045],"y":[138.5,152.875,192.375,239.75,574.75],"text":["month_of_arrival: 2035-07-01<br />total_qty:  138.500<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-08-01<br />total_qty:  152.875<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-09-01<br />total_qty:  192.375<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-10-01<br />total_qty:  239.750<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-11-01<br />total_qty:  574.750<br />fish_name: Sockfish/Pisces foetida"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Sockfish/Pisces foetida","legendgroup":"Sockfish/Pisces foetida","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[963.625,1185.375,1510.875,1998.5,2855,2695.875,3035.25,3232],"x":[23831,23861,23892,23922,23953,23984,24014,24045],"y":[11.375,514,529.125,461.75,777.5,543.75,462.375,1381],"text":["month_of_arrival: 2035-04-01<br />total_qty:   11.375<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-05-01<br />total_qty:  514.000<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-06-01<br />total_qty:  529.125<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-07-01<br />total_qty:  461.750<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-08-01<br />total_qty:  777.500<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-09-01<br />total_qty:  543.750<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-10-01<br />total_qty:  462.375<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-11-01<br />total_qty: 1381.000<br />fish_name: Sockfish/Pisces foetida"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Sockfish/Pisces foetida","legendgroup":"Sockfish/Pisces foetida","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[291,497.125,491.75,616.75,599.625,424,544.625],"x":[23861,23892,23922,23953,23984,24014,24045],"y":[617.5,88.25,102,302.25,237.625,1005,680.125],"text":["month_of_arrival: 2035-05-01<br />total_qty:  617.500<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-06-01<br />total_qty:   88.250<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-07-01<br />total_qty:  102.000<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-08-01<br />total_qty:  302.250<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-09-01<br />total_qty:  237.625<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-10-01<br />total_qty: 1005.000<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-11-01<br />total_qty:  680.125<br />fish_name: Sockfish/Pisces foetida"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Sockfish/Pisces foetida","legendgroup":"Sockfish/Pisces foetida","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[0,0,60.125,0],"x":[23953,23984,24014,24045],"y":[161.75,29.25,147.875,147.125],"text":["month_of_arrival: 2035-08-01<br />total_qty:  161.750<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-09-01<br />total_qty:   29.250<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-10-01<br />total_qty:  147.875<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-11-01<br />total_qty:  147.125<br />fish_name: Sockfish/Pisces foetida"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Sockfish/Pisces foetida","legendgroup":"Sockfish/Pisces foetida","showlegend":false,"xaxis":"x2","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709],"base":[285.125,140.625],"x":[24014,24045],"y":[209.625,89.375],"text":["month_of_arrival: 2035-10-01<br />total_qty:  209.625<br />fish_name: Tuna/Thunnini n.vera","month_of_arrival: 2035-11-01<br />total_qty:   89.375<br />fish_name: Tuna/Thunnini n.vera"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Tuna/Thunnini n.vera","legendgroup":"Tuna/Thunnini n.vera","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":25.19999999999709,"base":0,"x":[24014],"y":[60.125],"text":"month_of_arrival: 2035-10-01<br />total_qty:   60.125<br />fish_name: Tuna/Thunnini n.vera","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Tuna/Thunnini n.vera","legendgroup":"Tuna/Thunnini n.vera","showlegend":false,"xaxis":"x2","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[0,0,0,0,0,0,0,0,0,0],"x":[23772,23800,23831,23861,23892,23922,23953,23984,24014,24045],"y":[299.5,394.625,198.5,323.125,221.375,313.75,235.625,388.625,285.125,140.625],"text":["month_of_arrival: 2035-02-01<br />total_qty:  299.500<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-03-01<br />total_qty:  394.625<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-04-01<br />total_qty:  198.500<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-05-01<br />total_qty:  323.125<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-06-01<br />total_qty:  221.375<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-07-01<br />total_qty:  313.750<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-08-01<br />total_qty:  235.625<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-09-01<br />total_qty:  388.625<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-10-01<br />total_qty:  285.125<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-11-01<br />total_qty:  140.625<br />fish_name: Wrasse/Labridae n.refert"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Wrasse/Labridae n.refert","legendgroup":"Wrasse/Labridae n.refert","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[0,0,0,0,0,0,0,0,0,0],"x":[23772,23800,23831,23861,23892,23922,23953,23984,24014,24045],"y":[791.25,1074.625,963.625,1185.375,1510.875,1998.5,2855,2695.875,3035.25,3232],"text":["month_of_arrival: 2035-02-01<br />total_qty:  791.250<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-03-01<br />total_qty: 1074.625<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-04-01<br />total_qty:  963.625<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-05-01<br />total_qty: 1185.375<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-06-01<br />total_qty: 1510.875<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-07-01<br />total_qty: 1998.500<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-08-01<br />total_qty: 2855.000<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-09-01<br />total_qty: 2695.875<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-10-01<br />total_qty: 3035.250<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-11-01<br />total_qty: 3232.000<br />fish_name: Wrasse/Labridae n.refert"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Wrasse/Labridae n.refert","legendgroup":"Wrasse/Labridae n.refert","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[0,0,0,0,0],"x":[23922,23953,23984,24014,24045],"y":[222.125,541.5,421.5,489.75,480.75],"text":["month_of_arrival: 2035-07-01<br />total_qty:  222.125<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-08-01<br />total_qty:  541.500<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-09-01<br />total_qty:  421.500<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-10-01<br />total_qty:  489.750<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-11-01<br />total_qty:  480.750<br />fish_name: Wrasse/Labridae n.refert"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Wrasse/Labridae n.refert","legendgroup":"Wrasse/Labridae n.refert","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[0,0,0,0,0,0,0,0,0,0],"x":[23772,23800,23831,23861,23892,23922,23953,23984,24014,24045],"y":[216.25,386,343.5,291,497.125,491.75,616.75,599.625,424,544.625],"text":["month_of_arrival: 2035-02-01<br />total_qty:  216.250<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-03-01<br />total_qty:  386.000<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-04-01<br />total_qty:  343.500<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-05-01<br />total_qty:  291.000<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-06-01<br />total_qty:  497.125<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-07-01<br />total_qty:  491.750<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-08-01<br />total_qty:  616.750<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-09-01<br />total_qty:  599.625<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-10-01<br />total_qty:  424.000<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-11-01<br />total_qty:  544.625<br />fish_name: Wrasse/Labridae n.refert"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Wrasse/Labridae n.refert","legendgroup":"Wrasse/Labridae n.refert","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":55.452054794520549,"r":7.3059360730593621,"b":40.182648401826491,"l":48.949771689497723},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Fish Arrivals by City Over Time","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,0.31583941172982266],"automargin":true,"type":"linear","autorange":false,"range":[23744.490000000002,24072.509999999998],"tickmode":"array","ticktext":["Apr","Jul","Oct"],"tickvals":[23831,23922,24014],"categoryorder":"array","categoryarray":["Apr","Jul","Oct"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-45,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y4","title":"","hoverformat":".2f"},"annotations":[{"text":"Month of Arrival","x":0.5,"y":0,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"top","annotationType":"axis","yshift":-21.917808219178088},{"text":"Total Quantity in Tons","x":0,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xref":"paper","yref":"paper","textangle":-90,"xanchor":"right","yanchor":"center","annotationType":"axis","xshift":-33.607305936073068},{"text":"City of Haacklee","x":0.15791970586491133,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"City of Himark","x":0.5,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"City of Lomark","x":0.84208029413508867,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"City of Paackland","x":0.15791970586491133,"y":0.48515981735159819,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"City of South Paackland","x":0.5,"y":0.48515981735159819,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"}],"yaxis":{"domain":[0.51484018264840181,1],"automargin":true,"type":"linear","autorange":false,"range":[-178.9375,3757.6875],"tickmode":"array","ticktext":["0","1000","2000","3000"],"tickvals":[0,1000,2000,3000],"categoryorder":"array","categoryarray":["0","1000","2000","3000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.31583941172982266,"y0":0.51484018264840181,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.31583941172982266,"y0":0,"y1":23.37899543378996,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.35082725493684397,"x1":0.64917274506315603,"y0":0.51484018264840181,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.35082725493684397,"x1":0.64917274506315603,"y0":0,"y1":23.37899543378996,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.68416058827017723,"x1":1,"y0":0.51484018264840181,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.68416058827017723,"x1":1,"y0":0,"y1":23.37899543378996,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.31583941172982266,"y0":0,"y1":0.48515981735159819},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.31583941172982266,"y0":0,"y1":23.37899543378996,"yanchor":0.48515981735159819,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.35082725493684397,"x1":0.64917274506315603,"y0":0,"y1":0.48515981735159819},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.35082725493684397,"x1":0.64917274506315603,"y0":0,"y1":23.37899543378996,"yanchor":0.48515981735159819,"ysizemode":"pixel"}],"xaxis2":{"type":"linear","autorange":false,"range":[23744.490000000002,24072.509999999998],"tickmode":"array","ticktext":["Apr","Jul","Oct"],"tickvals":[23831,23922,24014],"categoryorder":"array","categoryarray":["Apr","Jul","Oct"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-45,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.35082725493684397,0.64917274506315603],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y5","title":"","hoverformat":".2f"},"yaxis2":{"type":"linear","autorange":false,"range":[-316.10625000000005,6638.2312499999998],"tickmode":"array","ticktext":["0","2000","4000","6000"],"tickvals":[0,1999.9999999999998,4000,6000],"categoryorder":"array","categoryarray":["0","2000","4000","6000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.51484018264840181,1],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x2","title":"","hoverformat":".2f"},"xaxis3":{"type":"linear","autorange":false,"range":[23744.490000000002,24072.509999999998],"tickmode":"array","ticktext":["Apr","Jul","Oct"],"tickvals":[23831,23922,24014],"categoryorder":"array","categoryarray":["Apr","Jul","Oct"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-45,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.68416058827017723,1],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y3","title":"","hoverformat":".2f"},"yaxis3":{"type":"linear","autorange":false,"range":[-343.18125000000003,7195.8062499999996],"tickmode":"array","ticktext":["0","2000","4000","6000"],"tickvals":[0,2000,3999.9999999999995,6000],"categoryorder":"array","categoryarray":["0","2000","4000","6000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.51484018264840181,1],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x3","title":"","hoverformat":".2f"},"yaxis4":{"type":"linear","autorange":false,"range":[-454.72500000000002,9549.2250000000004],"tickmode":"array","ticktext":["0","2500","5000","7500"],"tickvals":[0,2500,5000,7500],"categoryorder":"array","categoryarray":["0","2500","5000","7500"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.48515981735159819],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis5":{"type":"linear","autorange":false,"range":[-296.47500000000002,6225.9750000000004],"tickmode":"array","ticktext":["0","2000","4000","6000"],"tickvals":[0,2000,4000.0000000000005,6000],"categoryorder":"array","categoryarray":["0","2000","4000","6000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.48515981735159819],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x2","title":"","hoverformat":".2f"},"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"fish_name","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative","hoverlabel":{"bgcolor":"white"},"hoverinfo":"text","tooltip":["month_of_arrival","qty_tons","fish_name"]},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"29647320ad":{"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"29647320ad","visdat":{"29647320ad":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="logic-for-inferring-mapping-between-cargo-and-vessel" class="level2">
<h2 class="anchored" data-anchor-id="logic-for-inferring-mapping-between-cargo-and-vessel"><strong>1.6</strong> Logic for inferring mapping between cargo and vessel</h2>
<p>This code is designed to match fish cargo transactions with vessel activities using harbor reports and transponder pings. It aims to identify potential vessels involved in direct deliveries or transshipment activities for specific fish cargoes. The goal is to provide a comprehensive mapping of cargoes to vessels, especially focusing on cases with multiple possible matches.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#matching based on harbor report and transponder ping</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>matching_cargo_to_vessel_harbor <span class="ot">&lt;-</span> transactions_cargo <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(harbor_report_df, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"city_of_arrival"</span> <span class="ot">=</span> <span class="st">"city"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(date_of_arrival <span class="sc">==</span> date <span class="sc">|</span> date_of_arrival <span class="sc">-</span> <span class="fu">days</span>(<span class="dv">1</span>) <span class="sc">==</span> date) <span class="sc">%&gt;%</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date_of_arrival, date,cargo_id,fish_in_cargo,city_of_arrival,vessel_id,vessel_company,vessel_type,qty_tons)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>matching_cargo_to_vessel_transponder <span class="ot">&lt;-</span> transactions_cargo <span class="sc">%&gt;%</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(transponder_ping_city_df, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"city_of_arrival"</span> <span class="ot">=</span> <span class="st">"location"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(date_of_arrival <span class="sc">==</span> ping_date <span class="sc">|</span> date_of_arrival <span class="sc">-</span> <span class="fu">days</span>(<span class="dv">1</span>) <span class="sc">==</span> ping_date) <span class="sc">%&gt;%</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date_of_arrival, ping_date,city_of_arrival,cargo_id,fish_in_cargo,vessel_id,vessel_name,vessel_company,vessel_type,total_dwell_time,qty_tons)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>combined_matches <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  matching_cargo_to_vessel_harbor <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">source =</span> <span class="st">"Harbor"</span>),</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  matching_cargo_to_vessel_transponder <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">source =</span> <span class="st">"Transponder"</span>)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cargo_id,vessel_id,source) <span class="sc">%&gt;%</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()  <span class="sc">%&gt;%</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter to prioritize harbor data</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(<span class="cf">if</span>(<span class="fu">any</span>(source <span class="sc">==</span> <span class="st">"Harbor"</span>)) source <span class="sc">==</span> <span class="st">"Harbor"</span> <span class="cf">else</span> source <span class="sc">==</span><span class="st">"Transponder"</span>)<span class="sc">%&gt;%</span>  <span class="fu">rename</span>(</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_matched_in_harbor_report =</span> date,</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_matched_in_transponder_ping =</span> ping_date</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>daily_vessel_locations_list <span class="ot">&lt;-</span> transponder_ping_day_sum_df <span class="sc">%&gt;%</span></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ping_date, vessel_id, vessel_company) <span class="sc">%&gt;%</span></span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ping_locations =</span> <span class="fu">list</span>(<span class="fu">unique</span>(location)), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to find potential transshipment vessels for a single transaction</span></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>find_potential_vessels_single <span class="ot">&lt;-</span> <span class="cf">function</span>(date_of_arrival, cargo_id, city_of_arrival, fish_in_cargo) {</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>  date_to <span class="ot">&lt;-</span> date_of_arrival</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>  date_from <span class="ot">&lt;-</span> date_to <span class="sc">-</span> <span class="dv">5</span></span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>  target_location <span class="ot">&lt;-</span> city_of_arrival</span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the fishing locations for the fish in the cargo</span></span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>  fish_locations <span class="ot">&lt;-</span> final_fish_locations_df <span class="sc">%&gt;%</span></span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(fish_species_present <span class="sc">==</span> fish_in_cargo) <span class="sc">%&gt;%</span></span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(fishing_locations) <span class="sc">%&gt;%</span></span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>()</span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Direct delivery check</span></span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>  direct_vessels <span class="ot">&lt;-</span> daily_vessel_locations_list <span class="sc">%&gt;%</span></span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(ping_date <span class="sc">&gt;=</span> date_from <span class="sc">&amp;</span> ping_date <span class="sc">&lt;=</span> date_to) <span class="sc">%&gt;%</span></span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">map_lgl</span>(ping_locations, <span class="sc">~</span> <span class="fu">any</span>(.x <span class="sc">%in%</span> fish_locations))) <span class="sc">%&gt;%</span></span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">map_lgl</span>(ping_locations, <span class="sc">~</span> <span class="fu">any</span>(.x <span class="sc">==</span> target_location))) <span class="sc">%&gt;%</span></span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a>   <span class="co"># filter(vessel_company == cargo_company) %&gt;%</span></span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>(vessel_id) <span class="sc">%&gt;%</span></span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(vessel_id)</span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-54"><a href="#cb42-54" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(direct_vessels) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb42-55"><a href="#cb42-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">data.frame</span>(</span>
<span id="cb42-56"><a href="#cb42-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">cargo_id =</span> cargo_id,</span>
<span id="cb42-57"><a href="#cb42-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">vessel_id =</span> direct_vessels</span>
<span id="cb42-58"><a href="#cb42-58" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb42-59"><a href="#cb42-59" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-60"><a href="#cb42-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-61"><a href="#cb42-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Transshipment check</span></span>
<span id="cb42-62"><a href="#cb42-62" aria-hidden="true" tabindex="-1"></a>  vessels_visiting_fish_location <span class="ot">&lt;-</span> daily_vessel_locations_list <span class="sc">%&gt;%</span></span>
<span id="cb42-63"><a href="#cb42-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(ping_date <span class="sc">&gt;=</span> date_from <span class="sc">&amp;</span> ping_date <span class="sc">&lt;=</span> date_to) <span class="sc">%&gt;%</span></span>
<span id="cb42-64"><a href="#cb42-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">map_lgl</span>(ping_locations, <span class="sc">~</span> <span class="fu">any</span>(.x <span class="sc">%in%</span> fish_locations))) <span class="sc">%&gt;%</span></span>
<span id="cb42-65"><a href="#cb42-65" aria-hidden="true" tabindex="-1"></a>   <span class="co"># filter(vessel_company == cargo_company) %&gt;%</span></span>
<span id="cb42-66"><a href="#cb42-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>(vessel_id) <span class="sc">%&gt;%</span></span>
<span id="cb42-67"><a href="#cb42-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(vessel_id)</span>
<span id="cb42-68"><a href="#cb42-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-69"><a href="#cb42-69" aria-hidden="true" tabindex="-1"></a>  vessels_visiting_target_location <span class="ot">&lt;-</span> daily_vessel_locations_list <span class="sc">%&gt;%</span></span>
<span id="cb42-70"><a href="#cb42-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(ping_date <span class="sc">&gt;=</span> date_from <span class="sc">&amp;</span> ping_date <span class="sc">&lt;=</span> date_to) <span class="sc">%&gt;%</span></span>
<span id="cb42-71"><a href="#cb42-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">map_lgl</span>(ping_locations, <span class="sc">~</span> <span class="fu">any</span>(.x <span class="sc">==</span> target_location))) <span class="sc">%&gt;%</span></span>
<span id="cb42-72"><a href="#cb42-72" aria-hidden="true" tabindex="-1"></a>   <span class="co"># filter(vessel_company == cargo_company) %&gt;%</span></span>
<span id="cb42-73"><a href="#cb42-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>(vessel_id) <span class="sc">%&gt;%</span></span>
<span id="cb42-74"><a href="#cb42-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(vessel_id)</span>
<span id="cb42-75"><a href="#cb42-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-76"><a href="#cb42-76" aria-hidden="true" tabindex="-1"></a>  combined_vessels <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(vessels_visiting_fish_location, vessels_visiting_target_location))</span>
<span id="cb42-77"><a href="#cb42-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-78"><a href="#cb42-78" aria-hidden="true" tabindex="-1"></a>  confirmed_vessels_on_date <span class="ot">&lt;-</span> harbor_report_df <span class="sc">%&gt;%</span></span>
<span id="cb42-79"><a href="#cb42-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(date <span class="sc">==</span> date_to <span class="sc">&amp;</span> city <span class="sc">==</span> target_location <span class="sc">&amp;</span> vessel_id <span class="sc">%in%</span> combined_vessels) <span class="sc">%&gt;%</span></span>
<span id="cb42-80"><a href="#cb42-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>(vessel_id) <span class="sc">%&gt;%</span></span>
<span id="cb42-81"><a href="#cb42-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(vessel_id)</span>
<span id="cb42-82"><a href="#cb42-82" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-83"><a href="#cb42-83" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(confirmed_vessels_on_date) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb42-84"><a href="#cb42-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">data.frame</span>(</span>
<span id="cb42-85"><a href="#cb42-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">cargo_id =</span> cargo_id,</span>
<span id="cb42-86"><a href="#cb42-86" aria-hidden="true" tabindex="-1"></a>      <span class="at">vessel_id =</span> <span class="cn">NA</span></span>
<span id="cb42-87"><a href="#cb42-87" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb42-88"><a href="#cb42-88" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb42-89"><a href="#cb42-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">data.frame</span>(</span>
<span id="cb42-90"><a href="#cb42-90" aria-hidden="true" tabindex="-1"></a>      <span class="at">cargo_id =</span> cargo_id,</span>
<span id="cb42-91"><a href="#cb42-91" aria-hidden="true" tabindex="-1"></a>      <span class="at">vessel_id =</span> confirmed_vessels_on_date</span>
<span id="cb42-92"><a href="#cb42-92" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb42-93"><a href="#cb42-93" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-94"><a href="#cb42-94" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-95"><a href="#cb42-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-96"><a href="#cb42-96" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify cargos with more than 3 mapping in combined_matches</span></span>
<span id="cb42-97"><a href="#cb42-97" aria-hidden="true" tabindex="-1"></a>cargos_with_multiple_mappings <span class="ot">&lt;-</span> combined_matches <span class="sc">%&gt;%</span></span>
<span id="cb42-98"><a href="#cb42-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cargo_id) <span class="sc">%&gt;%</span></span>
<span id="cb42-99"><a href="#cb42-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb42-100"><a href="#cb42-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(count <span class="sc">&gt;</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-101"><a href="#cb42-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(cargo_id)</span>
<span id="cb42-102"><a href="#cb42-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-103"><a href="#cb42-103" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter transactions_cargo to include only those cargos</span></span>
<span id="cb42-104"><a href="#cb42-104" aria-hidden="true" tabindex="-1"></a>required_columns <span class="ot">&lt;-</span> transactions_cargo <span class="sc">%&gt;%</span></span>
<span id="cb42-105"><a href="#cb42-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cargo_id <span class="sc">%in%</span> cargos_with_multiple_mappings) <span class="sc">%&gt;%</span></span>
<span id="cb42-106"><a href="#cb42-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date_of_arrival, cargo_id, city_of_arrival, fish_in_cargo)</span>
<span id="cb42-107"><a href="#cb42-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-108"><a href="#cb42-108" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb42-109"><a href="#cb42-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-110"><a href="#cb42-110" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the function to all transactions using pmap_dfr</span></span>
<span id="cb42-111"><a href="#cb42-111" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">pmap_dfr</span>(required_columns, <span class="cf">function</span>(...) {</span>
<span id="cb42-112"><a href="#cb42-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">find_potential_vessels_single</span>(...)</span>
<span id="cb42-113"><a href="#cb42-113" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb42-114"><a href="#cb42-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-115"><a href="#cb42-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-116"><a href="#cb42-116" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify cargos with &lt;=3 mapping in combined_matches</span></span>
<span id="cb42-117"><a href="#cb42-117" aria-hidden="true" tabindex="-1"></a>cargos_with_less_than_3_mapping <span class="ot">&lt;-</span> combined_matches <span class="sc">%&gt;%</span></span>
<span id="cb42-118"><a href="#cb42-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cargo_id) <span class="sc">%&gt;%</span></span>
<span id="cb42-119"><a href="#cb42-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb42-120"><a href="#cb42-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(count <span class="sc">&lt;=</span><span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-121"><a href="#cb42-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(cargo_id)</span>
<span id="cb42-122"><a href="#cb42-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-123"><a href="#cb42-123" aria-hidden="true" tabindex="-1"></a><span class="co"># Select from combined_matches for cargos with &lt;=3 mapping mapping</span></span>
<span id="cb42-124"><a href="#cb42-124" aria-hidden="true" tabindex="-1"></a>combined_matches_3 <span class="ot">&lt;-</span> combined_matches <span class="sc">%&gt;%</span></span>
<span id="cb42-125"><a href="#cb42-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cargo_id <span class="sc">%in%</span> cargos_with_less_than_3_mapping)</span>
<span id="cb42-126"><a href="#cb42-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-127"><a href="#cb42-127" aria-hidden="true" tabindex="-1"></a><span class="co"># Select from results where vessel_id is not NA</span></span>
<span id="cb42-128"><a href="#cb42-128" aria-hidden="true" tabindex="-1"></a>results_valid <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span></span>
<span id="cb42-129"><a href="#cb42-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(vessel_id))</span>
<span id="cb42-130"><a href="#cb42-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-131"><a href="#cb42-131" aria-hidden="true" tabindex="-1"></a><span class="co"># Fallback to combined_matches for cargos not matched in results</span></span>
<span id="cb42-132"><a href="#cb42-132" aria-hidden="true" tabindex="-1"></a>fallback_cargos <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span></span>
<span id="cb42-133"><a href="#cb42-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(vessel_id)) <span class="sc">%&gt;%</span></span>
<span id="cb42-134"><a href="#cb42-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(cargo_id)</span>
<span id="cb42-135"><a href="#cb42-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-136"><a href="#cb42-136" aria-hidden="true" tabindex="-1"></a>combined_matches_fallback <span class="ot">&lt;-</span> combined_matches <span class="sc">%&gt;%</span></span>
<span id="cb42-137"><a href="#cb42-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cargo_id <span class="sc">%in%</span> fallback_cargos)</span>
<span id="cb42-138"><a href="#cb42-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-139"><a href="#cb42-139" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the selected and fallback results</span></span>
<span id="cb42-140"><a href="#cb42-140" aria-hidden="true" tabindex="-1"></a>combined_results_final <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(combined_matches_3, results_valid, combined_matches_fallback)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="sankey-diagram-for-showing-the-flow-of-fish-through-the-port-cities" class="level2">
<h2 class="anchored" data-anchor-id="sankey-diagram-for-showing-the-flow-of-fish-through-the-port-cities"><strong>1.7</strong> Sankey diagram for showing the flow of fish through the port cities</h2>
<p>This code aims to create a Sankey diagram that visualizes the flow of fish quantities from vessel companies to their respective cities of arrival and the types of fish in their cargo. The goal is to illustrate the distribution and connections between these entities, focusing on the top 10 vessel companies by quantity.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate data for Sankey diagram</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>sankey_data <span class="ot">&lt;-</span> combined_results_final <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(vessel_company, city_of_arrival, fish_in_cargo) <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_qty_tons =</span> <span class="fu">sum</span>(qty_tons), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to top 10 vessel companies by quantity</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>top_companies <span class="ot">&lt;-</span> sankey_data <span class="sc">%&gt;%</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(vessel_company) <span class="sc">%&gt;%</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_qty_tons =</span> <span class="fu">sum</span>(total_qty_tons), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>, total_qty_tons) <span class="sc">%&gt;%</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(vessel_company)</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>sankey_data <span class="ot">&lt;-</span> sankey_data <span class="sc">%&gt;%</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(vessel_company <span class="sc">%in%</span> top_companies)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create node labels</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(sankey_data<span class="sc">$</span>vessel_company, sankey_data<span class="sc">$</span>city_of_arrival, sankey_data<span class="sc">$</span>fish_in_cargo))</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>node_indices <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">seq_along</span>(nodes) <span class="sc">-</span> <span class="dv">1</span>, nodes)</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Create source and target indices</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>sankey_data <span class="ot">&lt;-</span> sankey_data <span class="sc">%&gt;%</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> node_indices[vessel_company],</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">target_city =</span> node_indices[city_of_arrival],</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">target_fish =</span> node_indices[fish_in_cargo])</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Sankey diagram</span></span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"sankey"</span>,</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">orientation =</span> <span class="st">"h"</span>,</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">node =</span> <span class="fu">list</span>(</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> nodes,</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">pad =</span> <span class="dv">15</span>,</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">thickness =</span> <span class="dv">20</span>,</span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.5</span>)</span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">link =</span> <span class="fu">list</span>(</span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">source =</span> <span class="fu">c</span>(sankey_data<span class="sc">$</span>source, sankey_data<span class="sc">$</span>target_city),</span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">target =</span> <span class="fu">c</span>(sankey_data<span class="sc">$</span>target_city, sankey_data<span class="sc">$</span>target_fish),</span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">c</span>(sankey_data<span class="sc">$</span>total_qty_tons, sankey_data<span class="sc">$</span>total_qty_tons)</span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>fig <span class="sc">%&gt;%</span></span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Sankey Diagram of Top 10 Vessel Companies by Fish Quantity"</span>,</span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">font =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-2b5be540c1d2a00ad758" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-2b5be540c1d2a00ad758">{"x":{"visdat":{"29645656175":["function () ","plotlyVisDat"]},"cur_data":"29645656175","attrs":{"29645656175":{"orientation":"h","node":{"label":["Costa de Oro Enterprises","Garcia-Wallace","Jacobson Inc","Mccormick Group","Ritter Ltd","Saltwater Sisters Company Marine","Smith, Davis and Acosta","Solis-Lopez","Tainamarine Fishing Co","Thompson-Padilla","City of Lomark","City of Paackland","City of South Paackland","City of Haacklee","City of Himark","gadusnspecificatae4ba","habeaspisces4eb","labridaenrefert9be","piscesfrigus900","piscesfoetidaae7","piscessatisb87","piscisosseusb6d","piscissapidum9b7","oncorhynchusrosea790"],"pad":15,"thickness":20,"line":{"color":"black","width":0.5}},"link":{"source":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,10,10,10,10,11,11,11,11,11,11,11,11,12,12,12,12,13,13,13,13,13,13,13,14,14,14,10,10,10,10,11,11,11,11,11,13,13,13,13,13,14,14,14,14,14,11,11,11,11,11,11,11,12,12,12,13,13,13,13,10,10,10,10,10,10,11,11,11,11,11,11,11,12,12,14,14,14,14,14,10,10,10,10,10,10,11,11,11,11,11,11,11,11,12,12,13,13,13,13,13,14,14,14,14,14,10,10,10,11,11,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,13,13,13,14,14,14,14,14,10,10,10,10,11,11,11,11,11,11,11,12,12,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,14,14,14,14,14,10,10,10,10,11,11,11,11,11,11,11,11,12,12,12,13,11,11,11,11,11,11,11],"target":[10,10,10,10,11,11,11,11,11,11,11,11,12,12,12,12,13,13,13,13,13,13,13,14,14,14,10,10,10,10,11,11,11,11,11,13,13,13,13,13,14,14,14,14,14,11,11,11,11,11,11,11,12,12,12,13,13,13,13,10,10,10,10,10,10,11,11,11,11,11,11,11,12,12,14,14,14,14,14,10,10,10,10,10,10,11,11,11,11,11,11,11,11,12,12,13,13,13,13,13,14,14,14,14,14,10,10,10,11,11,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,13,13,13,14,14,14,14,14,10,10,10,10,11,11,11,11,11,11,11,12,12,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,14,14,14,14,14,10,10,10,10,11,11,11,11,11,11,11,11,12,12,12,13,11,11,11,11,11,11,11,15,16,17,18,15,16,17,19,18,20,21,22,15,16,19,18,15,16,17,23,19,18,22,17,19,22,15,16,17,18,15,16,17,23,19,16,23,19,18,22,16,17,23,19,22,15,16,17,23,19,18,21,15,16,23,15,16,17,23,15,16,17,18,21,22,15,17,23,19,18,21,22,16,18,15,16,17,19,22,15,16,17,18,21,22,15,16,17,19,18,20,21,22,16,18,15,16,23,19,22,16,17,23,19,22,15,16,17,15,16,17,23,19,18,20,21,22,15,16,19,18,21,15,16,17,23,19,18,16,17,19,18,22,15,16,17,22,15,16,17,23,19,18,21,15,18,15,16,17,23,19,18,20,21,22,15,16,23,19,18,21,22,15,17,23,19,22,15,16,17,18,15,16,17,23,19,18,21,22,15,16,18,17,15,16,17,19,18,21,22],"value":[78.625,4.125,18.75,8,686.125,78.5,153.875,235.25,27.500000000000004,29.750000000000004,52.375,79.5,7.0000000000000009,145.875,26.875,2.5,69,34.375,63.875,76.625,98.25,54,156.875,294,61,32.625,72.375,4.125,18.75,8,425.125,188.375,140.125,138.25,20.625,106.75,118.125,60.25,26,67.5,41.625,207.5,46.875,141.75,90.625,402.75,64,33.25,31,17.375,22.25,23.625,55.125,132.25,18,82.25,1.375,22,36.75,437.75,101.75,32.75,58.375,34.875,36.25,356.25,80.75,20,100,51.25,31.5,110.75,110.75,13.25,-0.625,41.625,118.25,103,22.75,394.125,105.625,105.75,104.625,-0.625,30.75,372.625,70.25,151.875,161.125,195.125,54.25,142.625,156.875,34.375,26.25,75,0,31.5,38.5,89.875,40.625,383.25,44,50.375,93.75,106.875,73.125,27,330.125,61,146,16,189.25,6.5,24.5,20.125,69,110.625,71.25,55.250000000000007,31.5,23.625,5.875,88,12.75,136.125,35.25,11.5,10.125,257.5,16.875,25,60.75,42.000000000000007,24.875000000000004,30.749999999999996,31.25,293.5,39.25,64,21.125,14.125,19.5,21,351.375,261.375,1678.375,437,329.5,174.25,393.5,402.75,45.5,241.125,186.375,141,243.25,43.75,26.875,111.375,11.5,34,15,336.875,38.625,61,64.125,396.875,4.125,43.5,26.25,528.625,72.25,123.125,131,92.875,21.875,17.5,35,11.5,70.5,46.25,0.25,958.875,116.5,167.125,232.875,205.625,201.625,115.5,78.625,4.125,18.75,8,686.125,78.5,153.875,235.25,27.500000000000004,29.750000000000004,52.375,79.5,7.0000000000000009,145.875,26.875,2.5,69,34.375,63.875,76.625,98.25,54,156.875,294,61,32.625,72.375,4.125,18.75,8,425.125,188.375,140.125,138.25,20.625,106.75,118.125,60.25,26,67.5,41.625,207.5,46.875,141.75,90.625,402.75,64,33.25,31,17.375,22.25,23.625,55.125,132.25,18,82.25,1.375,22,36.75,437.75,101.75,32.75,58.375,34.875,36.25,356.25,80.75,20,100,51.25,31.5,110.75,110.75,13.25,-0.625,41.625,118.25,103,22.75,394.125,105.625,105.75,104.625,-0.625,30.75,372.625,70.25,151.875,161.125,195.125,54.25,142.625,156.875,34.375,26.25,75,0,31.5,38.5,89.875,40.625,383.25,44,50.375,93.75,106.875,73.125,27,330.125,61,146,16,189.25,6.5,24.5,20.125,69,110.625,71.25,55.250000000000007,31.5,23.625,5.875,88,12.75,136.125,35.25,11.5,10.125,257.5,16.875,25,60.75,42.000000000000007,24.875000000000004,30.749999999999996,31.25,293.5,39.25,64,21.125,14.125,19.5,21,351.375,261.375,1678.375,437,329.5,174.25,393.5,402.75,45.5,241.125,186.375,141,243.25,43.75,26.875,111.375,11.5,34,15,336.875,38.625,61,64.125,396.875,4.125,43.5,26.25,528.625,72.25,123.125,131,92.875,21.875,17.5,35,11.5,70.5,46.25,0.25,958.875,116.5,167.125,232.875,205.625,201.625,115.5]},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"sankey"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Sankey Diagram of Top 10 Vessel Companies by Fish Quantity","font":{"size":10},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"orientation":"h","node":{"label":["Costa de Oro Enterprises","Garcia-Wallace","Jacobson Inc","Mccormick Group","Ritter Ltd","Saltwater Sisters Company Marine","Smith, Davis and Acosta","Solis-Lopez","Tainamarine Fishing Co","Thompson-Padilla","City of Lomark","City of Paackland","City of South Paackland","City of Haacklee","City of Himark","gadusnspecificatae4ba","habeaspisces4eb","labridaenrefert9be","piscesfrigus900","piscesfoetidaae7","piscessatisb87","piscisosseusb6d","piscissapidum9b7","oncorhynchusrosea790"],"pad":15,"thickness":20,"line":{"color":"black","width":0.5}},"link":{"source":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,10,10,10,10,11,11,11,11,11,11,11,11,12,12,12,12,13,13,13,13,13,13,13,14,14,14,10,10,10,10,11,11,11,11,11,13,13,13,13,13,14,14,14,14,14,11,11,11,11,11,11,11,12,12,12,13,13,13,13,10,10,10,10,10,10,11,11,11,11,11,11,11,12,12,14,14,14,14,14,10,10,10,10,10,10,11,11,11,11,11,11,11,11,12,12,13,13,13,13,13,14,14,14,14,14,10,10,10,11,11,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,13,13,13,14,14,14,14,14,10,10,10,10,11,11,11,11,11,11,11,12,12,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,14,14,14,14,14,10,10,10,10,11,11,11,11,11,11,11,11,12,12,12,13,11,11,11,11,11,11,11],"target":[10,10,10,10,11,11,11,11,11,11,11,11,12,12,12,12,13,13,13,13,13,13,13,14,14,14,10,10,10,10,11,11,11,11,11,13,13,13,13,13,14,14,14,14,14,11,11,11,11,11,11,11,12,12,12,13,13,13,13,10,10,10,10,10,10,11,11,11,11,11,11,11,12,12,14,14,14,14,14,10,10,10,10,10,10,11,11,11,11,11,11,11,11,12,12,13,13,13,13,13,14,14,14,14,14,10,10,10,11,11,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,13,13,13,14,14,14,14,14,10,10,10,10,11,11,11,11,11,11,11,12,12,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,14,14,14,14,14,10,10,10,10,11,11,11,11,11,11,11,11,12,12,12,13,11,11,11,11,11,11,11,15,16,17,18,15,16,17,19,18,20,21,22,15,16,19,18,15,16,17,23,19,18,22,17,19,22,15,16,17,18,15,16,17,23,19,16,23,19,18,22,16,17,23,19,22,15,16,17,23,19,18,21,15,16,23,15,16,17,23,15,16,17,18,21,22,15,17,23,19,18,21,22,16,18,15,16,17,19,22,15,16,17,18,21,22,15,16,17,19,18,20,21,22,16,18,15,16,23,19,22,16,17,23,19,22,15,16,17,15,16,17,23,19,18,20,21,22,15,16,19,18,21,15,16,17,23,19,18,16,17,19,18,22,15,16,17,22,15,16,17,23,19,18,21,15,18,15,16,17,23,19,18,20,21,22,15,16,23,19,18,21,22,15,17,23,19,22,15,16,17,18,15,16,17,23,19,18,21,22,15,16,18,17,15,16,17,19,18,21,22],"value":[78.625,4.125,18.75,8,686.125,78.5,153.875,235.25,27.500000000000004,29.750000000000004,52.375,79.5,7.0000000000000009,145.875,26.875,2.5,69,34.375,63.875,76.625,98.25,54,156.875,294,61,32.625,72.375,4.125,18.75,8,425.125,188.375,140.125,138.25,20.625,106.75,118.125,60.25,26,67.5,41.625,207.5,46.875,141.75,90.625,402.75,64,33.25,31,17.375,22.25,23.625,55.125,132.25,18,82.25,1.375,22,36.75,437.75,101.75,32.75,58.375,34.875,36.25,356.25,80.75,20,100,51.25,31.5,110.75,110.75,13.25,-0.625,41.625,118.25,103,22.75,394.125,105.625,105.75,104.625,-0.625,30.75,372.625,70.25,151.875,161.125,195.125,54.25,142.625,156.875,34.375,26.25,75,0,31.5,38.5,89.875,40.625,383.25,44,50.375,93.75,106.875,73.125,27,330.125,61,146,16,189.25,6.5,24.5,20.125,69,110.625,71.25,55.250000000000007,31.5,23.625,5.875,88,12.75,136.125,35.25,11.5,10.125,257.5,16.875,25,60.75,42.000000000000007,24.875000000000004,30.749999999999996,31.25,293.5,39.25,64,21.125,14.125,19.5,21,351.375,261.375,1678.375,437,329.5,174.25,393.5,402.75,45.5,241.125,186.375,141,243.25,43.75,26.875,111.375,11.5,34,15,336.875,38.625,61,64.125,396.875,4.125,43.5,26.25,528.625,72.25,123.125,131,92.875,21.875,17.5,35,11.5,70.5,46.25,0.25,958.875,116.5,167.125,232.875,205.625,201.625,115.5,78.625,4.125,18.75,8,686.125,78.5,153.875,235.25,27.500000000000004,29.750000000000004,52.375,79.5,7.0000000000000009,145.875,26.875,2.5,69,34.375,63.875,76.625,98.25,54,156.875,294,61,32.625,72.375,4.125,18.75,8,425.125,188.375,140.125,138.25,20.625,106.75,118.125,60.25,26,67.5,41.625,207.5,46.875,141.75,90.625,402.75,64,33.25,31,17.375,22.25,23.625,55.125,132.25,18,82.25,1.375,22,36.75,437.75,101.75,32.75,58.375,34.875,36.25,356.25,80.75,20,100,51.25,31.5,110.75,110.75,13.25,-0.625,41.625,118.25,103,22.75,394.125,105.625,105.75,104.625,-0.625,30.75,372.625,70.25,151.875,161.125,195.125,54.25,142.625,156.875,34.375,26.25,75,0,31.5,38.5,89.875,40.625,383.25,44,50.375,93.75,106.875,73.125,27,330.125,61,146,16,189.25,6.5,24.5,20.125,69,110.625,71.25,55.250000000000007,31.5,23.625,5.875,88,12.75,136.125,35.25,11.5,10.125,257.5,16.875,25,60.75,42.000000000000007,24.875000000000004,30.749999999999996,31.25,293.5,39.25,64,21.125,14.125,19.5,21,351.375,261.375,1678.375,437,329.5,174.25,393.5,402.75,45.5,241.125,186.375,141,243.25,43.75,26.875,111.375,11.5,34,15,336.875,38.625,61,64.125,396.875,4.125,43.5,26.25,528.625,72.25,123.125,131,92.875,21.875,17.5,35,11.5,70.5,46.25,0.25,958.875,116.5,167.125,232.875,205.625,201.625,115.5]},"type":"sankey","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="treemap" class="level2">
<h2 class="anchored" data-anchor-id="treemap"><strong>1.8</strong> Treemap</h2>
<p>This code aims to create a treemap visualization that displays the quantity of fish transported by different vessel companies to various cities, based on the mapping we created earlier in <strong>1.6</strong>. The goal is to provide a clear and intuitive representation of the distribution and magnitude of fish quantities across multiple dimensions (cities and companies).</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(treemap)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>all_cities <span class="ot">&lt;-</span> <span class="fu">unique</span>(combined_results_final<span class="sc">$</span>city_of_arrival)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>all_vessel_companies <span class="ot">&lt;-</span> <span class="fu">unique</span>(combined_results_final<span class="sc">$</span>vessel_company)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with all combinations of cities and vessel companies</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>complete_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">city_of_arrival =</span> all_cities,</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">vessel_company =</span> all_vessel_companies,</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the complete_data with combined_matches to ensure all cities and vessel companies are included</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(complete_data, combined_results_final, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"city_of_arrival"</span>, <span class="st">"vessel_company"</span>), <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace NA values with 0 for qty_tons</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>merged_data<span class="sc">$</span>qty_tons[<span class="fu">is.na</span>(merged_data<span class="sc">$</span>qty_tons)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate data for treemap</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>treemap_data <span class="ot">&lt;-</span> merged_data <span class="sc">%&gt;%</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(city_of_arrival, vessel_company) <span class="sc">%&gt;%</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_qty_tons =</span> <span class="fu">sum</span>(qty_tons), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize the values for better visualization</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>treemap_data<span class="sc">$</span>total_qty_tons <span class="ot">&lt;-</span> <span class="fu">log1p</span>(treemap_data<span class="sc">$</span>total_qty_tons)</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the treemap</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a><span class="fu">treemap</span>(treemap_data,</span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"city_of_arrival"</span>, <span class="st">"vessel_company"</span>),</span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>              <span class="at">vSize =</span> <span class="st">"total_qty_tons"</span>,</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>              <span class="at">vColor =</span> <span class="st">"total_qty_tons"</span>,</span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">"value"</span>,</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>              <span class="at">fontsize.labels =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">12</span>), <span class="co"># Larger font size for inner labels</span></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>              <span class="at">align.labels =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"center"</span>), <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"center"</span>)), <span class="co"># Center align labels</span></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>              <span class="co">#inflate.labels = TRUE, # Inflate labels to fit the tiles</span></span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>              <span class="at">title =</span> <span class="st">"Treemap of Fish Quantity by Vessel Company for Each City"</span>,</span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>              <span class="at">title.legend =</span> <span class="st">"Total Quantity (Log Scale)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Investigations_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="plotting-fish-quantities-arriving-at-each-city-over-time" class="level2">
<h2 class="anchored" data-anchor-id="plotting-fish-quantities-arriving-at-each-city-over-time"><strong>1.9 Plotting fish quantities arriving at each city over time</strong></h2>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate quantity by city, fish type, and month of arrival (assuming you have a date_of_arrival column)</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>city_time_analysis <span class="ot">&lt;-</span> transactions_cargo <span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month_of_arrival =</span> lubridate<span class="sc">::</span><span class="fu">floor_date</span>(date_of_arrival, <span class="st">"month"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(city_of_arrival, fish_name, month_of_arrival) <span class="sc">%&gt;%</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">qty_tons =</span> <span class="fu">sum</span>(qty_tons), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with ggplot2</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(city_time_analysis, <span class="fu">aes</span>(<span class="at">x =</span> month_of_arrival, <span class="at">y =</span> qty_tons, <span class="at">fill =</span> fish_name)) <span class="sc">+</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> city_of_arrival, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Fish Arrivals by City Over Time"</span>, <span class="at">x =</span> <span class="st">"Month of Arrival"</span>, <span class="at">y =</span> <span class="st">"Total Quantity in Tons"</span>) <span class="sc">+</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to an interactive plotly plot</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-cb82bb8e2a21e3b5f5e2" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-cb82bb8e2a21e3b5f5e2">{"x":{"data":[{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[1029.125,1577.75,2870.5,3280.875,2609],"x":[23922,23953,23984,24014,24045],"y":[42.625,472.5,22.5,297.875,734.5],"text":["month_of_arrival: 2035-07-01<br />qty_tons:   42.625<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-08-01<br />qty_tons:  472.500<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-09-01<br />qty_tons:   22.500<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-10-01<br />qty_tons:  297.875<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-11-01<br />qty_tons:  734.500<br />fish_name: Beauvoir/Habeas pisces"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Beauvoir/Habeas pisces","legendgroup":"Beauvoir/Habeas pisces","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[1074.625,1575.75,2273.625,2855.125,2962.875,4135.375,4415.125,5660.5],"x":[23800,23831,23861,23892,23922,23953,24014,24045],"y":[121.5,518.125,254.125,189,321.75,38.25,748.5,661.625],"text":["month_of_arrival: 2035-03-01<br />qty_tons:  121.500<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-04-01<br />qty_tons:  518.125<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-05-01<br />qty_tons:  254.125<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-06-01<br />qty_tons:  189.000<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-07-01<br />qty_tons:  321.750<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-08-01<br />qty_tons:   38.250<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-10-01<br />qty_tons:  748.500<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-11-01<br />qty_tons:  661.625<br />fish_name: Beauvoir/Habeas pisces"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Beauvoir/Habeas pisces","legendgroup":"Beauvoir/Habeas pisces","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[3390.25,5329,6446.625,4213.75],"x":[23953,23984,24014,24045],"y":[453.625,41.125,406.5,1042.5],"text":["month_of_arrival: 2035-08-01<br />qty_tons:  453.625<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-09-01<br />qty_tons:   41.125<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-10-01<br />qty_tons:  406.500<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-11-01<br />qty_tons: 1042.500<br />fish_name: Beauvoir/Habeas pisces"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Beauvoir/Habeas pisces","legendgroup":"Beauvoir/Habeas pisces","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[1393.25,4377.25,5962.75,7811.875,8114.875],"x":[23922,23953,23984,24014,24045],"y":[17.5,1232,527.5,428.375,979.625],"text":["month_of_arrival: 2035-07-01<br />qty_tons:   17.500<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-08-01<br />qty_tons: 1232.000<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-09-01<br />qty_tons:  527.500<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-10-01<br />qty_tons:  428.375<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-11-01<br />qty_tons:  979.625<br />fish_name: Beauvoir/Habeas pisces"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Beauvoir/Habeas pisces","legendgroup":"Beauvoir/Habeas pisces","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[318.375,283.875,696,1269.75,4179,5263.25,2914.25],"x":[23861,23892,23922,23953,23984,24014,24045],"y":[208.125,113.75,598.75,1751.375,254.25,666.25,2085.875],"text":["month_of_arrival: 2035-05-01<br />qty_tons:  208.125<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-06-01<br />qty_tons:  113.750<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-07-01<br />qty_tons:  598.750<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-08-01<br />qty_tons: 1751.375<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-09-01<br />qty_tons:  254.250<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-10-01<br />qty_tons:  666.250<br />fish_name: Beauvoir/Habeas pisces","month_of_arrival: 2035-11-01<br />qty_tons: 2085.875<br />fish_name: Beauvoir/Habeas pisces"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Beauvoir/Habeas pisces","legendgroup":"Beauvoir/Habeas pisces","showlegend":false,"xaxis":"x2","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[442.625,964.5,1374.75,2591.875,3144.25,2232.375],"x":[23892,23922,23953,23984,24014,24045],"y":[31.25,64.625,203,278.625,136.625,376.625],"text":["month_of_arrival: 2035-06-01<br />qty_tons:   31.250<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-07-01<br />qty_tons:   64.625<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-08-01<br />qty_tons:  203.000<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-09-01<br />qty_tons:  278.625<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-10-01<br />qty_tons:  136.625<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-11-01<br />qty_tons:  376.625<br />fish_name: Birdseye/Pisces frigus"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(216,144,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Birdseye/Pisces frigus","legendgroup":"Birdseye/Pisces frigus","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[2061.625,2823.125,4254.625,5209],"x":[23861,23892,24014,24045],"y":[212,32,160.5,451.5],"text":["month_of_arrival: 2035-05-01<br />qty_tons:  212.000<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-06-01<br />qty_tons:   32.000<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-10-01<br />qty_tons:  160.500<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-11-01<br />qty_tons:  451.500<br />fish_name: Birdseye/Pisces frigus"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(216,144,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Birdseye/Pisces frigus","legendgroup":"Birdseye/Pisces frigus","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[239.25,1239.5,2869.5,4462.5,5262.75,2988.5],"x":[23892,23922,23953,23984,24014,24045],"y":[123,510.25,520.75,866.5,1183.875,1225.25],"text":["month_of_arrival: 2035-06-01<br />qty_tons:  123.000<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-07-01<br />qty_tons:  510.250<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-08-01<br />qty_tons:  520.750<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-09-01<br />qty_tons:  866.500<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-10-01<br />qty_tons: 1183.875<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-11-01<br />qty_tons: 1225.250<br />fish_name: Birdseye/Pisces frigus"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(216,144,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Birdseye/Pisces frigus","legendgroup":"Birdseye/Pisces frigus","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[1390.75,4331,5650.75,6910.75,6440.625],"x":[23922,23953,23984,24014,24045],"y":[2.5,46.25,312,901.125,1674.25],"text":["month_of_arrival: 2035-07-01<br />qty_tons:    2.500<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-08-01<br />qty_tons:   46.250<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-09-01<br />qty_tons:  312.000<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-10-01<br />qty_tons:  901.125<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-11-01<br />qty_tons: 1674.250<br />fish_name: Birdseye/Pisces frigus"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(216,144,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Birdseye/Pisces frigus","legendgroup":"Birdseye/Pisces frigus","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[68,804.5,2793.875,3550.5,2438.625],"x":[23922,23953,23984,24014,24045],"y":[628,465.25,1385.125,1712.75,475.625],"text":["month_of_arrival: 2035-07-01<br />qty_tons:  628.000<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-08-01<br />qty_tons:  465.250<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-09-01<br />qty_tons: 1385.125<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-10-01<br />qty_tons: 1712.750<br />fish_name: Birdseye/Pisces frigus","month_of_arrival: 2035-11-01<br />qty_tons:  475.625<br />fish_name: Birdseye/Pisces frigus"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(216,144,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Birdseye/Pisces frigus","legendgroup":"Birdseye/Pisces frigus","showlegend":false,"xaxis":"x2","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[517,259.5,801.5,1300.5,2335.375,2586,1682.375],"x":[23861,23892,23922,23953,23984,24014,24045],"y":[44.125,183.125,163,74.25,256.5,558.25,550],"text":["month_of_arrival: 2035-05-01<br />qty_tons:   44.125<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-06-01<br />qty_tons:  183.125<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-07-01<br />qty_tons:  163.000<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-08-01<br />qty_tons:   74.250<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-09-01<br />qty_tons:  256.500<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-10-01<br />qty_tons:  558.250<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-11-01<br />qty_tons:  550.000<br />fish_name: Cod/Gadus n.specificatae"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(163,165,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Cod/Gadus n.specificatae","legendgroup":"Cod/Gadus n.specificatae","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[2760.625,4055.375,3750.5,4006.875,4967.875],"x":[23892,23953,23984,24014,24045],"y":[62.5,80,318.25,247.75,241.125],"text":["month_of_arrival: 2035-06-01<br />qty_tons:   62.500<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-08-01<br />qty_tons:   80.000<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-09-01<br />qty_tons:  318.250<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-10-01<br />qty_tons:  247.750<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-11-01<br />qty_tons:  241.125<br />fish_name: Cod/Gadus n.specificatae"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(163,165,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Cod/Gadus n.specificatae","legendgroup":"Cod/Gadus n.specificatae","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[0,0,0,0,222.125,565.5,421.5,1147,1357.125],"x":[23800,23831,23861,23892,23922,23953,23984,24014,24045],"y":[73,63.75,34,239.25,1017.375,2304,4041,4115.75,1631.375],"text":["month_of_arrival: 2035-03-01<br />qty_tons:   73.000<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-04-01<br />qty_tons:   63.750<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-05-01<br />qty_tons:   34.000<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-06-01<br />qty_tons:  239.250<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-07-01<br />qty_tons: 1017.375<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-08-01<br />qty_tons: 2304.000<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-09-01<br />qty_tons: 4041.000<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-10-01<br />qty_tons: 4115.750<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-11-01<br />qty_tons: 1631.375<br />fish_name: Cod/Gadus n.specificatae"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(163,165,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Cod/Gadus n.specificatae","legendgroup":"Cod/Gadus n.specificatae","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[386,706.25,1048.5,1898,2707.25,2839.875,4128],"x":[23800,23892,23922,23953,23984,24014,24045],"y":[207.375,105.875,342.25,2433,2943.5,4070.875,2312.625],"text":["month_of_arrival: 2035-03-01<br />qty_tons:  207.375<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-06-01<br />qty_tons:  105.875<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-07-01<br />qty_tons:  342.250<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-08-01<br />qty_tons: 2433.000<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-09-01<br />qty_tons: 2943.500<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-10-01<br />qty_tons: 4070.875<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-11-01<br />qty_tons: 2312.625<br />fish_name: Cod/Gadus n.specificatae"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(163,165,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Cod/Gadus n.specificatae","legendgroup":"Cod/Gadus n.specificatae","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[0,39.875,0,0,177.75,354.125,419.875,744.5],"x":[23800,23861,23892,23922,23953,23984,24014,24045],"y":[48.25,278.5,283.875,68,626.75,2439.75,3130.625,1694.125],"text":["month_of_arrival: 2035-03-01<br />qty_tons:   48.250<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-05-01<br />qty_tons:  278.500<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-06-01<br />qty_tons:  283.875<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-07-01<br />qty_tons:   68.000<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-08-01<br />qty_tons:  626.750<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-09-01<br />qty_tons: 2439.750<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-10-01<br />qty_tons: 3130.625<br />fish_name: Cod/Gadus n.specificatae","month_of_arrival: 2035-11-01<br />qty_tons: 1694.125<br />fish_name: Cod/Gadus n.specificatae"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(163,165,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Cod/Gadus n.specificatae","legendgroup":"Cod/Gadus n.specificatae","showlegend":false,"xaxis":"x2","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[394.625,198.5,323.125,221.375,784.25,1142.25,1493.125,1094.875,804.75],"x":[23800,23831,23861,23892,23922,23953,23984,24014,24045],"y":[15.75,29.25,193.875,38.125,17.25,158.25,842.25,1491.125,877.625],"text":["month_of_arrival: 2035-03-01<br />qty_tons:   15.750<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-04-01<br />qty_tons:   29.250<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-05-01<br />qty_tons:  193.875<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-06-01<br />qty_tons:   38.125<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-07-01<br />qty_tons:   17.250<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-08-01<br />qty_tons:  158.250<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-09-01<br />qty_tons:  842.250<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-10-01<br />qty_tons: 1491.125<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-11-01<br />qty_tons:  877.625<br />fish_name: Harland/Piscis sapidum"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(57,182,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Harland/Piscis sapidum","legendgroup":"Harland/Piscis sapidum","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[975,1699.375,2040,2589.75,3832.625,3569.375,3706.125,4613],"x":[23831,23861,23892,23922,23953,23984,24014,24045],"y":[600.75,362.25,720.625,373.125,222.75,181.125,300.75,354.875],"text":["month_of_arrival: 2035-04-01<br />qty_tons:  600.750<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-05-01<br />qty_tons:  362.250<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-06-01<br />qty_tons:  720.625<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-07-01<br />qty_tons:  373.125<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-08-01<br />qty_tons:  222.750<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-09-01<br />qty_tons:  181.125<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-10-01<br />qty_tons:  300.750<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-11-01<br />qty_tons:  354.875<br />fish_name: Harland/Piscis sapidum"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(57,182,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Harland/Piscis sapidum","legendgroup":"Harland/Piscis sapidum","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709],"base":[-0.5,776.5,918.5],"x":[23892,24014,24045],"y":[0.5,370.5,438.625],"text":["month_of_arrival: 2035-06-01<br />qty_tons:    0.500<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-10-01<br />qty_tons:  370.500<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-11-01<br />qty_tons:  438.625<br />fish_name: Harland/Piscis sapidum"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(57,182,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Harland/Piscis sapidum","legendgroup":"Harland/Piscis sapidum","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[343.5,1030.125,617.75,593.75,1846.875,2558.5,2273.25,3095.125],"x":[23831,23861,23892,23922,23953,23984,24014,24045],"y":[264.25,324.625,88.5,454.75,51.125,148.75,566.625,1032.875],"text":["month_of_arrival: 2035-04-01<br />qty_tons:  264.250<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-05-01<br />qty_tons:  324.625<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-06-01<br />qty_tons:   88.500<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-07-01<br />qty_tons:  454.750<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-08-01<br />qty_tons:   51.125<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-09-01<br />qty_tons:  148.750<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-10-01<br />qty_tons:  566.625<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-11-01<br />qty_tons: 1032.875<br />fish_name: Harland/Piscis sapidum"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(57,182,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Harland/Piscis sapidum","legendgroup":"Harland/Piscis sapidum","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[0,217.125,381.75,337.75],"x":[23861,23984,24014,24045],"y":[39.875,137,38.125,406.75],"text":["month_of_arrival: 2035-05-01<br />qty_tons:   39.875<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-09-01<br />qty_tons:  137.000<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-10-01<br />qty_tons:   38.125<br />fish_name: Harland/Piscis sapidum","month_of_arrival: 2035-11-01<br />qty_tons:  406.750<br />fish_name: Harland/Piscis sapidum"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(57,182,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Harland/Piscis sapidum","legendgroup":"Harland/Piscis sapidum","showlegend":false,"xaxis":"x2","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709],"base":[2460.25,3770.5],"x":[23922,23953],"y":[129.5,62.125],"text":["month_of_arrival: 2035-07-01<br />qty_tons:  129.500<br />fish_name: Helenaa/Pisces satis","month_of_arrival: 2035-08-01<br />qty_tons:   62.125<br />fish_name: Helenaa/Pisces satis"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,191,125,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Helenaa/Pisces satis","legendgroup":"Helenaa/Pisces satis","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":25.19999999999709,"base":757.375,"x":[24014],"y":[19.125],"text":"month_of_arrival: 2035-10-01<br />qty_tons:   19.125<br />fish_name: Helenaa/Pisces satis","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,191,125,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Helenaa/Pisces satis","legendgroup":"Helenaa/Pisces satis","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[908.5,585.375,1843.375,2257,2895.625],"x":[23861,23892,23953,24014,24045],"y":[121.625,32.375,3.5,16.25,199.5],"text":["month_of_arrival: 2035-05-01<br />qty_tons:  121.625<br />fish_name: Helenaa/Pisces satis","month_of_arrival: 2035-06-01<br />qty_tons:   32.375<br />fish_name: Helenaa/Pisces satis","month_of_arrival: 2035-08-01<br />qty_tons:    3.500<br />fish_name: Helenaa/Pisces satis","month_of_arrival: 2035-10-01<br />qty_tons:   16.250<br />fish_name: Helenaa/Pisces satis","month_of_arrival: 2035-11-01<br />qty_tons:  199.500<br />fish_name: Helenaa/Pisces satis"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,191,125,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Helenaa/Pisces satis","legendgroup":"Helenaa/Pisces satis","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709],"base":[489.75,480.75],"x":[24014,24045],"y":[267.625,437.75],"text":["month_of_arrival: 2035-10-01<br />qty_tons:  267.625<br />fish_name: Offidiaa/Piscis osseus","month_of_arrival: 2035-11-01<br />qty_tons:  437.750<br />fish_name: Offidiaa/Piscis osseus"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Offidiaa/Piscis osseus","legendgroup":"Offidiaa/Piscis osseus","showlegend":true,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709],"base":[2253.125,1813.25,1224.75],"x":[23984,24014,24045],"y":[305.375,443.75,1670.875],"text":["month_of_arrival: 2035-09-01<br />qty_tons:  305.375<br />fish_name: Offidiaa/Piscis osseus","month_of_arrival: 2035-10-01<br />qty_tons:  443.750<br />fish_name: Offidiaa/Piscis osseus","month_of_arrival: 2035-11-01<br />qty_tons: 1670.875<br />fish_name: Offidiaa/Piscis osseus"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Offidiaa/Piscis osseus","legendgroup":"Offidiaa/Piscis osseus","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709],"base":[297.25,147.125],"x":[24014,24045],"y":[84.5,190.625],"text":["month_of_arrival: 2035-10-01<br />qty_tons:   84.500<br />fish_name: Offidiaa/Piscis osseus","month_of_arrival: 2035-11-01<br />qty_tons:  190.625<br />fish_name: Offidiaa/Piscis osseus"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Offidiaa/Piscis osseus","legendgroup":"Offidiaa/Piscis osseus","showlegend":false,"xaxis":"x2","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[452.25,388.5,581,734.5],"x":[23922,23953,23984,24014],"y":[332,753.75,912.125,360.375],"text":["month_of_arrival: 2035-07-01<br />qty_tons:  332.000<br />fish_name: Salmon/Oncorhynchus rosea","month_of_arrival: 2035-08-01<br />qty_tons:  753.750<br />fish_name: Salmon/Oncorhynchus rosea","month_of_arrival: 2035-09-01<br />qty_tons:  912.125<br />fish_name: Salmon/Oncorhynchus rosea","month_of_arrival: 2035-10-01<br />qty_tons:  360.375<br />fish_name: Salmon/Oncorhynchus rosea"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,176,246,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Salmon/Oncorhynchus rosea","legendgroup":"Salmon/Oncorhynchus rosea","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709],"base":[3632.5,3239.625,3497.625],"x":[23953,23984,24014],"y":[138,329.75,208.5],"text":["month_of_arrival: 2035-08-01<br />qty_tons:  138.000<br />fish_name: Salmon/Oncorhynchus rosea","month_of_arrival: 2035-09-01<br />qty_tons:  329.750<br />fish_name: Salmon/Oncorhynchus rosea","month_of_arrival: 2035-10-01<br />qty_tons:  208.500<br />fish_name: Salmon/Oncorhynchus rosea"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,176,246,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Salmon/Oncorhynchus rosea","legendgroup":"Salmon/Oncorhynchus rosea","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":25.19999999999709,"base":541.5,"x":[23953],"y":[24],"text":"month_of_arrival: 2035-08-01<br />qty_tons:   24.000<br />fish_name: Salmon/Oncorhynchus rosea","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,176,246,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Salmon/Oncorhynchus rosea","legendgroup":"Salmon/Oncorhynchus rosea","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709],"base":[919,837.25,1429],"x":[23953,23984,24014],"y":[924.375,1415.875,384.25],"text":["month_of_arrival: 2035-08-01<br />qty_tons:  924.375<br />fish_name: Salmon/Oncorhynchus rosea","month_of_arrival: 2035-09-01<br />qty_tons: 1415.875<br />fish_name: Salmon/Oncorhynchus rosea","month_of_arrival: 2035-10-01<br />qty_tons:  384.250<br />fish_name: Salmon/Oncorhynchus rosea"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,176,246,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Salmon/Oncorhynchus rosea","legendgroup":"Salmon/Oncorhynchus rosea","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709],"base":[161.75,29.25,208],"x":[23953,23984,24014],"y":[16,187.875,89.25],"text":["month_of_arrival: 2035-08-01<br />qty_tons:   16.000<br />fish_name: Salmon/Oncorhynchus rosea","month_of_arrival: 2035-09-01<br />qty_tons:  187.875<br />fish_name: Salmon/Oncorhynchus rosea","month_of_arrival: 2035-10-01<br />qty_tons:   89.250<br />fish_name: Salmon/Oncorhynchus rosea"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,176,246,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Salmon/Oncorhynchus rosea","legendgroup":"Salmon/Oncorhynchus rosea","showlegend":false,"xaxis":"x2","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[313.75,235.625,388.625,494.75,230],"x":[23922,23953,23984,24014,24045],"y":[138.5,152.875,192.375,239.75,574.75],"text":["month_of_arrival: 2035-07-01<br />qty_tons:  138.500<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-08-01<br />qty_tons:  152.875<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-09-01<br />qty_tons:  192.375<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-10-01<br />qty_tons:  239.750<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-11-01<br />qty_tons:  574.750<br />fish_name: Sockfish/Pisces foetida"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(149,144,255,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Sockfish/Pisces foetida","legendgroup":"Sockfish/Pisces foetida","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[963.625,1185.375,1510.875,1998.5,2855,2695.875,3035.25,3232],"x":[23831,23861,23892,23922,23953,23984,24014,24045],"y":[11.375,514,529.125,461.75,777.5,543.75,462.375,1381],"text":["month_of_arrival: 2035-04-01<br />qty_tons:   11.375<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-05-01<br />qty_tons:  514.000<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-06-01<br />qty_tons:  529.125<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-07-01<br />qty_tons:  461.750<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-08-01<br />qty_tons:  777.500<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-09-01<br />qty_tons:  543.750<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-10-01<br />qty_tons:  462.375<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-11-01<br />qty_tons: 1381.000<br />fish_name: Sockfish/Pisces foetida"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(149,144,255,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Sockfish/Pisces foetida","legendgroup":"Sockfish/Pisces foetida","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[291,497.125,491.75,616.75,599.625,424,544.625],"x":[23861,23892,23922,23953,23984,24014,24045],"y":[617.5,88.25,102,302.25,237.625,1005,680.125],"text":["month_of_arrival: 2035-05-01<br />qty_tons:  617.500<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-06-01<br />qty_tons:   88.250<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-07-01<br />qty_tons:  102.000<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-08-01<br />qty_tons:  302.250<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-09-01<br />qty_tons:  237.625<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-10-01<br />qty_tons: 1005.000<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-11-01<br />qty_tons:  680.125<br />fish_name: Sockfish/Pisces foetida"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(149,144,255,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Sockfish/Pisces foetida","legendgroup":"Sockfish/Pisces foetida","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[0,0,60.125,0],"x":[23953,23984,24014,24045],"y":[161.75,29.25,147.875,147.125],"text":["month_of_arrival: 2035-08-01<br />qty_tons:  161.750<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-09-01<br />qty_tons:   29.250<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-10-01<br />qty_tons:  147.875<br />fish_name: Sockfish/Pisces foetida","month_of_arrival: 2035-11-01<br />qty_tons:  147.125<br />fish_name: Sockfish/Pisces foetida"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(149,144,255,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Sockfish/Pisces foetida","legendgroup":"Sockfish/Pisces foetida","showlegend":false,"xaxis":"x2","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709],"base":[285.125,140.625],"x":[24014,24045],"y":[209.625,89.375],"text":["month_of_arrival: 2035-10-01<br />qty_tons:  209.625<br />fish_name: Tuna/Thunnini n.vera","month_of_arrival: 2035-11-01<br />qty_tons:   89.375<br />fish_name: Tuna/Thunnini n.vera"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(231,107,243,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Tuna/Thunnini n.vera","legendgroup":"Tuna/Thunnini n.vera","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":25.19999999999709,"base":0,"x":[24014],"y":[60.125],"text":"month_of_arrival: 2035-10-01<br />qty_tons:   60.125<br />fish_name: Tuna/Thunnini n.vera","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(231,107,243,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Tuna/Thunnini n.vera","legendgroup":"Tuna/Thunnini n.vera","showlegend":false,"xaxis":"x2","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[0,0,0,0,0,0,0,0,0,0],"x":[23772,23800,23831,23861,23892,23922,23953,23984,24014,24045],"y":[299.5,394.625,198.5,323.125,221.375,313.75,235.625,388.625,285.125,140.625],"text":["month_of_arrival: 2035-02-01<br />qty_tons:  299.500<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-03-01<br />qty_tons:  394.625<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-04-01<br />qty_tons:  198.500<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-05-01<br />qty_tons:  323.125<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-06-01<br />qty_tons:  221.375<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-07-01<br />qty_tons:  313.750<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-08-01<br />qty_tons:  235.625<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-09-01<br />qty_tons:  388.625<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-10-01<br />qty_tons:  285.125<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-11-01<br />qty_tons:  140.625<br />fish_name: Wrasse/Labridae n.refert"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,98,188,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Wrasse/Labridae n.refert","legendgroup":"Wrasse/Labridae n.refert","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[0,0,0,0,0,0,0,0,0,0],"x":[23772,23800,23831,23861,23892,23922,23953,23984,24014,24045],"y":[791.25,1074.625,963.625,1185.375,1510.875,1998.5,2855,2695.875,3035.25,3232],"text":["month_of_arrival: 2035-02-01<br />qty_tons:  791.250<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-03-01<br />qty_tons: 1074.625<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-04-01<br />qty_tons:  963.625<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-05-01<br />qty_tons: 1185.375<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-06-01<br />qty_tons: 1510.875<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-07-01<br />qty_tons: 1998.500<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-08-01<br />qty_tons: 2855.000<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-09-01<br />qty_tons: 2695.875<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-10-01<br />qty_tons: 3035.250<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-11-01<br />qty_tons: 3232.000<br />fish_name: Wrasse/Labridae n.refert"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,98,188,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Wrasse/Labridae n.refert","legendgroup":"Wrasse/Labridae n.refert","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[0,0,0,0,0],"x":[23922,23953,23984,24014,24045],"y":[222.125,541.5,421.5,489.75,480.75],"text":["month_of_arrival: 2035-07-01<br />qty_tons:  222.125<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-08-01<br />qty_tons:  541.500<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-09-01<br />qty_tons:  421.500<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-10-01<br />qty_tons:  489.750<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-11-01<br />qty_tons:  480.750<br />fish_name: Wrasse/Labridae n.refert"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,98,188,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Wrasse/Labridae n.refert","legendgroup":"Wrasse/Labridae n.refert","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709,25.19999999999709],"base":[0,0,0,0,0,0,0,0,0,0],"x":[23772,23800,23831,23861,23892,23922,23953,23984,24014,24045],"y":[216.25,386,343.5,291,497.125,491.75,616.75,599.625,424,544.625],"text":["month_of_arrival: 2035-02-01<br />qty_tons:  216.250<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-03-01<br />qty_tons:  386.000<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-04-01<br />qty_tons:  343.500<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-05-01<br />qty_tons:  291.000<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-06-01<br />qty_tons:  497.125<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-07-01<br />qty_tons:  491.750<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-08-01<br />qty_tons:  616.750<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-09-01<br />qty_tons:  599.625<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-10-01<br />qty_tons:  424.000<br />fish_name: Wrasse/Labridae n.refert","month_of_arrival: 2035-11-01<br />qty_tons:  544.625<br />fish_name: Wrasse/Labridae n.refert"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,98,188,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Wrasse/Labridae n.refert","legendgroup":"Wrasse/Labridae n.refert","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":55.452054794520549,"r":7.3059360730593621,"b":40.182648401826491,"l":48.949771689497723},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Fish Arrivals by City Over Time","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,0.31583941172982266],"automargin":true,"type":"linear","autorange":false,"range":[23744.490000000002,24072.509999999998],"tickmode":"array","ticktext":["Apr","Jul","Oct"],"tickvals":[23831,23922,24014],"categoryorder":"array","categoryarray":["Apr","Jul","Oct"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-45,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y4","title":"","hoverformat":".2f"},"annotations":[{"text":"Month of Arrival","x":0.5,"y":0,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"top","annotationType":"axis","yshift":-21.917808219178088},{"text":"Total Quantity in Tons","x":0,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xref":"paper","yref":"paper","textangle":-90,"xanchor":"right","yanchor":"center","annotationType":"axis","xshift":-33.607305936073068},{"text":"City of Haacklee","x":0.15791970586491133,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"City of Himark","x":0.5,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"City of Lomark","x":0.84208029413508867,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"City of Paackland","x":0.15791970586491133,"y":0.48515981735159819,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"City of South Paackland","x":0.5,"y":0.48515981735159819,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"}],"yaxis":{"domain":[0.51484018264840181,1],"automargin":true,"type":"linear","autorange":false,"range":[-178.9375,3757.6875],"tickmode":"array","ticktext":["0","1000","2000","3000"],"tickvals":[0,1000,2000,3000],"categoryorder":"array","categoryarray":["0","1000","2000","3000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.31583941172982266,"y0":0.51484018264840181,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.31583941172982266,"y0":0,"y1":23.37899543378996,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.35082725493684397,"x1":0.64917274506315603,"y0":0.51484018264840181,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.35082725493684397,"x1":0.64917274506315603,"y0":0,"y1":23.37899543378996,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.68416058827017723,"x1":1,"y0":0.51484018264840181,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.68416058827017723,"x1":1,"y0":0,"y1":23.37899543378996,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.31583941172982266,"y0":0,"y1":0.48515981735159819},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.31583941172982266,"y0":0,"y1":23.37899543378996,"yanchor":0.48515981735159819,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.35082725493684397,"x1":0.64917274506315603,"y0":0,"y1":0.48515981735159819},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.35082725493684397,"x1":0.64917274506315603,"y0":0,"y1":23.37899543378996,"yanchor":0.48515981735159819,"ysizemode":"pixel"}],"xaxis2":{"type":"linear","autorange":false,"range":[23744.490000000002,24072.509999999998],"tickmode":"array","ticktext":["Apr","Jul","Oct"],"tickvals":[23831,23922,24014],"categoryorder":"array","categoryarray":["Apr","Jul","Oct"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-45,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.35082725493684397,0.64917274506315603],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y5","title":"","hoverformat":".2f"},"yaxis2":{"type":"linear","autorange":false,"range":[-316.10625000000005,6638.2312499999998],"tickmode":"array","ticktext":["0","2000","4000","6000"],"tickvals":[0,1999.9999999999998,4000,6000],"categoryorder":"array","categoryarray":["0","2000","4000","6000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.51484018264840181,1],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x2","title":"","hoverformat":".2f"},"xaxis3":{"type":"linear","autorange":false,"range":[23744.490000000002,24072.509999999998],"tickmode":"array","ticktext":["Apr","Jul","Oct"],"tickvals":[23831,23922,24014],"categoryorder":"array","categoryarray":["Apr","Jul","Oct"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-45,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.68416058827017723,1],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y3","title":"","hoverformat":".2f"},"yaxis3":{"type":"linear","autorange":false,"range":[-343.18125000000003,7195.8062499999996],"tickmode":"array","ticktext":["0","2000","4000","6000"],"tickvals":[0,2000,3999.9999999999995,6000],"categoryorder":"array","categoryarray":["0","2000","4000","6000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.51484018264840181,1],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x3","title":"","hoverformat":".2f"},"yaxis4":{"type":"linear","autorange":false,"range":[-454.72500000000002,9549.2250000000004],"tickmode":"array","ticktext":["0","2500","5000","7500"],"tickvals":[0,2500,5000,7500],"categoryorder":"array","categoryarray":["0","2500","5000","7500"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.48515981735159819],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis5":{"type":"linear","autorange":false,"range":[-296.47500000000002,6225.9750000000004],"tickmode":"array","ticktext":["0","2000","4000","6000"],"tickvals":[0,2000,4000.0000000000005,6000],"categoryorder":"array","categoryarray":["0","2000","4000","6000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.48515981735159819],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x2","title":"","hoverformat":".2f"},"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"fish_name","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"2964884720f":{"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"2964884720f","visdat":{"2964884720f":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><strong>Insights:</strong></p>
<ol type="1">
<li>Cod arrival increased significantly in Paackland,South Paackland and Lomark from July</li>
<li>Significant consistent increase in Wrasse arrivals in Himark</li>
<li>Sockfish arrived significantly in Hacklee and Himark in November</li>
<li>Offidiaa arrived significantly in Paackland in November</li>
</ol>
</section>
<section id="task-2" class="level2">
<h2 class="anchored" data-anchor-id="task-2"><strong>Task 2</strong></h2>
<p><strong>Exploring activities of SouthSeafood Express Corp</strong></p>
<section id="plotting-monthly-dwell-time-of-vessels-belonging-to-southseafood-express-corp" class="level3">
<h3 class="anchored" data-anchor-id="plotting-monthly-dwell-time-of-vessels-belonging-to-southseafood-express-corp"><strong>2.1 Plotting Monthly Dwell time of vessels belonging to SouthSeafood Express Corp</strong></h3>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate dwell time by month, city, and vessel_id</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>dwell_time_by_month_city_vessel <span class="ot">&lt;-</span> transponder_ping_df <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(vessel_company <span class="sc">==</span> <span class="st">"SouthSeafood Express Corp"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">format</span>(ping_date, <span class="st">"%Y-%m"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month, location, vessel_id) <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">monthly_dwell_time =</span> <span class="fu">sum</span>(dwell), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting with faceting by vessel_id</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dwell_time_by_month_city_vessel, <span class="fu">aes</span>(<span class="at">y =</span> month, <span class="at">x =</span> monthly_dwell_time, <span class="at">fill =</span> location)) <span class="sc">+</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>vessel_id, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span>  <span class="co"># Free scales can be set if necessary</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Monthly Dwell Time by City for Company A, by Vessel"</span>,</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Month"</span>,</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Dwell Time"</span>) <span class="sc">+</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">8</span>))  <span class="co"># Adjust strip text for better readability</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="plotly html-widget html-fill-item" id="htmlwidget-aaa331f34924280e1cff" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-aaa331f34924280e1cff">{"x":{"data":[{"orientation":"v","width":[882504.39215500001,1184446.983183,1889641.4891289999,919006.29637500003],"base":[0.55000000000000004,1.55,2.5500000000000003,3.5500000000000003],"x":[441252.1960775,592223.4915915,944820.74456449994,459503.14818750002],"y":[0.14999999999999991,0.12857142857142856,0.17999999999999972,0.17999999999999972],"text":["monthly_dwell_time:  882504.392<br />month: 0.1500000<br />location: City of Himark","monthly_dwell_time: 1184446.983<br />month: 0.1285714<br />location: City of Himark","monthly_dwell_time: 1889641.489<br />month: 0.1800000<br />location: City of Himark","monthly_dwell_time:  919006.296<br />month: 0.1800000<br />location: City of Himark"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"City of Himark","legendgroup":"City of Himark","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[12982.299243000001,12609.523341,3809.3088120000002],"base":[1.6785714285714286,2.73,3.73],"x":[6491.1496215000006,6304.7616705,1904.6544060000001],"y":[0.12857142857142856,0.17999999999999972,0.17999999999999972],"text":["monthly_dwell_time:   12982.299<br />month: 0.1285714<br />location: City of Lomark","monthly_dwell_time:   12609.523<br />month: 0.1800000<br />location: City of Lomark","monthly_dwell_time:    3809.309<br />month: 0.1800000<br />location: City of Lomark"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(222,140,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"City of Lomark","legendgroup":"City of Lomark","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[577016.47861700004,956062.47774300002,1006672.3167129999,524916.97737099999],"base":[0.55000000000000004,1.5500000000000003,2.5500000000000003,3.5499999999999998],"x":[288508.23930850002,478031.23887150001,503336.15835649997,262458.48868549999],"y":[0.11250000000000004,0.11249999999999982,0.11249999999999982,0.128571428571429],"text":["monthly_dwell_time:  577016.479<br />month: 0.1125000<br />location: City of Lomark","monthly_dwell_time:  956062.478<br />month: 0.1125000<br />location: City of Lomark","monthly_dwell_time: 1006672.317<br />month: 0.1125000<br />location: City of Lomark","monthly_dwell_time:  524916.977<br />month: 0.1285714<br />location: City of Lomark"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(222,140,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"City of Lomark","legendgroup":"City of Lomark","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":6707.7437639999998,"base":2.6625000000000001,"x":[3353.8718819999999],"y":[0.11249999999999982],"text":"monthly_dwell_time:    6707.744<br />month: 0.1125000<br />location: City of Paackland","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(183,159,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"City of Paackland","legendgroup":"City of Paackland","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[484381.58286600001,376739.87387299997,843995.93019600003,446775.85300900001],"base":[0.66249999999999998,1.6625000000000001,2.7749999999999999,3.6785714285714284],"x":[242190.79143300001,188369.93693649999,421997.96509800002,223387.92650450001],"y":[0.11250000000000004,0.11249999999999982,0.11249999999999982,0.128571428571429],"text":["monthly_dwell_time:  484381.583<br />month: 0.1125000<br />location: Cod Table","monthly_dwell_time:  376739.874<br />month: 0.1125000<br />location: Cod Table","monthly_dwell_time:  843995.930<br />month: 0.1125000<br />location: Cod Table","monthly_dwell_time:  446775.853<br />month: 0.1285714<br />location: Cod Table"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(124,174,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Cod Table","legendgroup":"Cod Table","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[357640.59913300001,30929.248829,137316.99249100001,36997.157825000002],"base":[0.77500000000000002,1.7750000000000001,2.8875000000000002,3.8071428571428569],"x":[178820.29956650001,15464.6244145,68658.496245500006,18498.578912500001],"y":[0.11250000000000004,0.11249999999999982,0.11249999999999982,0.128571428571429],"text":["monthly_dwell_time:  357640.599<br />month: 0.1125000<br />location: Exit East","monthly_dwell_time:   30929.249<br />month: 0.1125000<br />location: Exit East","monthly_dwell_time:  137316.992<br />month: 0.1125000<br />location: Exit East","monthly_dwell_time:   36997.158<br />month: 0.1285714<br />location: Exit East"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,186,56,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Exit East","legendgroup":"Exit East","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[840520.45968100009,6410.3480250000002],"base":[0.88749999999999996,1.8875000000000002],"x":[420260.22984050005,3205.1740125000001],"y":[0.11250000000000004,0.11249999999999982],"text":["monthly_dwell_time:  840520.460<br />month: 0.1125000<br />location: Ghoti Preserve","monthly_dwell_time:    6410.348<br />month: 0.1125000<br />location: Ghoti Preserve"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,192,139,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Ghoti Preserve","legendgroup":"Ghoti Preserve","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[12969.607316,12551.276875],"base":[0.70000000000000007,1.8071428571428572],"x":[6484.8036579999998,6275.6384374999998],"y":[0.14999999999999991,0.12857142857142856],"text":["monthly_dwell_time:   12969.607<br />month: 0.1500000<br />location: Nav 1","monthly_dwell_time:   12551.277<br />month: 0.1285714<br />location: Nav 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Nav 1","legendgroup":"Nav 1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[106090.577168,89163.101068999997,51972.360050999996,31276.581059],"base":[0.99999999999999989,2,3,3.9357142857142855],"x":[53045.288584000002,44581.550534499998,25986.180025499998,15638.2905295],"y":[0.11249999999999993,0.11249999999999982,0.11249999999999982,0.12857142857142856],"text":["monthly_dwell_time:  106090.577<br />month: 0.1125000<br />location: Nav 1","monthly_dwell_time:   89163.101<br />month: 0.1125000<br />location: Nav 1","monthly_dwell_time:   51972.360<br />month: 0.1125000<br />location: Nav 1","monthly_dwell_time:   31276.581<br />month: 0.1285714<br />location: Nav 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Nav 1","legendgroup":"Nav 1","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[37082.045415000001,15282.239793000001,93652.766746000008,74215.689626000007],"base":[1.1125,2.1125000000000003,3.1125000000000003,4.0642857142857149],"x":[18541.0227075,7641.1198965000003,46826.383373000004,37107.844813000003],"y":[0.11249999999999982,0.11249999999999982,0.11249999999999982,0.12857142857142811],"text":["monthly_dwell_time:   37082.045<br />month: 0.1125000<br />location: Nav 2","monthly_dwell_time:   15282.240<br />month: 0.1125000<br />location: Nav 2","monthly_dwell_time:   93652.767<br />month: 0.1125000<br />location: Nav 2","monthly_dwell_time:   74215.690<br />month: 0.1285714<br />location: Nav 2"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,180,240,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Nav 2","legendgroup":"Nav 2","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[9986.5156299999999,10860.559085999999],"base":[0.85000000000000009,1.9357142857142857],"x":[4993.2578149999999,5430.2795429999996],"y":[0.14999999999999991,0.12857142857142878],"text":["monthly_dwell_time:    9986.516<br />month: 0.1500000<br />location: Nav A","monthly_dwell_time:   10860.559<br />month: 0.1285714<br />location: Nav A"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(97,156,255,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Nav A","legendgroup":"Nav A","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[379718.35173599998,422935.12697300001,212604.38940099999,110781.894197],"base":[1,2.0642857142857141,2.9100000000000001,3.9100000000000001],"x":[189859.17586799999,211467.5634865,106302.1947005,55390.947098500001],"y":[0.14999999999999991,0.128571428571429,0.17999999999999972,0.17999999999999972],"text":["monthly_dwell_time:  379718.352<br />month: 0.1500000<br />location: Nav C","monthly_dwell_time:  422935.127<br />month: 0.1285714<br />location: Nav C","monthly_dwell_time:  212604.389<br />month: 0.1800000<br />location: Nav C","monthly_dwell_time:  110781.894<br />month: 0.1800000<br />location: Nav C"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(199,124,255,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Nav C","legendgroup":"Nav C","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[37886.447969000001,61249.673900000002,49968.179735999998,21436.89141],"base":[1.2250000000000001,2.2250000000000001,3.2250000000000001,4.1928571428571431],"x":[18943.2239845,30624.836950000001,24984.089867999999,10718.445705],"y":[0.11249999999999982,0.11249999999999982,0.11249999999999982,0.12857142857142811],"text":["monthly_dwell_time:   37886.448<br />month: 0.1125000<br />location: Nav C","monthly_dwell_time:   61249.674<br />month: 0.1125000<br />location: Nav C","monthly_dwell_time:   49968.180<br />month: 0.1125000<br />location: Nav C","monthly_dwell_time:   21436.891<br />month: 0.1285714<br />location: Nav C"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(199,124,255,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Nav C","legendgroup":"Nav C","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[21060.776549000002,14955.506727,14861.882389,9994.4969669999991],"base":[1.1500000000000001,2.1928571428571426,3.0899999999999999,4.0899999999999999],"x":[10530.388274500001,7477.7533635,7430.9411945000002,4997.2484834999996],"y":[0.14999999999999991,0.128571428571429,0.17999999999999972,0.17999999999999972],"text":["monthly_dwell_time:   21060.777<br />month: 0.1500000<br />location: Nav E","monthly_dwell_time:   14955.507<br />month: 0.1285714<br />location: Nav E","monthly_dwell_time:   14861.882<br />month: 0.1800000<br />location: Nav E","monthly_dwell_time:    9994.497<br />month: 0.1800000<br />location: Nav E"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(245,100,227,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Nav E","legendgroup":"Nav E","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[897808.53177700005,956210.82901400002,340657.35525199998,180552.98714899999],"base":[1.3,2.3214285714285712,3.27,4.2700000000000005],"x":[448904.26588850003,478105.41450700001,170328.67762599999,90276.493574499997],"y":[0.14999999999999991,0.128571428571429,0.17999999999999972,0.17999999999999972],"text":["monthly_dwell_time:  897808.532<br />month: 0.1500000<br />location: Wrasse Beds","monthly_dwell_time:  956210.829<br />month: 0.1285714<br />location: Wrasse Beds","monthly_dwell_time:  340657.355<br />month: 0.1800000<br />location: Wrasse Beds","monthly_dwell_time:  180552.987<br />month: 0.1800000<br />location: Wrasse Beds"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,100,176,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Wrasse Beds","legendgroup":"Wrasse Beds","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[7940.735036,1092582.0996310001,457053.18150499999,3920.0590889999999],"base":[1.3374999999999999,2.3374999999999999,3.3374999999999999,4.3214285714285721],"x":[3970.367518,546291.04981550004,228526.59075249999,1960.0295444999999],"y":[0.11249999999999982,0.11249999999999982,0.11249999999999982,0.12857142857142811],"text":["monthly_dwell_time:    7940.735<br />month: 0.1125000<br />location: Wrasse Beds","monthly_dwell_time: 1092582.100<br />month: 0.1125000<br />location: Wrasse Beds","monthly_dwell_time:  457053.182<br />month: 0.1125000<br />location: Wrasse Beds","monthly_dwell_time:    3920.059<br />month: 0.1285714<br />location: Wrasse Beds"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,100,176,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Wrasse Beds","legendgroup":"Wrasse Beds","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":54.389373183893731,"r":7.3059360730593621,"b":69.406392694063939,"l":66.484018264840202},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Monthly Dwell Time by City for Company A, by Vessel","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,0.47309197651663404],"automargin":true,"type":"linear","autorange":false,"range":[-94482.074456450006,1984123.5635854499],"tickmode":"array","ticktext":["0","500000","1000000","1500000"],"tickvals":[0,500000.00000000006,1000000,1500000],"categoryorder":"array","categoryarray":["0","500000","1000000","1500000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-90,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":"","hoverformat":".2f"},"annotations":[{"text":"Dwell Time","x":0.5,"y":0,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"top","annotationType":"axis","yshift":-51.14155251141554},{"text":"Month","x":0,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xref":"paper","yref":"paper","textangle":-90,"xanchor":"right","yanchor":"center","annotationType":"axis","xshift":-51.14155251141554},{"text":"roachrobberdb6","x":0.23654598825831702,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":10.62681610626816},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"snappersnatcher7be","x":0.76345401174168304,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":10.62681610626816},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"}],"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,4.5999999999999996],"tickmode":"array","ticktext":["2035-02","2035-03","2035-04","2035-05"],"tickvals":[1,2,3,4],"categoryorder":"array","categoryarray":["2035-02","2035-03","2035-04","2035-05"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.47309197651663404,"y0":0,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.47309197651663404,"y0":0,"y1":22.316313823163142,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.52690802348336596,"x1":1,"y0":0,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.52690802348336596,"x1":1,"y0":0,"y1":22.316313823163142,"yanchor":1,"ysizemode":"pixel"}],"xaxis2":{"type":"linear","autorange":false,"range":[-94482.074456450006,1984123.5635854499],"tickmode":"array","ticktext":["0","500000","1000000","1500000"],"tickvals":[0,500000.00000000006,1000000,1500000],"categoryorder":"array","categoryarray":["0","500000","1000000","1500000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-90,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.52690802348336596,1],"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y2","title":"","hoverformat":".2f"},"yaxis2":{"type":"linear","autorange":false,"range":[0.40000000000000002,4.5999999999999996],"tickmode":"array","ticktext":["2035-02","2035-03","2035-04","2035-05"],"tickvals":[1,2,3,4],"categoryorder":"array","categoryarray":["2035-02","2035-03","2035-04","2035-05"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,1],"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x2","title":"","hoverformat":".2f"},"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"location","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"29647047fd":{"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"29647047fd","visdat":{"29647047fd":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><strong>Insights:</strong></p>
<ol type="1">
<li><p>SouthSeafood Express Corp seems to have been caught in the month of May as transponder pings stops at May</p></li>
<li><p>Vessel snappersnatcher7be seems to have spent considerable time in ecological preserve ‘ghoti preserve’ in april and in wrasse beds in april. The common fish present in both locations in Wrasse.</p></li>
</ol>
</section>
<section id="heatmap-of-dwell-time" class="level3">
<h3 class="anchored" data-anchor-id="heatmap-of-dwell-time"><strong>2.2 Heatmap of dwell time</strong></h3>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(transponder_ping_south_df, <span class="fu">aes</span>(<span class="at">x =</span> ping_date, <span class="at">y =</span> location, <span class="at">fill =</span> total_dwell_time)) <span class="sc">+</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span>  <span class="co"># Adds borders to each tile</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"lightblue"</span>, <span class="at">high =</span> <span class="st">"darkblue"</span>, <span class="at">name =</span> <span class="st">"Dwell Time"</span>) <span class="sc">+</span>  <span class="co"># Color gradient</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">facet_wrap</span>(<span class="sc">~</span> vessel_id, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free_y"</span>)<span class="sc">+</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Heatmap of Vessel Location Dwell Times"</span>, <span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Location"</span>) <span class="sc">+</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>),  <span class="co"># Rotate date labels for clarity</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>      )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Investigations_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Insight:</strong></p>
<p>Vessels seem to be spending time in exit east as well Himark and Lomark.</p>
</section>
<section id="deep-dive-into-southseafood-express-corp" class="level3">
<h3 class="anchored" data-anchor-id="deep-dive-into-southseafood-express-corp"><strong>2.3. Deep dive into SouthSeafood Express Corp</strong></h3>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the dataframe for a specific company </span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>transponder_ping_filtered_df <span class="ot">&lt;-</span> transponder_ping_day_sum_df <span class="sc">%&gt;%</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(vessel_company <span class="sc">==</span> <span class="st">"SouthSeafood Express Corp"</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create edge list for the graph</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Here, 'from' represents the vessel, and 'to' represents the city (location)</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>edges_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">from =</span> transponder_ping_filtered_df<span class="sc">$</span>vessel_id,</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">to =</span> transponder_ping_filtered_df<span class="sc">$</span>location,</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight =</span> transponder_ping_filtered_df<span class="sc">$</span>total_dwell_time <span class="co"># Use dwell time as weight for edge thickness</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the graph object</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>graph <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(edges_df, <span class="at">directed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Define node types</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(graph)<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(graph)<span class="sc">$</span>name <span class="sc">%in%</span> transponder_ping_filtered_df<span class="sc">$</span>vessel_id, <span class="st">"vessel"</span>, <span class="st">"location"</span>)</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the network with ggraph</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(graph, <span class="at">layout =</span> <span class="st">'fr'</span>) <span class="sc">+</span>  </span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">edge_width =</span> weight), <span class="at">edge_colour =</span> <span class="st">"grey"</span>) <span class="sc">+</span> <span class="co"># Edge thickness based on dwell time</span></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> type), <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name), <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span>  </span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"vessel"</span> <span class="ot">=</span> <span class="st">"orange"</span>, <span class="st">"location"</span> <span class="ot">=</span> <span class="st">"plum"</span>)) <span class="sc">+</span> </span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span>  </span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Network Visualization of Vessel Movements for SouthSeafood Express Corp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Investigations_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Central and High-Activity Locations</strong>:</p>
<ul>
<li><p><strong>City of Himark and City of Lomark</strong>: These locations have multiple connections and thicker edges, indicating they are key hubs with significant vessel activity or prolonged stays.</p></li>
<li><p><strong>Wrasse Beds and Ghoti Preserve</strong>: Similarly, these locations are prominent in terms of connections and might represent areas where they are performing illegal fishing</p></li>
<li><p><strong>Locations with Thicker Edges</strong>: Locations like “Exit East” connected by thicker edges suggest that these are areas where vessels tend to stay longer, possibly for transshipment activities.</p></li>
<li><p><strong>Paths and Connections</strong>: The arrangement of nodes and connections shows how vessels move from one location to another, which locations are frequently connected, and how dense the network is in specific regions.</p></li>
<li><p>The path plotting show how vessels move from one location to another and which locations are frequently connected</p></li>
<li><p>snappersnatcher seems to use Exit east for transshipment activities</p></li>
<li><p>roachrobberdb6 seems to use Nav A and Nav E for transshipment activities</p></li>
</ul>
</section>
<section id="deep-dive-into-snappersnatcher7b" class="level3">
<h3 class="anchored" data-anchor-id="deep-dive-into-snappersnatcher7b"><strong>2.3. Deep dive into “snappersnatcher7b”</strong></h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">1. Processing Transaction Data</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">2. Suspicious Transactions</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">3. Suspicious Findings</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">Geographical Plot for Suspicious and Legitimate Transportation Activities</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Retrieve and process transaction data to identify suspicious transactions.</p>
<p>Let’s retrieve the <code>Transaction</code> data by applying the filter <code>type == "Event.Transaction"</code> for our links data</p>
<p>We then perform a self-join on the transaction dataset on <code>source</code> column to get the respective <code>city</code> and <code>fish</code> column for each cargo delivery, filtering for only the two cities we observed earlier ‘City of Paackland’, ‘City of Lomark’ which <code>snappersnatcher7b</code> frequented.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve and process transaction data</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>transactions <span class="ot">&lt;-</span> links_df <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event.Transaction"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(source) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(target)) <span class="sc">%&gt;%</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row_number =</span> <span class="fu">row_number</span>(),</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">as.character</span>(date), <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> row_number, <span class="at">values_from =</span> target) <span class="sc">%&gt;%</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">city =</span> <span class="st">`</span><span class="at">2</span><span class="st">`</span>, <span class="at">fish =</span> <span class="st">`</span><span class="at">1</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">transaction_date =</span> date) <span class="sc">%&gt;%</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source, fish, city, type, transaction_date) <span class="sc">%&gt;%</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(fish_df, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"fish"</span> <span class="ot">=</span> <span class="st">"id"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>No duplicated transaction records were found after the self-join</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>duplicated_transactions <span class="ot">&lt;-</span> transactions[<span class="fu">duplicated</span>(transactions<span class="sc">$</span>source), ]</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>duplicated_transactions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 18
# Groups:   source [0]
# ℹ 18 variables: source &lt;chr&gt;, fish &lt;chr&gt;, city &lt;chr&gt;, type.x &lt;chr&gt;,
#   transaction_date &lt;date&gt;, date &lt;chr&gt;, type.y &lt;chr&gt;, type_original &lt;chr&gt;,
#   qty_tons &lt;dbl&gt;, fish_name &lt;chr&gt;, Name &lt;chr&gt;, company &lt;chr&gt;,
#   flag_country &lt;chr&gt;, Activities &lt;chr&gt;, tonnage &lt;dbl&gt;, length_overall &lt;dbl&gt;,
#   fish_species_present &lt;list&gt;, kind &lt;chr&gt;</code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Merge the transactions with HarborReport data to identify relevant suspicious transactions.</p>
<p>Next, we proceed with the HarborReport data by applying filter type == <code>Event.HarborReport</code> to our links dataset and retrieve only<code>snappersnatcher7b</code>’s records then merge with transactions dataset to filter out relevant suspicious transactions given the fact that the harbor reports are likely to be a few days after the transaction.</p>
<p>Note that, this is a rough merge on city, hence we are just narrowing down and end up with likely pairs of transactions with snappersnatcher7be’s harbor reporting to guess its cargo</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve HarborReport data for "snappersnatcher7be"</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>harboureport_culprit<span class="ot">&lt;-</span> links_df <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">as.character</span>(date), <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event.HarborReport"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source <span class="sc">==</span><span class="st">"snappersnatcher7be"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">vessel =</span> source) <span class="sc">%&gt;%</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">city =</span> target) <span class="sc">%&gt;%</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">harboreporting_date =</span> date) <span class="sc">%&gt;%</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(city, vessel, type, harboreporting_date)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge with transactions and apply filter condition</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(transactions, harboureport_culprit, <span class="at">by =</span> <span class="st">"city"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>filtered_transactions <span class="ot">&lt;-</span> merged_data <span class="sc">%&gt;%</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(harboreporting_date <span class="sc">&gt;=</span> transaction_date <span class="sc">+</span> <span class="dv">1</span> <span class="sc">&amp;</span>  <span class="co"># Change the number based on your lag</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>         harboreporting_date <span class="sc">&lt;=</span> transaction_date <span class="sc">+</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(fish_name , fish, city,harboreporting_date,transaction_date, vessel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We generate a timeline plot illustrating suspicious transactions and harbor reports associated with the vessel “snappersnatcher7be,” showcasing the relationship between transaction dates, cargo types, vessels, and cities involved.</p>
<p>It’s likely to have made transactions of cargo “Wrasse/Labridae n.refert” within thisdate range shown.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the timeline plot</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(filtered_transactions)  <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> transaction_date, <span class="at">xend =</span> harboreporting_date, <span class="at">y =</span> fish_name, <span class="at">yend =</span> fish_name, <span class="at">color =</span> vessel), <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> transaction_date, <span class="at">y =</span> fish_name, <span class="at">color =</span> vessel, <span class="at">shape =</span> city), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Suspicious Transactions and Harbor Reports for snappersnatcher7be"</span>, <span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Cargo Type"</span>) <span class="sc">+</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">"Vessel"</span>) <span class="sc">+</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_discrete</span>(<span class="at">name =</span> <span class="st">"City"</span>) <span class="sc">+</span>  <span class="co"># Add legend for city</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">face =</span> <span class="st">"bold"</span>),  <span class="co"># Align the title to the left</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title.position =</span> <span class="st">"plot"</span>                          <span class="co"># Ensure title alignment is based on the entire plot area</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Investigations_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<p>From our observations, “snappersnatcher7be” is likely carrying the following cargo:</p>
<ul>
<li><p>“Cod/Gadus n.specificatae” around 20th March and</p></li>
<li><p>“Wrasse/Labridae n.refert” around 8th May</p></li>
</ul>
<p>Additionally, we found its transportation activities suspicious due to its frequent visits to “Ghoti Preserve”:</p>
<ul>
<li><code>"Nav 1"</code>: 17 occurences</li>
<li><code>"Nav 2"</code>: 7 occurences</li>
</ul>
<p>For legitimate occurrences related to “Wrasse/Labridae n.refert”, there’s fewer:</p>
<ul>
<li><code>"Nav C"</code>: 10 occurences</li>
<li><code>"Wrasse Beds"</code>: 3 occurences</li>
</ul>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve TransponderPing data for "snappersnatcher7be"</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>transponder_culprit <span class="ot">&lt;-</span> links_df <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event.TransportEvent.TransponderPing"</span>,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>         target <span class="sc">==</span> <span class="st">"snappersnatcher7be"</span>,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>         time <span class="sc">&lt;=</span> <span class="st">"2035-05-09"</span>,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>         time <span class="sc">&gt;=</span> <span class="st">"2035-04-09"</span>)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="do">#### Bar Plot for Suspicious and Legitimate Transportation Activities</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Data for transportation activities</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>location_counts <span class="ot">&lt;-</span> transponder_culprit <span class="sc">%&gt;%</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>source <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'Cod Table'</span>, <span class="st">'Exit East'</span>,<span class="st">"City of Paackland"</span>, <span class="st">"City of Lomark"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Occurrences =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Location =</span> source) <span class="sc">%&gt;%</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type =</span> <span class="fu">case_when</span>(</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Nav 1"</span>, <span class="st">"Nav 2"</span>) <span class="sc">~</span> <span class="st">"Suspicious"</span>,</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Legitimate"</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder Location factor levels so "Suspicious" locations appear at the top</span></span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>location_counts <span class="ot">&lt;-</span> location_counts <span class="sc">%&gt;%</span></span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Location =</span> <span class="fu">factor</span>(Location, <span class="at">levels =</span> <span class="fu">unique</span>(Location[<span class="fu">order</span>(Type, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)])))</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot for transportation activities</span></span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(location_counts, <span class="fu">aes</span>(<span class="at">x =</span> Occurrences, <span class="at">y =</span> Location, <span class="at">fill =</span> Type)) <span class="sc">+</span></span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Transportation Activities of snappersnatcher7be"</span>, <span class="at">x =</span> <span class="st">"Number of Occurrences"</span>, <span class="at">y =</span> <span class="st">"Location"</span>) <span class="sc">+</span></span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Suspicious"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Legitimate"</span> <span class="ot">=</span> <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">face =</span> <span class="st">"bold"</span>),  <span class="co"># Align the title to the left</span></span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title.position =</span> <span class="st">"plot"</span>                          <span class="co"># Ensure title alignment is based on the entire plot area</span></span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Investigations_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<p>Below, is the geographical representation of what we found to be legitmate and suspicious locations for the vessel.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>location_counts <span class="ot">&lt;-</span> transponder_culprit <span class="sc">%&gt;%</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'Cod Table'</span>, <span class="st">'Exit East'</span>,<span class="st">"City of Paackland"</span>, <span class="st">"City of Lomark"</span>,<span class="st">"Nav 1"</span>, <span class="st">"Nav 2"</span>, <span class="st">"Ghoti Preserve"</span>, <span class="st">"Exit East"</span>, <span class="st">"Nav C"</span>, <span class="st">"Wrasse Beds"</span>, <span class="st">"Don Limpet Preserve"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Occurrences =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Location =</span> source) <span class="sc">%&gt;%</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Marked =</span> <span class="fu">case_when</span>(</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Nav 1"</span>, <span class="st">"Nav 2"</span>) <span class="sc">~</span> <span class="st">"Suspicious"</span>,   <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Legitimate"</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Location =</span> <span class="fu">factor</span>(Location, <span class="at">levels =</span> <span class="fu">unique</span>(Location[<span class="fu">order</span>(Marked, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)])))  <span class="co"># Reorder Location factor levels</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge location counts with geo data</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>geo_data_0 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(geo_data, location_counts, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id"</span> <span class="ot">=</span> <span class="st">"Location"</span>))</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coordinates from geometry data</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>coords_0 <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(geo_data_0))</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Add coordinates to the geo_data</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>geo_data_0<span class="sc">$</span>Longitude <span class="ot">&lt;-</span> coords_0[,<span class="dv">1</span>]</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>geo_data_0<span class="sc">$</span>Latitude <span class="ot">&lt;-</span> coords_0[,<span class="dv">2</span>]</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for specific IDs to label</span></span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>label_ids_0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Cod Table'</span>, <span class="st">'Exit East'</span>, <span class="st">'City of Paackland'</span>, <span class="st">'City of Lomark'</span>, <span class="st">'Nav 1'</span>, <span class="st">'Nav 2'</span>, <span class="st">'Ghoti Preserve'</span>, <span class="st">'Exit East'</span>, <span class="st">'Nav C'</span>, <span class="st">'Wrasse Beds'</span>, <span class="st">'Don Limpet Preserve'</span>)</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>geo_data_labels_0 <span class="ot">&lt;-</span> geo_data_0 <span class="sc">%&gt;%</span></span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">%in%</span> label_ids_0)</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot size (for RStudio or other environments that support resizing)</span></span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repr.plot.width =</span> <span class="dv">10</span>, <span class="at">repr.plot.height =</span> <span class="dv">8</span>)</span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Geographical plot with labels</span></span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> geo_data_labels_0, <span class="fu">aes</span>(<span class="at">geometry =</span> geometry, <span class="at">color =</span> Marked)) <span class="sc">+</span></span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> geo_data_labels_0 , <span class="fu">aes</span>(<span class="at">x =</span> Longitude, <span class="at">y =</span> Latitude, <span class="at">label =</span> id), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Suspicious"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Legitimate"</span> <span class="ot">=</span> <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Geographical Plot of snappersnatcher7be Activities"</span>) <span class="sc">+</span></span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),  <span class="co"># Enlarge title</span></span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),  <span class="co"># Enlarge legend title</span></span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),  <span class="co"># Enlarge legend text</span></span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),  <span class="co"># Enlarge axis text</span></span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))  <span class="co"># Enlarge axis title</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Investigations_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="deep-investigations-into-roachrobberdb6" class="level3">
<h3 class="anchored" data-anchor-id="deep-investigations-into-roachrobberdb6"><strong>2.4. Deep Investigations into “roachrobberdb6”</strong></h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">1. Suspicious Transactions</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">2. No Suspicious Findings</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">3. Geographical Visualisation</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>Merge the transactions with HarborReport data to identify relevant suspicious transactions.</p>
<p>Next, we proceed with the HarborReport data by applying filter type == <code>Event.HarborReport</code> to our links dataset and retrieve only<code>roachrobberdb6</code>’s records then merge with transactions dataset to filter out relevant suspicious transactions given the fact that the harbor reports are likely to be a few days after the transaction.</p>
<p>Note that, this is a rough merge on city, hence we are just narrowing down and end up with likely pairs of transactions with roachrobberdb6’s harbor reporting to guess its cargo</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve HarborReport data for "roachrobberdb6"</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>harboureport_culprit1<span class="ot">&lt;-</span> links_df <span class="sc">%&gt;%</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">as.character</span>(date), <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event.HarborReport"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source <span class="sc">==</span><span class="st">"roachrobberdb6"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">vessel =</span> source) <span class="sc">%&gt;%</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">city =</span> target) <span class="sc">%&gt;%</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">harboreporting_date =</span> date) <span class="sc">%&gt;%</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(city, vessel, type, harboreporting_date)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge with transactions and apply filter condition</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>merged_data1 <span class="ot">&lt;-</span> <span class="fu">merge</span>(transactions, harboureport_culprit1, <span class="at">by =</span> <span class="st">"city"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>filtered_transactions1 <span class="ot">&lt;-</span> merged_data1 <span class="sc">%&gt;%</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(harboreporting_date <span class="sc">&gt;=</span> transaction_date <span class="sc">+</span> <span class="dv">1</span> <span class="sc">&amp;</span>  <span class="co"># Change the number based on your lag</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>         harboreporting_date <span class="sc">&lt;=</span> transaction_date <span class="sc">+</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(fish_name, fish, city,harboreporting_date,transaction_date, vessel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We generate a timeline plot illustrating suspicious transactions and harbor reports associated with the vessel “roachrobberdb6,” showcasing the relationship between transaction dates, cargo types, vessels, and cities involved.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the timeline plot</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(filtered_transactions1) <span class="sc">+</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> transaction_date, <span class="at">xend =</span> harboreporting_date, <span class="at">y =</span> fish_name, <span class="at">yend =</span> fish_name, <span class="at">color =</span> vessel), <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> transaction_date, <span class="at">y =</span> fish_name, <span class="at">color =</span> vessel, <span class="at">shape =</span> city), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Suspicious Transactions and Harbor Reports for roachrobberdb6"</span>, <span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Cargo Type"</span>) <span class="sc">+</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">"Vessel"</span>) <span class="sc">+</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_discrete</span>(<span class="at">name =</span> <span class="st">"City"</span>) <span class="sc">+</span>  <span class="co"># Add legend for city</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">face =</span> <span class="st">"bold"</span>),  <span class="co"># Align the title to the left</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title.position =</span> <span class="st">"plot"</span>                          <span class="co"># Ensure title alignment is based on the entire plot area</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Investigations_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>From our observations previously, “roachrobberdb6” is likely carrying the following cargo:</p>
<ul>
<li><p>“Wrasse/Labridae n.refert” around February and April</p></li>
<li><p>“Harland/Piscis sapidum” in April</p></li>
</ul>
<p>We found very few of its fishing activities to be suspicious between the period however for the date range. It is likely not to be suspicious.</p>
<ul>
<li><code>"Nav 1"</code>: 2 occurences</li>
<li><code>"Nav C"</code>: 38 occurences</li>
<li><code>"Wrasse Beds"</code>: 42 occurences</li>
</ul>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve TransponderPing data for "roachrobberdb6"</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>transponder_culprit1 <span class="ot">&lt;-</span> links_df <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event.TransportEvent.TransponderPing"</span>,</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>         target <span class="sc">==</span> <span class="st">"roachrobberdb6"</span>,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>         time <span class="sc">&lt;=</span> <span class="st">"2035-04-05"</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="do">#### Bar Plot for Suspicious and Legitimate Transportation Activities</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Data for transportation activities</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>location_counts1 <span class="ot">&lt;-</span> transponder_culprit1 <span class="sc">%&gt;%</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>source <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'Cod Table'</span>, <span class="st">'Exit East'</span>,<span class="st">"City of Paackland"</span>, <span class="st">"City of Lomark"</span>,<span class="st">"City of Himark"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Occurrences =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Location =</span> source) <span class="sc">%&gt;%</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type =</span> <span class="fu">case_when</span>(</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Nav 1"</span>, <span class="st">"Nav 2"</span>) <span class="sc">~</span> <span class="st">"Suspicious"</span>,</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Legitimate"</span></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder Location factor levels so "Suspicious" locations appear at the top</span></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>location_counts1 <span class="ot">&lt;-</span> location_counts1 <span class="sc">%&gt;%</span></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Location =</span> <span class="fu">factor</span>(Location, <span class="at">levels =</span> <span class="fu">unique</span>(Location[<span class="fu">order</span>(Type, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)])))</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot for transportation activities</span></span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(location_counts1, <span class="fu">aes</span>(<span class="at">x =</span> Occurrences, <span class="at">y =</span> Location, <span class="at">fill =</span> Type)) <span class="sc">+</span></span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Transportation Activities of roachrobberdb6"</span>, <span class="at">x =</span> <span class="st">"Number of Occurrences"</span>, <span class="at">y =</span> <span class="st">"Location"</span>) <span class="sc">+</span></span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Suspicious"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Legitimate"</span> <span class="ot">=</span> <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">face =</span> <span class="st">"bold"</span>),  <span class="co"># Align the title to the left</span></span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title.position =</span> <span class="st">"plot"</span>                          <span class="co"># Ensure title alignment is based on the entire plot area</span></span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Investigations_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<p>Below, is the geographical representation of what we found to be legitmate and suspicious locations for the vessel.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create location_counts1 with the Marked column</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>location_counts1 <span class="ot">&lt;-</span> transponder_culprit1 <span class="sc">%&gt;%</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'Cod Table'</span>, <span class="st">'Exit East'</span>,<span class="st">"City of Paackland"</span>, <span class="st">"City of Lomark"</span>,<span class="st">"Nav 1"</span>, <span class="st">"Nav 2"</span>, <span class="st">"Ghoti Preserve"</span>, <span class="st">"Exit East"</span>, <span class="st">"Nav C"</span>, <span class="st">"Wrasse Beds"</span>, <span class="st">"Don Limpet Preserve"</span>,<span class="st">"Nemo Preserve"</span>,<span class="st">"Tuna Shelf"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Occurrences =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Location =</span> source) <span class="sc">%&gt;%</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Marked =</span> <span class="fu">case_when</span>(</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Nav 1"</span>, <span class="st">"Nav 2"</span>) <span class="sc">~</span> <span class="st">"Suspicious"</span>,   </span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Legitimate"</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Location =</span> <span class="fu">factor</span>(Location, <span class="at">levels =</span> <span class="fu">unique</span>(Location[<span class="fu">order</span>(Marked, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)])))  <span class="co"># Reorder Location factor levels</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge location counts with geo_data to include the Marked column</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>geo_data_1 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(geo_data, location_counts1, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id"</span> <span class="ot">=</span> <span class="st">"Location"</span>))</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coordinates from geometry data</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>coords_1 <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(geo_data_1))</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Warning: st_centroid assumes attributes are constant over geometries</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Add coordinates to the geo_data</span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>geo_data_1<span class="sc">$</span>Longitude <span class="ot">&lt;-</span> coords_1[,<span class="dv">1</span>]</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>geo_data_1<span class="sc">$</span>Latitude <span class="ot">&lt;-</span> coords_1[,<span class="dv">2</span>]</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for specific IDs to label</span></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>label_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Cod Table'</span>, <span class="st">'Exit East'</span>, <span class="st">'City of Paackland'</span>, <span class="st">'City of Lomark'</span>, <span class="st">'Nav 1'</span>, <span class="st">'Nav 2'</span>, <span class="st">'Ghoti Preserve'</span>, <span class="st">'Exit East'</span>, <span class="st">'Nav C'</span>, <span class="st">"Wrasse Beds"</span>, <span class="st">"Don Limpet Preserve"</span>,<span class="st">"Nemo Preserve"</span>,<span class="st">"Tuna Shelf"</span>)</span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>geo_data_labels_1 <span class="ot">&lt;-</span> geo_data_1 <span class="sc">%&gt;%</span></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">%in%</span> label_ids)</span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot size (for RStudio or other environments that support resizing)</span></span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repr.plot.width =</span> <span class="dv">10</span>, <span class="at">repr.plot.height =</span> <span class="dv">8</span>)</span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Geographical plot with labels</span></span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> geo_data_labels_1, <span class="fu">aes</span>(<span class="at">geometry =</span> geometry, <span class="at">color =</span> geo_data_labels_1<span class="sc">$</span>Marked)) <span class="sc">+</span></span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> geo_data_labels_1 , <span class="fu">aes</span>(<span class="at">x =</span> Longitude, <span class="at">y =</span> Latitude, <span class="at">label =</span> id), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Suspicious"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Legitimate"</span> <span class="ot">=</span> <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Geographical Plot of roachrobberdb6 Activities"</span>) <span class="sc">+</span></span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),  <span class="co"># Enlarge title</span></span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),  <span class="co"># Enlarge legend title</span></span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),  <span class="co"># Enlarge legend text</span></span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),  <span class="co"># Enlarge axis text</span></span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))  <span class="co"># Enlarge axis title</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Investigations_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="suspicious-trajectories" class="level3">
<h3 class="anchored" data-anchor-id="suspicious-trajectories"><strong>2.5. Suspicious Trajectories</strong></h3>
<p>In this section, we conduct an analysis of vessel trajectories to identify suspicious activities, particularly focusing on the operations of SouthSeafood Express Corp.</p>
<p>To begin, we extract transponder ping data, which provides information on vessel movements. We preprocess this data, assigning numeric values to locations and filtering out irrelevant areas such as Haacklee, Himark, Port Grove, Lomark, Paackland, and South Paackland. some interesting findings.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> transponder_ping_df <span class="sc">%&gt;%</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span>ping_date,</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">start_time =</span> time,</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">vessel =</span> vessel_id,</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">company =</span> vessel_company) <span class="sc">%&gt;%</span> </span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(vessel) <span class="sc">%&gt;%</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">end_time =</span> <span class="fu">lead</span>(start_time)) <span class="sc">%&gt;%</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(start_time) <span class="sc">%&gt;%</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2035-05-01"</span>) <span class="sc">&amp;</span> date <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">"2035-05-10"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, start_time, end_time, location, vessel,company)</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove rows where end_time is NA (last observation for each vessel)</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(end_time))<span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(company))</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Now you have start_time and end_time calculated for each vessel</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign numeric values to locations for plotting purposes </span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>location_factor <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>location) </span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>location_num <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data<span class="sc">$</span>location_factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>After preprocessing, we plot the trajectories of two vessels, “snappersnatcher7be” and “roachrobberdb6,” using ggplot. In the ggplot visualization, we showcase the vessels’ paths over time, along with location labels and customized color coding for each vessel. <code>ggrepel</code> was used to ensure that the labels not overlap.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(vessel <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"snappersnatcher7be"</span>, <span class="st">"roachrobberdb6"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(vessel, date)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the combined plot for all vessels</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(combined_data, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> location_num, <span class="at">group =</span> vessel)) <span class="sc">+</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Highlight co-occurrences</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">combined_data =</span> data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(date, location_num) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">1</span>), </span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> location_num), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Original points</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> vessel, <span class="at">fill =</span> vessel), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Paths with arrows</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">color =</span> vessel, <span class="at">linetype =</span> vessel), <span class="at">size =</span> <span class="dv">1</span>, </span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"cm"</span>)), <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(data<span class="sc">$</span>location_num), <span class="at">labels =</span> <span class="fu">unique</span>(data<span class="sc">$</span>location)) <span class="sc">+</span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Tainamarine Fishing Co's Vessel Trajectories Over Time"</span>,</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Location"</span>,</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Vessel"</span>,</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Vessel"</span>,</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">"Vessel"</span>) <span class="sc">+</span></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"lines"</span>),</span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"lines"</span>), <span class="co"># Control the height of the legend keys</span></span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.spacing.y =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>)) <span class="sc">+</span> <span class="co"># Increase vertical spacing between legend items</span></span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">4</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Investigations_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Important Observations</strong></p>
<ul>
<li>Through this visualization, we discerned a notable trend: both vessels frequently intersect at <code>Nav C</code>. This observation suggests a potential area for further investigation into the activities of SouthSeafood Express Corp.&nbsp;The consistent intersection of these vessels raises questions about the nature of their interactions at this location. This finding prompts us to delve deeper into the activities and operations of SouthSeafood Express Corp, as it may indicate coordinated movements or potential transshipment activities between the vessels. Further scrutiny of these intersecting points could uncover crucial insights into the company’s operational strategies and shed light on any illicit activities that may be occurring.</li>
</ul>
</div>
</div>
<p>In the following section, we utilize several packages to prepare and process the data. We primarily use the <code>sf</code> package for handling spatial data, the <code>dplyr</code> package for data manipulation, and the <code>ggplot2</code> package for data visualization. Additionally, we employ the <code>tmap</code> package to create interactive thematic maps.</p>
<p>Here’s a summary of the technical steps:</p>
<p><strong>Data Validation and Joining</strong>: We validate the geometries of the geographical data and join the node data with the geographical data based on the location identifier.</p>
<p><strong>Conversion to sf Object</strong>: We convert the resulting data frame into an sf object using the st_as_sf function from the sf package.</p>
<p><strong>Coordinates Extraction</strong>: We extract coordinates for plotting the trajectories of the vessels “snappersnatcher7be” and “roachrobberdb6” separately using the st_coordinates function.</p>
<p><strong>Data Combination</strong>: We combine the data for both vessels into a single data frame using the bind_rows function from the dplyr package.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Validate geometries</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>geo_data <span class="ot">&lt;-</span> geo_data <span class="sc">%&gt;%</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_make_valid</span>()</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Join node data</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>mc2_nodes_geo <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(geo_data, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"location"</span> <span class="ot">=</span> <span class="st">"id"</span>))</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the resulting data frame to sf object</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>mc2_nodes_geo_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(mc2_nodes_geo)</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coordinates for plotting for geometries</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>snappersnatcher7be_sf <span class="ot">&lt;-</span> mc2_nodes_geo_sf <span class="sc">%&gt;%</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Longitude =</span> <span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(geometry))[, <span class="dv">1</span>],</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">Latitude =</span> <span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(geometry))[, <span class="dv">2</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(vessel <span class="sc">==</span> <span class="st">"snappersnatcher7be"</span>)</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>roachrobberdb6_sf <span class="ot">&lt;-</span> mc2_nodes_geo_sf <span class="sc">%&gt;%</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Longitude =</span> <span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(geometry))[, <span class="dv">1</span>],</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">Latitude =</span> <span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(geometry))[, <span class="dv">2</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(vessel <span class="sc">==</span> <span class="st">"roachrobberdb6"</span>)</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine data for both vessels</span></span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>combined_sf <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(snappersnatcher7be_sf, roachrobberdb6_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Tmap Mode Setting</strong>: We set the <code>tmap</code> mode to “plot” using the tmap_mode function from the tmap package.</p>
<p><strong>Map Creation with tmap</strong>: We create a thematic map using tmap functions such as tm_shape, tm_borders, and tm_symbols. This map includes borders around each shape, symbols for nodes, and a watercolor style background.</p>
<p><strong>Plot Creation with ggplot</strong>: We create a ggplot with the geom_sf function to plot the geographical data, geom_path to plot the vessel trajectories, and geom_text to add labels to the plot. We also customize the plot aesthetics such as colors and legend titles using functions like scale_color_manual and labs.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set tmap mode</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>geo_data <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(geo_data, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"Longitude"</span>, <span class="st">"Latitude"</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the ggplot with the legend for vessels</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> geo_data, <span class="fu">aes</span>(<span class="at">geometry =</span> geometry), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">fill =</span> <span class="cn">NA</span>) <span class="sc">+</span>  <span class="co"># Plot borders</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> combined_sf, <span class="fu">aes</span>(<span class="at">x =</span> Longitude, <span class="at">y =</span> Latitude, <span class="at">color =</span> vessel), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>  <span class="co"># Plot points</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> combined_sf, <span class="fu">aes</span>(<span class="at">x =</span> Longitude, <span class="at">y =</span> Latitude, <span class="at">color =</span> vessel, <span class="at">group =</span> vessel), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Plot paths</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> combined_sf, <span class="fu">aes</span>(<span class="at">x =</span> Longitude, <span class="at">y =</span> Latitude, <span class="at">label =</span> location), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Add labels</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"snappersnatcher7be"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"roachrobberdb6"</span> <span class="ot">=</span> <span class="st">"blue"</span>)) <span class="sc">+</span>  <span class="co"># Colors for different vessels</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Longitude"</span>, <span class="at">y =</span> <span class="st">"Latitude"</span>, <span class="at">title =</span> <span class="st">"SouthSeafood Express Corp Vessel Trajectories"</span>, <span class="at">color =</span> <span class="st">"Vessel"</span>) <span class="sc">+</span>  <span class="co"># Add legend title</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>() <span class="sc">+</span>  <span class="co"># Use coord_sf for spatial data</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()  <span class="co"># Mi</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Investigations_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="insights-from-visualisations" class="level3">
<h3 class="anchored" data-anchor-id="insights-from-visualisations"><strong>2.6, Insights from Visualisations</strong></h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Suspicious Movement and Catch Contents of SouthSeafood Express Corp</strong></p>
<ul>
<li><p><strong>Movement Patterns</strong>:</p></li>
<li><p>The vessel “snappersnatcher7be” shows frequent visits to suspicious locations such as “Nav 1” (17 occurrences) and “Nav 2” (7 occurrences), which are near “Ghoti Preserve”.</p></li>
<li><p>The visualization illustrates a significant number of transshipment events involving vessels associated with “SouthSeafood Express Corp.” These events, occurring over a period of time, indicate a pattern of coordinated activities suggestive of illicit practices.The plotted data reveals a consistent trend of transshipment occurrences over time, which deviates significantly from normal maritime operations. The frequency and pattern of these events suggest deliberate efforts to transfer goods between vessels, potentially for illegal purposes such as smuggling or avoiding regulatory oversight.</p></li>
<li><p><strong>Catch Contents</strong>:</p></li>
<li><p>The vessel “snappersnatcher7be” is suspected of carrying cargo such as “Wrasse/Labridae n.refert” which is found only in “Ghoti Preserve” , “Wrasse Beds” and “Nemo Reef.” However, our visualisation reveals that it does not venture near “Nemo Reef” and it spends an equal amount of time at “Wrasse Beds” and locations near “Ghoti Preserve”</p></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Timing and Locations of Illegal Fishing Activities for SouthSeafood Express Corp</strong></p>
<ul>
<li><p><strong>Timeframe of Illegal Activities</strong>:</p></li>
<li><p>Around May 8th, “snappersnatcher7be” is likely involved in suspicious cargo activities involving “Wrasse/Labridae n.refert”. Hence, we suspect it conducted illegal fishing in the month previous.</p></li>
<li><p><strong>Locations of Illegal Fishing</strong>:</p></li>
<li><p>The vessel’s frequent visits to “Nav 1” and “Nav 2” suggest these locations are hotspots for illegal activities.</p></li>
<li><p>These locations are close to “Ghoti Preserve”, a region known for fish species like “Wrasse/Labridae n.refert”.</p></li>
</ul>
</div>
</div>
<p>::: callout-note <strong>Suspicious vessel tragejctories found likely to indicate transshipping</strong></p>
<ul>
<li>The trajectories of both vessels belonging to SouthSeafood Express Corp appear to intersect at specific points in time, particularly at Nav C. This presents a compelling indication of transshipment taking place.</li>
</ul>
</section>
</section>
<section id="task-3." class="level2">
<h2 class="anchored" data-anchor-id="task-3."><strong>Task 3.</strong></h2>
<p><strong>Looking for similar patterns as SouthSeafood Express Corp</strong></p>
<section id="visualisation-for-comparison-between-southseafood-vessels-with-others" class="level3">
<h3 class="anchored" data-anchor-id="visualisation-for-comparison-between-southseafood-vessels-with-others"><strong>3.1 Visualisation for comparison between SouthSeaFood Vessels with Others</strong></h3>
<p>As observed, SouthSeaFood has been spending an unusual amount of time in specific locations, such as Nav C, Nav 3, and Ghoti Preserve. This has been traced back to their illegal fishing activities. Using the visualization we developed in RShiny as shown below, users can now gain deeper insights into different fishing regions and identify suspicious activities based on dwell time, similar to our earlier observations.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://sarthakjn1.shinyapps.io/OceanWatchTower/" target="_blank"><img src="images/clipboard-2014334482.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</section>
<section id="top-10-vessels-with-highest-dwell-time-in-ghoti-preserve" class="level3">
<h3 class="anchored" data-anchor-id="top-10-vessels-with-highest-dwell-time-in-ghoti-preserve"><strong>3.2 Top 10 vessels with highest Dwell time in Ghoti Preserve</strong></h3>
<p>Now Lets investigate the arrival of piscisosseusb6d in City of Paackland in November</p>
<p><img src="images/clipboard-2323732308.png" class="img-fluid" width="587">{target=“_blank”}</p>
<p>Looking for dwell time in Ghoti Preserve, as piscisosseusb6d is only found in Ghoti Preserve and hence is a protected species.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify hardcoded city and month</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>hardcoded_city <span class="ot">&lt;-</span> <span class="st">"Ghoti Preserve"</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>selected_month <span class="ot">&lt;-</span> <span class="st">"Nov"</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract year and month</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>transponder_ping_day_sum_df<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">year</span>(transponder_ping_day_sum_df<span class="sc">$</span>ping_date)</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>transponder_ping_day_sum_df<span class="sc">$</span>month <span class="ot">&lt;-</span> <span class="fu">month</span>(transponder_ping_day_sum_df<span class="sc">$</span>ping_date, <span class="at">label =</span> <span class="cn">TRUE</span>)</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize total dwell time for each vessel in each city and month</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>monthly_summary_df <span class="ot">&lt;-</span> transponder_ping_day_sum_df <span class="sc">%&gt;%</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month, location, vessel_id, vessel_type,vessel_company) <span class="sc">%&gt;%</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_dwell_time =</span> <span class="fu">sum</span>(total_dwell_time), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(location, month)</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to keep only top 5 vessels by dwell time for each city and month</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>top_vessels_df <span class="ot">&lt;-</span> monthly_summary_df <span class="sc">%&gt;%</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month, location) <span class="sc">%&gt;%</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> total_dwell_time, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">with_ties =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data for the hardcoded city and selected month</span></span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> top_vessels_df <span class="sc">%&gt;%</span></span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(location <span class="sc">==</span> hardcoded_city, month <span class="sc">==</span> selected_month) <span class="sc">%&gt;%</span></span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_dwell_time))</span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure only top 5 vessels are selected in case of any discrepancy</span></span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> <span class="fu">head</span>(filtered_data, <span class="dv">10</span>)</span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the Plotly plot</span></span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(filtered_data, <span class="at">y =</span> <span class="sc">~</span>vessel_id, <span class="at">x =</span> <span class="sc">~</span>total_dwell_time, <span class="at">type =</span> <span class="st">'bar'</span>, <span class="at">orientation =</span> <span class="st">'h'</span>,</span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a>                <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">"Vessel ID:"</span>, vessel_id, <span class="st">"&lt;br&gt;Vessel Company:"</span>, vessel_company,<span class="st">"&lt;br&gt;vessel_type:"</span>, vessel_type),</span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a>                <span class="at">hoverinfo =</span> <span class="st">'text'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Top 10 Vessels in"</span>, hardcoded_city, <span class="st">"for"</span>, selected_month),</span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Vessel ID"</span>),</span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Total Dwell Time (hours)"</span>),</span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a>         <span class="at">barmode =</span> <span class="st">'stack'</span>)</span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-39"><a href="#cb64-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb64-40"><a href="#cb64-40" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-13cc0744623e2587c70e" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-13cc0744623e2587c70e">{"x":{"visdat":{"296499a125b":["function () ","plotlyVisDat"]},"cur_data":"296499a125b","attrs":{"296499a125b":{"y":{},"x":{},"orientation":"h","text":{},"hoverinfo":"text","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Top 10 Vessels in Ghoti Preserve for Nov","yaxis":{"domain":[0,1],"automargin":true,"title":"Vessel ID","type":"category","categoryorder":"array","categoryarray":["brillbandit0a1","browntroutbandite67","chumsalmoncatcher41e","cohosalmoncapturera7b","malta8cc","seabassbandit9ad","sockeyesalmonseekerb95","swordfishsaboteur22f","tunataker80c","whitesuckerwrangler0b3"]},"xaxis":{"domain":[0,1],"automargin":true,"title":"Total Dwell Time (hours)"},"barmode":"stack","hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"y":["brillbandit0a1","seabassbandit9ad","tunataker80c","chumsalmoncatcher41e","sockeyesalmonseekerb95","swordfishsaboteur22f","malta8cc","whitesuckerwrangler0b3","cohosalmoncapturera7b","browntroutbandite67"],"x":[735083.21919199999,441713.92602300004,397003.44670000003,380463.150165,324448.684397,316573.21712099999,297164.16714400001,289467.74058500002,285700.01677400002,266885.85672600003],"orientation":"h","text":["Vessel ID: brillbandit0a1 <br>Vessel Company: Mcpherson-Wright <br>vessel_type: Entity.Vessel","Vessel ID: seabassbandit9ad <br>Vessel Company: Mccormick Group <br>vessel_type: Entity.Vessel","Vessel ID: tunataker80c <br>Vessel Company: Fischer, Graham and Robinson <br>vessel_type: Entity.Vessel","Vessel ID: chumsalmoncatcher41e <br>Vessel Company: Mooney, Stevenson and Miller <br>vessel_type: Entity.Vessel","Vessel ID: sockeyesalmonseekerb95 <br>Vessel Company: Mcpherson-Wright <br>vessel_type: Entity.Vessel","Vessel ID: swordfishsaboteur22f <br>Vessel Company: Brewer-Massey <br>vessel_type: Entity.Vessel","Vessel ID: malta8cc <br>Vessel Company: Clark, Hall and Cole <br>vessel_type: Entity.Vessel","Vessel ID: whitesuckerwrangler0b3 <br>Vessel Company: Robinson, Mcmillan and Watson <br>vessel_type: Entity.Vessel","Vessel ID: cohosalmoncapturera7b <br>Vessel Company: Faulkner, Shaffer and Moyer <br>vessel_type: Entity.Vessel","Vessel ID: browntroutbandite67 <br>Vessel Company: Ballard-Bailey <br>vessel_type: Entity.Vessel"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text"],"type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><strong>Insights:</strong></p>
<ol type="1">
<li>brillbandit0a1,tunataker80c seems to be spending considerable amount of time in Ghoti preserve and is a suspect</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Conclusion</strong></p>
<ol type="1">
<li>As per above study,South Sea food seems to have performed illegal fishing at Wrasse beds and seems to also have performed transhipment to evade detection.</li>
<li>We are able to use similar patterns for detecting illegal fishing by other vessels.</li>
<li>Using all mechanism for detection provided above, it will be possible to watch out for anomalies and then plot path to detect illegal fishing.</li>
</ol>
</div>
</div>
</section>
<section id="visualization-for-detecting-suspicious-fishing-vessels-based-on-dwell-time-in-ecological-preserves-and-other-areas" class="level3">
<h3 class="anchored" data-anchor-id="visualization-for-detecting-suspicious-fishing-vessels-based-on-dwell-time-in-ecological-preserves-and-other-areas"><strong>3.3.</strong> Visualization for Detecting Suspicious Fishing Vessels Based on Dwell Time in Ecological Preserves and Other Areas</h3>
<p>Similarly, we have developed a visualization in RShiny to highlight the top 10 companies exhibiting unusually long dwell times in specific fishing spots, potentially indicating involvement in illegal fishing activities. Users will be able to derive insights by interacting with the widget to analyse with regards to the various locations across selected months.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://sarthakjn1.shinyapps.io/OceanWatchTower/" target="_blank"><img src="images/clipboard-2886991326.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</section>
</section>
<section id="task-4" class="level2">
<h2 class="anchored" data-anchor-id="task-4"><strong>Task 4</strong></h2>
<p><strong>Fishing behaviours after SouthSeafood Express Corp was caught</strong></p>
</section>
<section id="identifying-new-companies" class="level2">
<h2 class="anchored" data-anchor-id="identifying-new-companies"><strong>4.1. Identifying New companies</strong></h2>
<p>In this section, we recreate the data and transshipment_data by processing the dataframe (transponder_ping_df) to analyze transshipment activities of vessels, this time for a larger date range. We aim to split the data into two periods: before and after SouthSeafood Express Corp was caught, likely around May 16, 2035.</p>
<p>The goal is to identify new companies involved in transshipment activities after the catch date by comparing the companies from both periods, highlighting potential new entrants to transshipment following the crackdown on SouthSeafood Express Corp.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Other considerations</strong></p>
<p>Howver, since it is unlikely that companies restart illegal operations immediately after they are caught, we set the cutoff date to two months after SouthSeafood Express Corp was caught instead as 2035-07-12.</p>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> transponder_ping_df <span class="sc">%&gt;%</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span>ping_date,</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">start_time =</span> time,</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">vessel =</span> vessel_id,</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">company =</span> vessel_company) <span class="sc">%&gt;%</span> </span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(vessel) <span class="sc">%&gt;%</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">end_time =</span> <span class="fu">lead</span>(start_time)) <span class="sc">%&gt;%</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(start_time) <span class="sc">%&gt;%</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">end_time =</span> <span class="fu">lead</span>(start_time)) <span class="sc">%&gt;%</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2035-02-01"</span>) <span class="sc">&amp;</span> date <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">"2035-10-10"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, start_time, end_time, location, vessel,company)</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove rows where end_time is NA (last observation for each vessel)</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(end_time))<span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(company))</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Now you have start_time and end_time calculated for each vessel</span></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign numeric values to locations for plotting purposes </span></span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>location_factor <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>location) </span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>location_num <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data<span class="sc">$</span>location_factor)</span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Identify transshipment points</span></span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a>excluded_locations <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Haacklee"</span>, <span class="st">"Himark"</span>, <span class="st">"Port Grove"</span>, <span class="st">"Lomark"</span>, <span class="st">"Paackland"</span>, <span class="st">"South Paackland"</span>)</span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a>transshipment_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>location <span class="sc">%in%</span> excluded_locations) <span class="sc">%&gt;%</span></span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(company, date, location) <span class="sc">%&gt;%</span></span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">vessels_at_location =</span> <span class="fu">n_distinct</span>(vessel), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-32"><a href="#cb65-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(vessels_at_location <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb65-33"><a href="#cb65-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-34"><a href="#cb65-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-35"><a href="#cb65-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-36"><a href="#cb65-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter transshipment data after the date when SouthSeafood Express Corp was caught</span></span>
<span id="cb65-37"><a href="#cb65-37" aria-hidden="true" tabindex="-1"></a>after_catch_date_and2months <span class="ot">&lt;-</span> transshipment_data <span class="sc">%&gt;%</span></span>
<span id="cb65-38"><a href="#cb65-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2035-07-12"</span>))  <span class="co"># Adjust the date as per your data</span></span>
<span id="cb65-39"><a href="#cb65-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-40"><a href="#cb65-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify unique companies involved in transshipment after the catch date</span></span>
<span id="cb65-41"><a href="#cb65-41" aria-hidden="true" tabindex="-1"></a>unique_companies_after_catch <span class="ot">&lt;-</span> after_catch_date_and2months <span class="sc">%&gt;%</span></span>
<span id="cb65-42"><a href="#cb65-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(company)</span>
<span id="cb65-43"><a href="#cb65-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-44"><a href="#cb65-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter transshipment data before the catch date</span></span>
<span id="cb65-45"><a href="#cb65-45" aria-hidden="true" tabindex="-1"></a>before_catch_date_and2months <span class="ot">&lt;-</span> transshipment_data <span class="sc">%&gt;%</span></span>
<span id="cb65-46"><a href="#cb65-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">&lt;</span> <span class="fu">as.Date</span>(<span class="st">"2035-07-11"</span>))  <span class="co"># Adjust the date as per your data</span></span>
<span id="cb65-47"><a href="#cb65-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-48"><a href="#cb65-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if any of the companies after the catch date are new</span></span>
<span id="cb65-49"><a href="#cb65-49" aria-hidden="true" tabindex="-1"></a>new_companies <span class="ot">&lt;-</span> unique_companies_after_catch <span class="sc">%&gt;%</span></span>
<span id="cb65-50"><a href="#cb65-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>company <span class="sc">%in%</span> before_catch_date_and2months<span class="sc">$</span>company)</span>
<span id="cb65-51"><a href="#cb65-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-52"><a href="#cb65-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Print new companies starting transshipment after SouthSeafood Express Corp was caught</span></span>
<span id="cb65-53"><a href="#cb65-53" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(new_companies)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 1
  company               
  &lt;chr&gt;                 
1 Tainamarine Fishing Co
2 Taylor-Sawyer         </code></pre>
</div>
</div>
</section>
<section id="investigating-behaviours-of-new-companies" class="level2">
<h2 class="anchored" data-anchor-id="investigating-behaviours-of-new-companies"><strong>4.2. Investigating behaviours of New companies</strong></h2>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Filter transshipment data for the new vessels found</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>new_vessels_transshipment <span class="ot">&lt;-</span> transshipment_data <span class="sc">%&gt;%</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(company <span class="sc">%in%</span> new_companies<span class="sc">$</span>company) <span class="sc">%&gt;%</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(company, date) <span class="sc">%&gt;%</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">transshipment =</span> <span class="fu">n_distinct</span>(date), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(company) <span class="sc">%&gt;%</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">transshipment_days =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a column chart</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(new_vessels_transshipment, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(company, <span class="sc">-</span>transshipment_days), <span class="at">y =</span> transshipment_days, <span class="at">fill =</span> company)) <span class="sc">+</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number of Transshipment Days by Company"</span>,</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Company"</span>,</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Transshipment Days"</span>) <span class="sc">+</span></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Investigations_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="found-similarities-of-tainamarine-fishing-co-to-southseafood-express-corp" class="level2">
<h2 class="anchored" data-anchor-id="found-similarities-of-tainamarine-fishing-co-to-southseafood-express-corp"><strong>4.3. Found Similarities of Tainamarine Fishing Co to SouthSeafood Express Corp</strong></h2>
<p>We have identified two potential companies that might be the same entity as SouthSeafood Express Corp, which was caught red-handed and likely restarted their illegal fishing operations. These companies are <code>Tainamarine Fishing Co</code> and <code>Taylor-Sawyer</code>, both of which are found to be of suspicious of transhippment activities and also began operations within 2-3 months after SouthSeafood Express Corp was apprehended.</p>
<p>Among them, <code>Tainamarine Fishing Co</code> seemed to be the most likely suspect as the two vessels belonging to it swimmingsafely92d and posiedonsparadise7e6 possesses the same tonnage and length_overall as snappersnatcher7be and roachrobberdb6 respectively.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>info <span class="ot">&lt;-</span> nodes_df <span class="sc">%&gt;%</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(company <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Tainamarine Fishing Co"</span>, <span class="st">"SouthSeafood Express Corp"</span>))</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the relevant columns for tonnage and length_overall</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>info <span class="sc">%&gt;%</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, company, tonnage, length_overall)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  id                   company                   tonnage length_overall
  &lt;chr&gt;                &lt;chr&gt;                       &lt;dbl&gt;          &lt;dbl&gt;
1 snappersnatcher7be   SouthSeafood Express Corp     100             20
2 swimmingsafely92d    Tainamarine Fishing Co        100             20
3 roachrobberdb6       SouthSeafood Express Corp   11700            130
4 posiedonsparadise7e6 Tainamarine Fishing Co      11700            130</code></pre>
</div>
</div>
<p>In the next section, we proceeded further to investigate <code>Tainamarine Fishing Co</code> by plotting its vessel trajectories over time. This in turn led to some interesting findings.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> transponder_ping_df <span class="sc">%&gt;%</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span>ping_date,</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">start_time =</span> time,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">vessel =</span> vessel_id,</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">company =</span> vessel_company) <span class="sc">%&gt;%</span> </span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(vessel) <span class="sc">%&gt;%</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">end_time =</span> <span class="fu">lead</span>(start_time)) <span class="sc">%&gt;%</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(start_time) <span class="sc">%&gt;%</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2035-08-05"</span>) <span class="sc">&amp;</span> date <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">"2035-08-10"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, start_time, end_time, location, vessel,company)</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove rows where end_time is NA (last observation for each vessel)</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(end_time))<span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(company))</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Now you have start_time and end_time calculated for each vessel</span></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign numeric values to locations for plotting purposes </span></span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>location_factor <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>location) </span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>location_num <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data<span class="sc">$</span>location_factor)</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(company <span class="sc">==</span> <span class="st">"Tainamarine Fishing Co"</span>)</span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the combined plot for all vessels</span></span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(combined_data, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> location_num, <span class="at">group =</span> vessel)) <span class="sc">+</span></span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Highlight co-occurrences</span></span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">combined_data =</span> data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(date, location_num) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">1</span>), </span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> location_num), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Original points</span></span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> vessel, <span class="at">fill =</span> vessel), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Paths with arrows</span></span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">color =</span> vessel, <span class="at">linetype =</span> vessel), <span class="at">size =</span> <span class="dv">1</span>, </span>
<span id="cb70-35"><a href="#cb70-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"cm"</span>)), <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb70-36"><a href="#cb70-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(data<span class="sc">$</span>location_num), <span class="at">labels =</span> <span class="fu">unique</span>(data<span class="sc">$</span>location)) <span class="sc">+</span></span>
<span id="cb70-37"><a href="#cb70-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Tainamarine Fishing Co's Vessel Trajectories Over Time"</span>,</span>
<span id="cb70-38"><a href="#cb70-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb70-39"><a href="#cb70-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Location"</span>,</span>
<span id="cb70-40"><a href="#cb70-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Vessel"</span>,</span>
<span id="cb70-41"><a href="#cb70-41" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Vessel"</span>,</span>
<span id="cb70-42"><a href="#cb70-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">"Vessel"</span>) <span class="sc">+</span></span>
<span id="cb70-43"><a href="#cb70-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb70-44"><a href="#cb70-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb70-45"><a href="#cb70-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb70-46"><a href="#cb70-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"lines"</span>),</span>
<span id="cb70-47"><a href="#cb70-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"lines"</span>), <span class="co"># Control the height of the legend keys</span></span>
<span id="cb70-48"><a href="#cb70-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb70-49"><a href="#cb70-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.spacing.y =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>)) <span class="sc">+</span> <span class="co"># Increase vertical spacing between legend items</span></span>
<span id="cb70-50"><a href="#cb70-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">4</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Investigations_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Important Observations</strong></p>
<p>From the visualization below, it seems that <code>Tainamarine Fishing Co</code>’s vessel trajectories is very similar to <code>SouthSeafood Express Corp</code> vessels in that they tend to co-occur at <code>Nav</code> C too.</p>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group the data by company and vessel</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Join node data</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>mc2_nodes_geo <span class="ot">&lt;-</span> combined_data <span class="sc">%&gt;%</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(geo_data, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"location"</span> <span class="ot">=</span> <span class="st">"id"</span>))</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the resulting data frame to sf object</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>mc2_nodes_geo_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(mc2_nodes_geo)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>grouped_data <span class="ot">&lt;-</span> mc2_nodes_geo_sf <span class="sc">%&gt;%</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(company <span class="sc">==</span> <span class="st">"Tainamarine Fishing Co"</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(company, vessel) <span class="sc">%&gt;%</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Longitude =</span> <span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(geometry))[, <span class="dv">1</span>],</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">Latitude =</span> <span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(geometry))[, <span class="dv">2</span>])</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a palette of colors</span></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="fu">length</span>(<span class="fu">unique</span>(grouped_data<span class="sc">$</span>vessel)))</span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a ggplot with the legend for vessels</span></span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> geo_data, <span class="fu">aes</span>(<span class="at">geometry =</span> geometry), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="cn">NA</span>) <span class="sc">+</span>  <span class="co"># Plot borders</span></span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> grouped_data, <span class="fu">aes</span>(<span class="at">x =</span> Longitude, <span class="at">y =</span> Latitude, <span class="at">color =</span> vessel, <span class="at">group =</span> vessel), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Plot paths with different colors for each vessel</span></span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> grouped_data, <span class="fu">aes</span>(<span class="at">x =</span> Longitude, <span class="at">y =</span> Latitude, <span class="at">color =</span> vessel), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>  <span class="co"># Plot points</span></span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> grouped_data, <span class="fu">aes</span>(<span class="at">x =</span> Longitude, <span class="at">y =</span> Latitude, <span class="at">label =</span> location), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Add labels</span></span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span>  <span class="co"># Assign colors to vessels</span></span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Longitude"</span>, <span class="at">y =</span> <span class="st">"Latitude"</span>, <span class="at">title =</span> <span class="st">"Tainamarine Fishing Co's Vessel Trajectories"</span>, <span class="at">color =</span> <span class="st">"Vessel"</span>) <span class="sc">+</span>  <span class="co"># Add legend title</span></span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>() <span class="sc">+</span>  <span class="co"># Use coord_sf for spatial data</span></span>
<span id="cb71-29"><a href="#cb71-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()  <span class="co"># Minimal theme</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Investigations_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Conclusion</strong></p>
<p>From the visualization below, it seems that <code>Tainamarine Fishing Co</code>’s vessel trajectories is very similar to <code>SouthSeafood Express Corp</code> vessels and is very likely the same entity which was caught fishing illegally earlier.</p>
<p>This is in addition to the other similarities mentioned earlier:</p>
<ol type="1">
<li>Newly established company, 2 months after<code>SouthSeafood Express Corp</code> was caught</li>
<li>Vessels that have the exact tonnage and length_overall of <code>SouthSeafood Express Corp</code></li>
<li>Co-occurence at <code>Nav C</code></li>
</ol>
</div>
</div>
</section>
<section id="comparing-dwell-time-before-and-after-southseafoodcorp-was-caught" class="level2">
<h2 class="anchored" data-anchor-id="comparing-dwell-time-before-and-after-southseafoodcorp-was-caught"><strong>4.4.</strong> Comparing dwell time before and after SouthSeaFoodCorp was caught</h2>
<p>We have also designed visualizations in RShiny to compare dwell times of fishing vessels before and after the capture of SouthSeaFood Corp, which helps to analyze the potential impacts on the fishing patterns of existing companies.</p>
<p>The goal is to reveal any shifts in fishing behaviors that may have occurred due to the crackdown on SouthSeaFood Corp, providing insights into broader trends and potential adjustments in fishing practices.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://sarthakjn1.shinyapps.io/OceanWatchTower/"><img src="images/clipboard-4280643171.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</section>
<section id="comparing-cargo-transactions-before-and-after-southseafood-was-caught" class="level2">
<h2 class="anchored" data-anchor-id="comparing-cargo-transactions-before-and-after-southseafood-was-caught"><strong>4.5.</strong> Comparing Cargo Transactions before and after SouthSeaFood was caught</h2>
<p>Additionally, we created RShiny visualizations to compare cargo transactions from before and after the capture of SouthSeaFood Corp, aiming to analyze how this event might have affected the fishing patterns of other companies. By analyzing cargo transaction data from periods before and after SouthSeaFood Corp’s capture, we are able to explore whether there have been changes in the types and volumes of fish being transported.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://sarthakjn1.shinyapps.io/OceanWatchTower/"><img src="images/clipboard-2893052785.png" class="img-fluid figure-img"></a></p>
</figure>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>